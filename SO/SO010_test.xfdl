<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="SO100" width="1300" height="1000" titletext="New Form" onload="Form_onload" onclose="SO100_onclose">
    <Layouts>
      <Layout height="1000" mobileorientation="landscape" width="1300">
        <Static id="sta_05_00_00_01" taborder="14" top="501" height="29" cssclass="sta_WF_detailLine" left="110" right="11"/>
        <Div id="Div00" taborder="4" text="Div00" left="10" top="10" width="997" height="490">
          <Layouts>
            <Layout>
              <Static id="sta_01_01" taborder="95" left="559" top="455" height="29" cssclass="sta_WF_detailLine" width="426"/>
              <Static id="sta_24_00" taborder="81" left="557" top="115" height="29" cssclass="sta_WF_detailLine" width="428" onclick="Div00_sta_24_00_onclick"/>
              <Static id="sta_13_00" taborder="79" left="515" top="87" height="29" cssclass="sta_WF_detailLine" width="470" text=""/>
              <Static id="sta_01_00" taborder="37" left="94" top="85" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_01_00_00" taborder="47" left="94" top="113" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_01_00_00_00" taborder="48" left="94" top="141" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_01_00_00_00_00_00_00_00" taborder="49" left="94" top="253" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_01_00_00_00_00_00_00_00_00" taborder="50" left="94" top="281" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_01_00_00_00_00_00_00_00_00_00" taborder="51" left="94" top="309" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="sta_21" taborder="34" left="99" top="29" height="29" cssclass="sta_WF_detailLine" width="341"/>
              <Static id="Static23" taborder="28" text="주문번호" left="0" top="29" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="sta_01" taborder="32" left="94" top="57" height="29" cssclass="sta_WF_detailLine" width="346"/>
              <Static id="Static05_00" taborder="33" text="주문정보" left="0" top="1" width="97" height="24" cssclass="sta_WF_title"/>
              <Static id="Static04_00_00" taborder="29" text="주문일시" left="0" top="57" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Combo id="cmb_rcptMeth" taborder="1" left="332" top="33" width="101" height="21" text="선택" value="" index="-1" codecolumn="CODE" datacolumn="CODE_NAME" type="filterlike" onitemchanged="Div06_cmb_PM_onitemchanged" autoselect="true" background="#fafdc8"/>
              <Edit id="edt_soNo" taborder="0" left="104" top="33" width="115" height="21" enable="true" readonly="true"/>
              <Static id="Static22" taborder="30" text="접수구분" left="247" top="29" width="80" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Static id="Static04_00_00_00" taborder="31" text="접수자" left="247" top="57" width="80" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="Static05" taborder="35" text="법인구분" left="0" top="85" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Radio id="Radio_dealType" taborder="36" left="108" top="90" width="138" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_div3"/>
              <Static id="Static09" taborder="38" text="고객사" left="0" top="113" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Static id="Static11" taborder="39" text="계약번호" left="227" top="141" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="Static18" taborder="40" text="소속" left="0" top="169" width="100" height="85" cssclass="sta_WF_detailLabel" onclick="Div00_Static18_onclick"/>
              <Static id="Static28" taborder="41" text="경조사유" left="0" top="253" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Static id="Static31" taborder="42" text="성명(대상자)" left="0" top="281" width="100" cssclass="sta_WF_detailLabel_ess" height="29" padding="2px"/>
              <Edit id="edt_usr1" taborder="7" left="105" top="285" width="97" height="21" readonly="false" background="#fafdc8"/>
              <Static id="Static31_00" taborder="43" text="HP" left="0" top="309" width="100" cssclass="sta_WF_detailLabel" height="29" font="normal 8pt/normal &quot;Arial&quot;" padding="2px"/>
              <Button id="btn_ownSms" taborder="44" left="228" top="313" width="45" height="21" text="SMS" cssclass="btn_WF_main1" onclick="Div00_btn_ownSms_onclick"/>
              <Static id="Static21_00" taborder="45" text="Tel" left="277" top="309" width="50" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="Static21" taborder="46" text="호칭" left="227" top="281" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Edit id="edt_titleNm" taborder="8" left="330" top="285" width="106" height="21" readonly="false"/>
              <Edit id="edt_ownTel" taborder="10" left="330" top="313" width="106" height="21" readonly="false"/>
              <Combo id="cmb_soType" taborder="4" left="104" top="145" width="120" height="21" text="선택" value="" index="-1" codecolumn="CODE" datacolumn="CODE_NAME" type="filterlike" onitemchanged="Div06_cmb_PM_onitemchanged" autoselect="true" innerdataset="ds_suju_div" readonly="true" enable="false" background="#fafdc8"/>
              <Combo id="cmb_hsCd" taborder="6" left="104" top="257" width="331" height="21" text="" value="" index="-1" codecolumn="HS_CODE" datacolumn="HS_NM" type="filterlike" autoselect="true" innerdataset="ds_hs" onsetfocus="Div00_cmb_hsCd_oneditclick" background="#fafdc8"/>
              <Static id="Static31_00_00" taborder="52" text="인적사항" left="0" top="337" width="100" cssclass="sta_WF_detailLabel" height="148" padding="2px"/>
              <Grid id="grd_list02" taborder="11" binddataset="ds_grd3" scrolltype="both" minwidth="" top="339" left="100" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" width="340" height="146" oncellclick="Div00_grd_list02_oncellclick" oncellposchanged="Div00_grd_list02_oncellposchanged">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="42"/>
                      <Column size="92"/>
                      <Column size="109"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="순번"/>
                      <Cell col="1" text="항목"/>
                      <Cell col="2" text="값"/>
                    </Band>
                    <Band id="body">
                      <Cell text="expr:currow+1" textAlign="center" cssclass="expr:comp.parent.parent.parent.fn_dept1(currow)"/>
                      <Cell col="1" text="bind:COL_NM" cssclass="expr:comp.parent.parent.parent.fn_dept1(currow)"/>
                      <Cell col="2" combodataset="ds_grd3_chg" combocodecol="ITEM_DATA" combodatacol="ITEM_DATA" combotype="filterlike" text="bind:COL_VAL" displaytype="expr:ITEM_FLAG=='N'?'editcontrol' : 'combocontrol'" edittype="expr:ITEM_FLAG=='N'?'text' : 'combo'" cssclass="expr:comp.parent.parent.parent.fn_dept1(currow)"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_06" taborder="53" left="560" top="255" height="29" cssclass="sta_WF_detailLine" width="425" onclick="Div00_sta_06_onclick"/>
              <Static id="sta_24" taborder="54" left="517" top="199" height="29" cssclass="sta_WF_detailLine" width="468"/>
              <Static id="Static26" taborder="55" text="인적사항" left="466" top="283" width="100" cssclass="sta_WF_detailLabel" height="117"/>
              <Static id="sta_05" taborder="56" left="560" top="227" height="29" cssclass="sta_WF_detailLine" width="425"/>
              <Static id="Static10" taborder="57" text="성명(주문자)" left="466" top="227" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Static id="sta_08" taborder="58" left="565" top="143" height="57" cssclass="sta_WF_detailLine" width="420"/>
              <Static id="Static19" taborder="59" text="호실" left="466" top="199" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="sta_13" taborder="60" left="515" top="29" height="59" cssclass="sta_WF_detailLine" width="470"/>
              <Static id="Static00_00" taborder="61" text="배송일자" left="466" top="29" width="100" cssclass="sta_WF_detailLabel_ess" height="59"/>
              <Static id="Static35" taborder="62" text="고인/신랑" left="721" top="199" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Calendar id="cal_dlvyDt" taborder="12" left="570" top="33" width="100" height="21" onchanged="Div00_cal_dlvyDt_onchanged"/>
              <Combo id="cmb_time" taborder="13" left="673" top="33" width="51" height="21" text="" value="" index="-1" codecolumn="CODE" datacolumn="NAME" type="filterlike" canitemchange="Div06_cmb_AM_canitemchange" innerdataset="ds_time"/>
              <Combo id="cmb_min" taborder="14" left="745" top="33" width="51" height="21" text="" value="" index="-1" codecolumn="CODE" datacolumn="NAME" type="filterlike" canitemchange="Div06_cmb_AM_canitemchange" innerdataset="ds_minute"/>
              <Static id="Static00_00_01" taborder="63" text="시" left="728" top="30" width="20" height="29"/>
              <Radio id="Radio_dlvyDtType" taborder="64" left="571" top="60" width="409" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_div1"/>
              <Static id="Static00_00_00" taborder="65" text="빈소입실시간" left="873" top="33" width="100" height="29" cssclass="sta_WF_detailLabel" visible="false"/>
              <Calendar id="cal_decDt" taborder="15" left="720" top="61" width="100" height="21" onchanged="Div00_cal_decDt_onchanged" visible="false"/>
              <Combo id="cmb_AM00_01" taborder="16" left="833" top="61" width="51" height="21" text="" value="" index="-1" codecolumn="CODE" datacolumn="NAME" type="filterlike" canitemchange="Div06_cmb_AM_canitemchange" innerdataset="ds_time" visible="false"/>
              <Static id="Static00_00_01_01" taborder="66" text="시" left="888" top="58" width="20" height="29" visible="false"/>
              <Combo id="cmb_AM00_00_00" taborder="17" left="905" top="61" width="51" height="21" text="" value="" index="-1" codecolumn="CODE" datacolumn="NAME" type="filterlike" canitemchange="Div06_cmb_AM_canitemchange" innerdataset="ds_minute" visible="false"/>
              <Static id="Static09_00" taborder="67" text="배송지" left="466" top="115" width="100" cssclass="sta_WF_detailLabel_ess" height="85"/>
              <Button id="btn_dlvy" taborder="68" left="883" top="119" width="21" height="21" cssclass="btn_WF_search" onclick="Div00_btn_dlvy_onclick"/>
              <TextArea id="TA_addr" taborder="19" left="570" top="147" width="410" height="49" background="#fafdc8"/>
              <Button id="btn_chk" taborder="69" left="909" top="119" width="71" height="21" text="중복확인" cssclass="btn_WF_main1" onclick="Div00_btn_chk_onclick"/>
              <Edit id="edt_usr2" taborder="22" left="570" top="231" width="125" height="21" enable="true" readonly="false" background="#fafdc8"/>
              <Button id="btn_usr2" taborder="70" left="695" top="231" width="21" height="21" cssclass="btn_WF_search" visible="false" onclick="Div00_btn_usr2_onclick"/>
              <Edit id="edt_mRoomNo" taborder="20" left="570" top="203" width="147" height="21" enable="true" readonly="false"/>
              <Edit id="edt_mNm" taborder="21" left="825" top="203" width="155" height="21" enable="true" readonly="false"/>
              <Static id="Static31_00_01" taborder="71" text="HP" left="466" top="255" width="100" cssclass="sta_WF_detailLabel" height="29" font="normal 8pt/normal &quot;Arial&quot;" padding="2px"/>
              <Button id="btn_reqSms" taborder="72" left="695" top="259" width="45" height="21" text="SMS" cssclass="btn_WF_main1" onclick="Div00_btn_reqSms_onclick"/>
              <Static id="Static21_00_00" taborder="73" text="Tel" left="721" top="227" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Edit id="edt_reqTel" taborder="23" left="825" top="231" width="155" height="21" readonly="false"/>
              <Grid id="grd_list03" taborder="25" scrolltype="both" minwidth="" top="283" left="566" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" width="419" height="117" binddataset="ds_grd4" oncellclick="Div00_grd_list03_oncellclick" oncellposchanged="Div00_grd_list03_oncellposchanged">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="42"/>
                      <Column size="92"/>
                      <Column size="109"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="순번"/>
                      <Cell col="1" text="항목"/>
                      <Cell col="2" text="값"/>
                    </Band>
                    <Band id="body">
                      <Cell text="expr:currow+1" textAlign="center" cssclass="expr:comp.parent.parent.parent.fn_dept2(currow)"/>
                      <Cell col="1" text="bind:COL_NM" cssclass="expr:comp.parent.parent.parent.fn_dept2(currow)"/>
                      <Cell col="2" combodataset="ds_grd4_chg" combocodecol="ITEM_DATA" combodatacol="ITEM_DATA" combotype="filterlike" text="bind:COL_VAL" displaytype="expr:ITEM_FLAG=='N'?'editcontrol' : 'combocontrol'" edittype="expr:ITEM_FLAG=='N'?'text' : 'combo'" cssclass="expr:comp.parent.parent.parent.fn_dept2(currow)"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_05_00" taborder="74" left="560" top="399" height="29" cssclass="sta_WF_detailLine" width="425"/>
              <Static id="Static10_00" taborder="75" text="플라워배송메모" left="466" top="399" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Edit id="edt_fMemo" taborder="26" left="569" top="403" width="411" height="21" readonly="false" onkeyup="div_search_onkeyup"/>
              <Static id="sta_05_00_00" taborder="76" left="560" top="427" height="29" cssclass="sta_WF_detailLine" width="425"/>
              <Edit id="edt_mMemo" taborder="27" left="569" top="431" width="411" height="21" readonly="false" onkeyup="div_search_onkeyup"/>
              <Static id="Static10_00_00" taborder="77" text="의전 배송 메모" left="466" top="427" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Static id="Static00_00_01_00" taborder="78" text="분" left="802" top="30" width="20" height="29"/>
              <Static id="Static00_00_01_00_00" taborder="80" text="분" left="962" top="55" width="20" height="29" visible="false"/>
              <Static id="Static05_00_00" taborder="82" text="배송정보" left="469" top="1" width="97" height="24" cssclass="sta_WF_title"/>
              <Button id="btn_client" taborder="83" left="414" top="117" width="21" height="21" cssclass="btn_WF_search" text="" onclick="Div00_btn_client_onclick"/>
              <Button id="btn_telInfo" taborder="84" left="363" top="89" width="71" height="21" text="Tel Info" cssclass="btn_WF_main1" onclick="Div00_btn_telInfo_onclick"/>
              <Button id="btn_sono" taborder="85" left="220" top="33" width="21" height="21" cssclass="btn_WF_search" text="" onclick="Div00_btn_sono_onclick" enable="true"/>
              <Edit id="edt_client" taborder="3" left="104" top="117" width="312" height="21" onkeyup="Div00_edt_client_onkeyup" autoselect="true" background="#fafdc8" inputmode="upper" onchanged="Div00_edt_client_onchanged"/>
              <Edit id="edt_dlvyNm" taborder="18" left="570" top="119" width="313" height="21" readonly="false" autoselect="true" onkeyup="Div00_edt_dlvyNm_onkeyup" background="#fafdc8"/>
              <Combo id="cmb_regUser" taborder="2" left="331" top="61" width="103" height="21" text="선택" value="" index="-1" codecolumn="USR_ID" datacolumn="USR_NM" type="filterlike" onitemchanged="Div06_cmb_PM_onitemchanged" autoselect="true" readonly="true"/>
              <Grid id="grd_list01" taborder="5" binddataset="ds_grd2" scrolltype="both" minwidth="" top="170" left="100" autoenter="select" selecttype="cell" oncellclick="Div00_grd_list01_oncellclick" summarytype="default" autofittype="col" width="340" height="84" onkeyup="Div00_grd_list01_onkeyup" oncellposchanged="Div00_grd_list01_oncellposchanged">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="57"/>
                      <Column size="148"/>
                      <Column size="191"/>
                    </Columns>
                    <Rows>
                      <Row size="24"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="expr:currow+1" textAlign="center" cssclass="expr:comp.parent.parent.parent.fn_subType(currow)"/>
                      <Cell col="1" text="bind:SUB_TYPE_NM" textAlign="center" cssclass="expr:comp.parent.parent.parent.fn_subType(currow)"/>
                      <Cell col="2" combodataset="ds_sosoc" combocodecol="SUB_CODE" combodatacol="SUB_CODE_NM" combotype="filterlike" displaytype="expr:SUB_TYPE=='0'?'nomal' : 'combocontrol'" edittype="expr:SUB_TYPE=='0'?'none' : 'combo'" text="bind:SUB_CODE" cssclass="expr:comp.parent.parent.parent.fn_subType(currow)"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static11_00" taborder="86" text="수주형태" left="0" top="141" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
              <Edit id="edt_contNo" taborder="87" left="331" top="145" width="83" height="21" readonly="true" enable="true"/>
              <Button id="btn_usr1" taborder="88" left="202" top="285" width="21" height="21" cssclass="btn_WF_search" visible="false" onclick="Div00_btn_usr1_onclick" text=""/>
              <Button id="btn_reqSms00" taborder="89" left="745" top="259" width="85" height="21" text="대상자 복사" cssclass="btn_WF_main1" onclick="Div00_btn_reqSms00_onclick"/>
              <Edit id="edt_MOVE" taborder="90" left="264" top="4" width="80" height="21" readonly="false" visible="false" textAlign="center"/>
              <Edit id="edt_STATUS" taborder="91" left="359" top="4" width="80" height="21" readonly="false" visible="false" textAlign="center"/>
              <MaskEdit id="MaskEdit01" taborder="92" left="105" top="61" width="137" height="21" type="string" format="####-##-## ##:##:##" textAlign="left" displaynulltext="자동저장 됩니다" readonly="true"/>
              <Static id="Static04_00_00_01" taborder="93" text="발주확정일시" left="466" top="455" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <MaskEdit id="MaskEdit01_00" taborder="94" left="570" top="459" width="147" height="21" type="string" format="####-##-## ##:##:##" textAlign="left" displaynulltext="자동저장 됩니다" readonly="true"/>
              <Edit id="edt_ownTel00" taborder="9" left="105" top="313" width="119" height="21" readonly="false" inputtype="number"/>
              <Edit id="edt_ownTel00_00" taborder="24" left="570" top="259" width="120" height="21" readonly="false" inputtype="number" maxlength="13"/>
              <Static id="Static04_00_00_01_00" taborder="96" text="사전/장례상담" left="721" top="455" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Edit id="edt_soNo00" taborder="97" left="825" top="459" width="135" height="21" enable="true" readonly="true"/>
              <Button id="btn_sono00" taborder="98" left="960" top="459" width="21" height="21" cssclass="btn_WF_search" text="" onclick="Div00_btn_sono00_onclick"/>
              <Button id="btn_contInfo" taborder="99" left="414" top="145" width="21" height="21" cssclass="btn_WF_search" text="" onclick="Div00_btn_contInfo_onclick"/>
              <Button id="btn_manual" taborder="100" top="5" height="21" text="꽃잠 대응 매뉴얼" cssclass="btn_WF_main1" right="143" width="114" visible="false" onclick="Div00_btn_manual_onclick"/>
              <Button id="btn_reqSms00_00" taborder="101" left="835" top="259" width="109" height="21" text="편의용품 알림" cssclass="btn_WF_main1" onclick="Div00_btn_reqSms00_00_onclick" visible="false"/>
              <Edit id="edt_mNm00" taborder="102" left="825" top="91" width="155" height="21" enable="false" readonly="false" color="red"/>
              <Button id="btn_manual00" taborder="103" top="5" height="21" text="이장/개장 접수등록" cssclass="btn_WF_main1" right="13" width="124" visible="true" onclick="Div00_btn_manual00_onclick"/>
              <Button id="btn_mall_sms" taborder="104" text="단품몰" left="568" top="5" width="62" height="21" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage1_btn_mall_refresh_onclick"/>
              <Static id="Static19_00" taborder="105" text="발인일자" left="466" top="87" width="100" cssclass="sta_WF_detailLabel" height="29"/>
              <Calendar id="cal_balinDt" taborder="106" left="569" top="92" width="102" height="21"/>
              <Edit id="edt_BUGO" taborder="107" left="84" top="4" width="170" height="21" readonly="false" visible="false" textAlign="center" border="0px none" font="bold 10pt/normal &quot;Arial&quot;,&quot;나눔고딕&quot;" color="red"/>
              <Button id="btn_pkg_sms" taborder="108" text="PKG안내" left="638" top="5" width="82" height="21" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage1_btn_PKG_refresh_onclick" background="firebrick"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static00" taborder="0" left="0" top="0" cssclass="sta_WF_guideRed" visible="false" text="h10" height="10" right="3"/>
        <Static id="Static08" taborder="1" left="0" top="0" width="10" cssclass="sta_WF_guideRed" visible="false" bottom="30" text="w&#13;&#10;10"/>
        <Static id="Static01" taborder="2" top="0" width="10" cssclass="sta_WF_guideRed" visible="false" bottom="32" text="w&#13;&#10;10" right="0"/>
        <Static id="Static04" taborder="3" left="0" cssclass="sta_WF_guideBlue" visible="false" text="h10" right="208" height="10" bottom="1"/>
        <Div id="Div01" taborder="5" text="Div01" left="1017" top="10" height="490" right="10">
          <Layouts>
            <Layout>
              <Static id="sta_05_00_00_00_00" taborder="9" top="345" height="86" cssclass="sta_WF_detailLine" right="0" left="95"/>
              <Static id="sta_05_00_00_00" taborder="5" top="430" height="55" cssclass="sta_WF_detailLine" right="0" left="95"/>
              <Static id="Static05_00" taborder="0" text="주문팁" left="0" top="1" width="59" height="24" cssclass="sta_WF_title"/>
              <Grid id="grd_list01" taborder="1" scrolltype="both" minwidth="" top="30" left="0" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" height="316" right="1" font="12px/normal &quot;Malgun Gothic&quot;,&quot;Verdana&quot;" binddataset="ds_grd1" autosizingtype="row" extendsizetype="row" onkeydown="Div01_grd_list01_onkeydown" cellsizingtype="row">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="272"/>
                    </Columns>
                    <Rows>
                      <Row size="32"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="bind:TIP_DESC" combodataset="ds_survey" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" wordWrap="char" cssclass="expr:IMPORTANT_FLAG=='Y'?'lv1' : ''"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_copySo" taborder="2" top="5" height="21" text="주문복사" cssclass="btn_WF_main1" onclick="Div00_btn_copySo_onclick" right="0" width="71"/>
              <Edit id="edt_search" taborder="3" left="66" top="5" width="130" height="21" readonly="false" onkeyup="Div01_edt_search_onkeyup" autoselect="true" displaynulltext="주문팁 검색"/>
              <Static id="Static10_00_00_00" taborder="4" text="법인 요청 메모" left="0" top="430" width="100" cssclass="sta_WF_detailLabel" height="55"/>
              <TextArea id="TextArea00" taborder="6" top="434" height="47" right="6" left="103" readonly="true"/>
              <Static id="Static10_00_00_00_00" taborder="7" text="CRM 고객&#13;&#10;입력정보" left="0" top="345" width="100" cssclass="sta_WF_detailLabel" height="86" textAlign="center"/>
              <TextArea id="TextArea00_00" taborder="8" top="349" height="78" right="6" left="103" readonly="true"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="Div02" taborder="6" text="Div02" left="10" top="555" height="434" right="10">
          <Layouts>
            <Layout>
              <Tab id="Tab00" taborder="0" tabindex="0" left="0" top="10" onchanged="Div06_Tab00_onchanged" positionstep="0" minheight="300" maxheight="" bottom="0" right="0">
                <Tabpages>
                  <Tabpage id="Tabpage1" text="     상품정보     ">
                    <Layouts>
                      <Layout>
                        <Radio id="Radio00" taborder="3" top="6" width="183" height="34" innerdataset="ds_tab_div1" codecolumn="CODE_NAME" datacolumn="CODE_NAME" direction="vertical" left="4" onitemchanged="Div02_Tab00_Tabpage1_Radio00_canitemchange"/>
                        <Button id="btn_add00" taborder="0" text="행추가" top="10" width="54" height="24" visible="false" onclick="fn_addBtnClick_1" cssclass="btn_WF_main1" right="62"/>
                        <Button id="btn_search01" taborder="1" text="행삭제" top="10" width="54" height="24" visible="false" onclick="fn_delBtnClick_1" cssclass="btn_WF_main1" right="0"/>
                        <Grid id="grd_list01" taborder="2" binddataset="ds_list_2" scrolltype="both" minwidth="" top="43" bottom="0" autoenter="select" selecttype="cell" oncellclick="Div06_Tab00_Tabpage2_grd_list01_oncellclick" summarytype="top" autofittype="col" left="0" right="0" onkeydown="Div02_Tab00_Tabpage1_grd_list01_onkeydown">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="48"/>
                                <Column size="62"/>
                                <Column size="59"/>
                                <Column size="84"/>
                                <Column size="39"/>
                                <Column size="305"/>
                                <Column size="121"/>
                                <Column size="35"/>
                                <Column size="55"/>
                                <Column size="80"/>
                                <Column size="101"/>
                                <Column size="38"/>
                                <Column size="26"/>
                                <Column size="80"/>
                                <Column size="80"/>
                                <Column size="63"/>
                                <Column size="152"/>
                                <Column size="77"/>
                                <Column size="54"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="40"/>
                                <Column size="61"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell displaytype="checkboxcontrol" edittype="checkbox"/>
                                <Cell col="1" text="구분"/>
                                <Cell col="2" text="필수여부"/>
                                <Cell col="3" colspan="2" text="품목코드"/>
                                <Cell col="5" text="품목명"/>
                                <Cell col="6" text="지점명"/>
                                <Cell col="7" text="수량"/>
                                <Cell col="8" text="가용재고"/>
                                <Cell col="9" text="단가"/>
                                <Cell col="10" text="금액(VAT 포함)"/>
                                <Cell col="11" colspan="2" text="VAT 율"/>
                                <Cell col="13" text="공급가액"/>
                                <Cell col="14" text="VAT 금액"/>
                                <Cell col="15" text="유/무상"/>
                                <Cell col="16" text="무상사유"/>
                                <Cell col="17" colspan="2" text="무상요청자"/>
                                <Cell col="19" text="탁송"/>
                                <Cell col="20" colspan="3" text="조회"/>
                              </Band>
                              <Band id="body">
                                <Cell edittype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'checkbox' : 'none'" displaytype="checkboxcontrol" text="bind:CHK"/>
                                <Cell col="1" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" text="bind:DEAL_TYPE" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_deal2(currow)" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_deal1(currow)" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="2" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" text="bind:MANDATORY_YN" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="3" combodataset="ds_survey" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" text="bind:ITEM_CD" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="4" text="expr:CHOICE_YN == '1' ? '선택' : ''" displaytype="expr:CHOICE_YN == '1' ? 'buttoncontrol' : 'nomal'" edittype="expr:CHOICE_YN == '1' ? 'button' : 'none'" combodataset="ds_survey" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike"/>
                                <Cell col="5" text="bind:ITEM_NM" textAlign="left" maskeditformat="###.##" tooltiptext="bind:CHOICE_YN" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="6" text="bind:REGION_NM" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" combodataset="ds_tab_div12" combocodecol="CODE" combodatacol="CODE_NAME" tooltiptext="bind:REGION_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="7" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" text="bind:SO_QTY" maskeditformat="##,###" textAlign="center" editautoselect="true" maskeditautoselect="true" displaytype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'maskeditcontrol' : 'nomal'" edittype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'mask' : 'none'" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="8" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" text="bind:INV_QTY" maskeditformat="##,###" textAlign="center" editautoselect="true" maskeditautoselect="true" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="9" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" text="bind:SO_PRICE" maskeditformat="##,##0" editautoselect="false" maskeditautoselect="true" displaytype="expr:UPDT_DIV=='2'  &amp;&amp; PO_STATUS=='0' ? 'maskeditcontrol' : 'mask'" edittype="expr:UPDT_DIV=='2'  &amp;&amp; PO_STATUS=='0' ? 'mask' : 'none'" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="10" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" maskeditformat="##,###" displaytype="mask" text="bind:TOTAL_PRICE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="11" colspan="2" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'">
                                  <Cell calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" maskeditformat="##,##0" displaytype="mask" text="bind:VAT_RATE" textAlign="right"/>
                                  <Cell col="1" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" maskeditformat="##,###" text=" (%)"/>
                                </Cell>
                                <Cell col="13" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" maskeditformat="##,###" displaytype="mask" text="expr:NET_AMT" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="14" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" maskeditformat="##,###" displaytype="mask" text="expr:VAT_AMT" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="15" text="bind:PAY_DIV" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" displaytype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'combocontrol' : 'combotext'" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_tab_div2" edittype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'combo' : 'none'" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="16" text="bind:REASON" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" displaytype="expr:PAY_DIV=='F' &amp;&amp; PO_STATUS=='0' ? 'combocontrol' : 'combotext'" combodataset="ds_tab_div3" combocodecol="CODE" combodatacol="CODE_NAME" edittype="expr:PAY_DIV=='F' &amp;&amp; PO_STATUS=='0' ? 'combo' : 'none'" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="17" text="bind:ADD_CD1" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" displaytype="expr:PAY_DIV=='F' &amp;&amp; UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'combocontrol' : 'nomal'" combocodecol="USR_ID" combodatacol="USR_NM" combodataset="ds_userIn2" edittype="expr:PAY_DIV=='F' &amp;&amp; UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'combo' : 'none'" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" combotype="filterlike"/>
                                <Cell col="18" text="bind:ADD_CD1" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" combocodecol="USR_ID" combodatacol="USR_NM" combodataset="ds_user" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="combotext"/>
                                <Cell col="19" text="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto3(currow)" maskeditformat="##,###" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto1(currow)" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto2(currow)"/>
                                <Cell col="20" text="BOM" maskeditformat="##,###" displaytype="buttoncontrol" edittype="button"/>
                                <Cell col="21" text="재고" displaytype="buttoncontrol" edittype="button" maskeditformat="##,##0"/>
                                <Cell col="22" calendardateformat="yyyy-MM-dd" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button" text="입고예정"/>
                              </Band>
                              <Band id="summary">
                                <Cell colspan="10" text="합      계   " textAlign="right"/>
                                <Cell col="10" displaytype="mask" maskeditformat="##,###" text="expr:comp.parent.parent.parent.parent.parent.parent.fn_sumPrice()"/>
                                <Cell col="11" colspan="2" maskeditformat="##,###" textAlign="right"/>
                                <Cell col="13" text="expr:comp.parent.parent.parent.parent.parent.parent.fn_sumNet()" displaytype="mask" maskeditformat="##,###"/>
                                <Cell col="14" text="expr:comp.parent.parent.parent.parent.parent.parent.fn_sumVat()" maskeditformat="##,###" displaytype="mask"/>
                                <Cell col="15" colspan="8"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Combo id="cmb_case" taborder="4" left="226" top="11" width="608" height="21" text="선택" value="" index="-1" codecolumn="CASE_NO" datacolumn="CASE_DESC" type="filterlike" autoselect="true" innerdataset="ds_case" background="#fafdc8" onsetfocus="Div02_Tab00_Tabpage1_cmb_case_onsetfocus"/>
                        <Static id="Static00" taborder="5" text="유형 : " left="186" top="11" width="64" height="21"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage2" text="     리본/카드     ">
                    <Layouts>
                      <Layout>
                        <Static id="Static02" taborder="0" text="리본/카드" left="0" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                        <Grid id="grd_list_2" taborder="1" scrolltype="both" minwidth="" left="0" top="34" right="0" autoenter="select" selecttype="cell" bottom="0" summarytype="default" autofittype="col" binddataset="ds_list_2" oncellclick="Div02_Tab00_Tabpage2_grd_list_2_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="55"/>
                                <Column size="97"/>
                                <Column size="250"/>
                                <Column size="58"/>
                                <Column size="476"/>
                                <Column size="39"/>
                                <Column size="150"/>
                                <Column size="39"/>
                                <Column size="150"/>
                                <Column size="39"/>
                                <Column size="150"/>
                                <Column size="39"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분" edittype="none"/>
                                <Cell col="1" text="품목코드"/>
                                <Cell col="2" text="품목명"/>
                                <Cell col="3" text="수량" edittype="none"/>
                                <Cell col="4" colspan="2" text="리본메시지"/>
                                <Cell col="6" colspan="2" text="경조사어"/>
                                <Cell col="8" colspan="2" text="카드메시지"/>
                                <Cell col="10" colspan="2" text="이미지등록"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEAL_TYPE" displaytype="combotext" combodataset="ds_div3" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="1" text="bind:ITEM_CD" combotype="filterlike" suppress="0" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="2" text="bind:ITEM_NM" combotype="filterlike" suppress="0" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="3" text="bind:SO_QTY" calendardateformat="yyyy-MM-dd" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="4" text="bind:RIBBON_MESSAGE" displaytype="editcontrol" edittype="text" tooltiptext="bind:RIBBON_MESSAGE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="5" maskeditformat="##,###" displaytype="buttoncontrol" edittype="button" text="선택"/>
                                <Cell col="6" text="bind:HS_MESSAGE" displaytype="expr:PO_STATUS=='0' ? 'editcontrol' : 'nomal'" edittype="expr:PO_STATUS=='0' ? 'text' : 'none'" tooltiptext="bind:HS_MESSAGE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="7" maskeditformat="##,###" displaytype="buttoncontrol" edittype="button" text="선택"/>
                                <Cell col="8" text="bind:CARD_MESSAGE" displaytype="expr:PO_STATUS=='0' ? 'editcontrol' : 'nomal'" edittype="expr:PO_STATUS=='0' ? 'text' : 'none'" tooltiptext="bind:CARD_MESSAGE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="9" maskeditformat="##,###" displaytype="buttoncontrol" edittype="button" text="선택"/>
                                <Cell col="10" combodataset="ds_changeReason" combocodecol="CODE" combodatacol="CODE_NAME" text="bind:IMG_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="11" maskeditformat="##,###" displaytype="buttoncontrol" edittype="button" text="선택"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage3" text="     지점정보     ">
                    <Layouts>
                      <Layout>
                        <Static id="Static24" taborder="0" text="지점정보" left="3" top="0" width="121" height="30" cssclass="sta_WF_title"/>
                        <Grid id="grd_list03" taborder="1" scrolltype="both" minwidth="" left="0" right="0" top="34" bottom="0" autoenter="select" selecttype="cell" autofittype="col" binddataset="ds_list_2" oncellclick="Div02_Tab00_Tabpage3_grd_list03_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="69"/>
                                <Column size="97"/>
                                <Column size="226"/>
                                <Column size="50"/>
                                <Column size="57"/>
                                <Column size="85"/>
                                <Column size="85"/>
                                <Column size="1"/>
                                <Column size="85"/>
                                <Column size="101"/>
                                <Column size="79"/>
                                <Column size="148"/>
                                <Column size="35"/>
                                <Column size="99"/>
                                <Column size="41"/>
                                <Column size="404"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분"/>
                                <Cell col="1" text="품목코드"/>
                                <Cell col="2" text="품목명"/>
                                <Cell col="3" text="수량"/>
                                <Cell col="4" text="가용재고"/>
                                <Cell col="5" text="발주단가"/>
                                <Cell col="6" text="금액"/>
                                <Cell col="7" text="할인금액"/>
                                <Cell col="8" text="발주금액"/>
                                <Cell col="9" text="지점구분"/>
                                <Cell col="10" text="지점코드"/>
                                <Cell col="11" colspan="2" text="지점명"/>
                                <Cell col="13" colspan="2" text="연락처"/>
                                <Cell col="15" text="특이사항"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEAL_TYPE" displaytype="combotext" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" combotype="filterlike" tooltiptext="bind:DEAL_TYPE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="1" text="bind:ITEM_CD" combodataset="ds_position" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" textAlign="center" tooltiptext="bind:ITEM_CD" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="2" text="bind:ITEM_NM" combodataset="ds_user" combocodecol="USER_ID" combodatacol="USER_NAME" combotype="filterlike" tooltiptext="bind:ITEM_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="3" text="bind:SO_QTY" calendardisplaynulltype="nulltext" textAlign="center" displaytype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'maskeditcontrol' : 'nomal'" edittype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'mask' : 'none'" maskeditformat="##,###" tooltiptext="bind:SO_QTY" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="4" text="bind:INV_QTY" calendardisplaynulltype="nulltext" maskeditformat="##,###" textAlign="center" tooltiptext="bind:INV_QTY" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="5" text="bind:PO_PRICE" calendardisplaynulltype="nulltext" textAlign="right" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice1(currow)" maskeditformat="##,###" tooltiptext="bind:PO_PRICE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice2(currow)"/>
                                <Cell col="6" text="bind:TOTAL_AMT" calendardisplaynulltype="nulltext" textAlign="right" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice1(currow)" maskeditformat="##,###" tooltiptext="bind:TOTAL_AMT" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice2(currow)"/>
                                <Cell col="7" text="bind:DC_AMT" calendardisplaynulltype="nulltext" textAlign="right" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice1(currow)" maskeditformat="##,###" tooltiptext="bind:DC_AMT" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice2(currow)"/>
                                <Cell col="8" text="bind:PO_AMT" calendardisplaynulltype="nulltext" textAlign="right" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice1(currow)" maskeditformat="##,###" tooltiptext="bind:PO_AMT" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_poPrice2(currow)"/>
                                <Cell col="9" text="bind:BRANCH_GROUP" displaytype="combotext" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_tab_div4" combotype="filterlike" tooltiptext="bind:BRANCH_GROUP" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="10" text="bind:PO_BP_CD" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:PO_BP_CD" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="11" text="bind:REGION_NM" calendardisplaynulltype="nulltext" tooltiptext="bind:REGION_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="12" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button" text="선택"/>
                                <Cell col="13" text="bind:TEL_NO2" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:TEL_NO2" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="14" text="연락처" calendardisplaynulltype="nulltext" textAlign="center" displaytype="buttoncontrol" edittype="button"/>
                                <Cell col="15" text="bind:ETC_REMARK" calendardisplaynulltype="nulltext" tooltiptext="bind:ETC_REMARK" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage4" text="     탁송처리     ">
                    <Layouts>
                      <Layout>
                        <Static id="Static24" taborder="0" text="탁송정보" left="3" top="0" width="121" height="30" cssclass="sta_WF_title"/>
                        <Grid id="grd_list03" taborder="1" scrolltype="both" minwidth="" left="0" right="0" top="34" bottom="0" autoenter="select" selecttype="cell" autofittype="col" binddataset="ds_list_2" oncellclick="Div02_Tab00_Tabpage4_grd_list03_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="65"/>
                                <Column size="100"/>
                                <Column size="214"/>
                                <Column size="60"/>
                                <Column size="65"/>
                                <Column size="35"/>
                                <Column size="35"/>
                                <Column size="100"/>
                                <Column size="77"/>
                                <Column size="35"/>
                                <Column size="148"/>
                                <Column size="80"/>
                                <Column size="100"/>
                                <Column size="92"/>
                                <Column size="58"/>
                                <Column size="58"/>
                                <Column size="106"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분"/>
                                <Cell col="1" text="품목코드"/>
                                <Cell col="2" text="품목명"/>
                                <Cell col="3" text="탁송수량"/>
                                <Cell col="4" colspan="3" text="상차지점코드"/>
                                <Cell col="7" text="상차지점명"/>
                                <Cell col="8" colspan="2" text="하차지점코드"/>
                                <Cell col="10" text="하차지점명"/>
                                <Cell col="11" text="탁송비"/>
                                <Cell col="12" text="터미널"/>
                                <Cell col="13" text="비고"/>
                                <Cell col="14" text="탁송처리"/>
                                <Cell col="15" text="처리여부"/>
                                <Cell col="16" text="주문번호"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEAL_TYPE" displaytype="combotext" edittype="none" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" combotype="filterlike" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="1" text="bind:ITEM_CD" combodataset="ds_position" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="2" text="bind:ITEM_NM" combodataset="ds_user" combocodecol="USER_ID" combodatacol="USER_NAME" combotype="filterlike" tooltiptext="bind:ITEM_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="3" text="bind:MOVE_QTY" calendardisplaynulltype="nulltext" textAlign="center" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto4(currow)" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto5(currow)" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" maskeditautoselect="true" editautoselect="true"/>
                                <Cell col="4" text="bind:TS_BP_CD" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="5" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button" text="선택"/>
                                <Cell col="6" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button" text="연락처"/>
                                <Cell col="7" text="bind:TS_BP_NM" calendardisplaynulltype="nulltext" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="8" text="bind:PO_BP_CD" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="9" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button" text="연락처"/>
                                <Cell col="10" text="bind:REGION_NM" calendardisplaynulltype="nulltext" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="11" text="bind:MOVE_COST" calendardisplaynulltype="nulltext" textAlign="right" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto4(currow)" maskeditformat="##,###" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto5(currow)" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" maskeditautoselect="true" editautoselect="true"/>
                                <Cell col="12" text="bind:MOVE_ARR_LOC" calendardisplaynulltype="nulltext" textAlign="center" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto6(currow)" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto7(currow)" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="13" text="bind:MOVE_REMARK" calendardisplaynulltype="nulltext" displaytype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto6(currow)" edittype="expr:comp.parent.parent.parent.parent.parent.parent.fn_sto7(currow)" tooltiptext="bind:MOVE_REMARK" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="14" text="주문" calendardisplaynulltype="nulltext" displaytype="buttoncontrol" edittype="button"/>
                                <Cell col="15" text="bind:MOVE_YN" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="16" text="bind:SO_NO_ORI" calendardisplaynulltype="nulltext" textAlign="center" displaytype="buttoncontrol" edittype="button"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage5" text="     결제처리     ">
                    <Layouts>
                      <Layout>
                        <Static id="sta_24_00_00" taborder="9" left="656" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                        <Static id="sta_24_01" taborder="10" left="376" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                        <Static id="sta_24" taborder="3" left="101" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                        <Grid id="grd_list01" taborder="0" scrolltype="both" minwidth="" top="123" left="0" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" width="540" height="273" binddataset="ds_list_3" oncellclick="Div02_Tab00_Tabpage5_grd_list01_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="42"/>
                                <Column size="156"/>
                                <Column size="149"/>
                                <Column size="65"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                                <Row size="24" band="summ"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="순번"/>
                                <Cell col="1" text="결제방법"/>
                                <Cell col="2" text="결제금액"/>
                                <Cell col="3" text="저장유무"/>
                              </Band>
                              <Band id="body">
                                <Cell text="expr:currow+1" textAlign="center"/>
                                <Cell col="1" text="bind:PAY_TYPE" combodataset="ds_tab_div8" combocodecol="CODE" combodatacol="CODE_NAME" displaytype="combocontrol" edittype="combo"/>
                                <Cell col="2" text="bind:BILL_AMT" combotype="filterlike" displaytype="maskeditcontrol" edittype="mask" maskeditformat="##,###" maskeditautoselect="true"/>
                                <Cell col="3" text="bind:SAVE_CHK" combotype="filterlike" maskeditformat="##,###" maskeditautoselect="true" textAlign="center"/>
                              </Band>
                              <Band id="summary">
                                <Cell colspan="2"/>
                                <Cell col="2" text="expr:dataset.getSum(&quot;BILL_AMT&quot;)" displaytype="mask" maskeditformat="##,###"/>
                                <Cell col="3"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static24" taborder="1" text="결제 금액 정보" left="3" top="0" width="121" height="30" cssclass="sta_WF_title"/>
                        <Static id="Static19" taborder="2" text="결제 대상 금액" left="0" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                        <MaskEdit id="MaskEdit00" taborder="4" left="114" top="43" width="146" height="21" format="##,##0" readonly="true"/>
                        <Static id="Static19_01" taborder="5" text="과세 금액" left="275" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                        <MaskEdit id="MaskEdit00_01" taborder="6" left="389" top="43" width="146" height="21" format="##,###" readonly="true"/>
                        <MaskEdit id="MaskEdit00_00_00" taborder="7" left="669" top="43" width="146" height="21" format="##,###" readonly="true"/>
                        <Static id="Static19_00_00" taborder="8" text="비과세 금액" left="555" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                        <Static id="Static24_01" taborder="11" text="결제 항목 리스트" left="3" top="82" width="121" height="30" cssclass="sta_WF_title"/>
                        <Div id="Div00" taborder="12" text="Div00" left="550" top="78" height="310" width="730" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="sta_01_00_00_00_01_00" taborder="40" left="94" top="195" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_02_00" taborder="35" left="94" top="251" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_02" taborder="26" left="94" top="223" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_00_00_00" taborder="18" left="94" top="279" height="30" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_00_00" taborder="15" left="94" top="119" height="77" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_00" taborder="12" left="94" top="91" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00" taborder="7" left="94" top="63" height="29" cssclass="sta_WF_detailLine" width="636" text=""/>
                              <Static id="sta_21" taborder="6" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static24_01" taborder="0" text="카드 결제" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Button id="btn_pay" taborder="1" text="결제" top="4" width="80" height="24" right="180" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_btn_pay_onclick"/>
                              <Button id="btn_payCancel" taborder="2" text="결제취소" top="4" width="80" height="24" right="90" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_Div00_btn_payCancel_onclick"/>
                              <Button id="btn_receipt" taborder="3" text="영수증확인" top="4" width="80" height="24" right="0" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_Div00_btn_receipt_onclick"/>
                              <Radio id="Radio_dealType" taborder="4" left="118" top="40" width="302" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div5" onitemchanged="Div02_Tab00_Tabpage5_Div00_Radio_dealType_onitemchanged"/>
                              <Static id="Static05" taborder="5" text="결제 상태" left="0" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00" taborder="8" text="결제금액" left="0" top="63" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <Static id="Static11_00_00_00" taborder="9" text="팩스" left="339" top="195" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="10" left="104" top="67" width="129" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="11" text="메모1" left="241" top="63" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <Edit id="edt_mRoomNo" taborder="13" left="443" top="199" width="281" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_01_01" taborder="14" text="기타메모" left="0" top="119" width="100" cssclass="sta_WF_detailLabel" height="77"/>
                              <Static id="Static11_00_00_01" taborder="16" text="카드 승인 번호" left="0" top="279" width="100" cssclass="sta_WF_detailLabel" height="31"/>
                              <MaskEdit id="MaskEdit00_00_00_00" taborder="17" left="104" top="283" width="132" height="22"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00" taborder="19" left="344" top="283" width="133" height="22" enable="false"/>
                              <Static id="Static11_00_00_01_00" taborder="20" text="카드 주문 번호" left="240" top="279" width="100" cssclass="sta_WF_detailLabel" height="30"/>
                              <Static id="Static11_00_01_02" taborder="21" text="메모2" left="0" top="91" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <Static id="Static11_00_01_02_00" taborder="22" text="HP" left="241" top="91" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="Edit00_00_00" taborder="23" left="345" top="95" width="142" height="21"/>
                              <Static id="Static11_00_00_02" taborder="24" text="과세금액" left="0" top="223" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01" taborder="25" left="104" top="227" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_02_00" taborder="27" text="비과세금액" left="240" top="223" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01_00" taborder="28" left="344" top="227" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_02_00_00" taborder="29" left="481" top="223" width="1" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_02_00_00_00" taborder="30" left="491" top="63" width="1" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_02_01" taborder="31" text="공급가액" left="0" top="251" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01_01" taborder="32" left="104" top="255" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_02_00_01" taborder="33" text="부가세액" left="240" top="251" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01_00_00" taborder="34" left="344" top="255" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_02_00_00_01" taborder="36" left="481" top="251" width="1" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_02_00_00_01_00" taborder="37" left="481" top="280" width="1" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_00_00" taborder="38" text="이메일" left="0" top="195" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo00" taborder="39" left="104" top="199" width="229" height="21" enable="true" readonly="false"/>
                              <MaskEdit id="MaskEdit00" taborder="41" left="345" top="67" width="142" height="21" type="string" format="####-####-####-####" textAlign="left" autoselect="true"/>
                              <Calendar id="txt_Month" taborder="42" left="104" top="95" width="133" height="21" editformat="yyyy-MM" dateformat="yyyy-MM" type="spin" showmonthspin="false" onkeyup="div_search_txt_Month_onkeyup"/>
                              <TextArea id="TextArea00" taborder="43" left="104" top="124" width="620" height="67"/>
                              <Static id="Static11_00_00_02_00_00_00_00" taborder="44" left="491" top="91" width="1" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_01_00_00" taborder="45" text="취소 주문 번호" left="481" top="279" width="100" cssclass="sta_WF_detailLabel" height="30"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00_00" taborder="46" left="585" top="283" width="133" height="22" enable="false"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Static id="Static08_00" taborder="13" left="540" top="10" width="10" cssclass="sta_WF_guideRed" visible="false" text="w&#13;&#10;10" height="400"/>
                        <Button id="btn_addCard" taborder="14" text="추가" top="85" width="45" height="24" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_btn_addCard_onclick" left="494"/>
                        <Button id="btn_delCard" taborder="15" text="삭제" top="85" width="45" height="24" visible="false" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_btn_delCard_onclick" left="434"/>
                        <Div id="Div05" taborder="16" text="Div00" left="4270" top="88" width="730" height="310" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="Static24_01" taborder="0" text="비고" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Static id="sta_01_00_00_00_00" taborder="1" left="94" top="63" height="93" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_21" taborder="2" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static11_00_00" taborder="3" text="결제금액" left="0" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="4" left="105" top="39" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="5" text="메모" left="0" top="63" width="100" cssclass="sta_WF_detailLabel" height="93"/>
                              <TextArea id="TextArea00" taborder="6" left="105" top="68" width="620" height="83"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="Div04" taborder="17" text="Div00" left="3530" top="88" width="730" height="310" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="Static24_01" taborder="0" text="의전지원" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Static id="sta_21_00" taborder="1" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="sta_01_00_00_00_00" taborder="2" left="94" top="91" height="93" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_21" taborder="3" left="99" top="63" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static11_00_00" taborder="4" text="결제금액" left="0" top="63" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="5" left="105" top="67" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="6" text="메모" left="0" top="91" width="100" cssclass="sta_WF_detailLabel" height="93"/>
                              <TextArea id="TextArea00" taborder="7" left="105" top="96" width="620" height="83"/>
                              <Static id="Static05" taborder="8" text="결제 구분" left="0" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Radio id="Radio_dealType" taborder="9" left="118" top="40" width="302" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div7"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="Div03" taborder="18" text="Div00" left="2790" top="88" width="730" height="310" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="sta_01_00_00_00_00" taborder="5" left="94" top="63" height="93" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_21" taborder="1" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static24_01" taborder="0" text="본사지원" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Static id="Static11_00_00" taborder="2" text="결제금액" left="0" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="3" left="105" top="39" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="4" text="메모" left="0" top="63" width="100" cssclass="sta_WF_detailLabel" height="93"/>
                              <TextArea id="TextArea00" taborder="6" left="105" top="68" width="620" height="83"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="Div02" taborder="19" text="Div00" left="2050" top="78" width="730" height="310" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="sta_01_00_00_00_01_00_00_00" taborder="24" left="94" top="203" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_01_00_00" taborder="21" left="94" top="175" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_01_00" taborder="18" left="94" top="147" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_02" taborder="15" left="94" top="91" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_00" taborder="8" left="94" top="231" height="79" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00" taborder="4" left="94" top="63" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_21" taborder="3" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static24_01" taborder="0" text="계산서 발행" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Radio id="Radio_dealType" taborder="1" left="118" top="40" width="302" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div7"/>
                              <Static id="Static05" taborder="2" text="발행 상태" left="0" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00" taborder="5" text="결제금액" left="0" top="63" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="6" left="104" top="67" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="7" text="메모" left="0" top="231" width="100" cssclass="sta_WF_detailLabel" height="79"/>
                              <TextArea id="TextArea00" taborder="9" left="105" top="236" width="620" height="69"/>
                              <Static id="sta_01_00_00_00_01" taborder="10" left="94" top="119" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="Static11_00_00_01" taborder="11" text="담당자" left="0" top="119" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo" taborder="12" left="105" top="123" width="132" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_00_00_01" taborder="13" text="사업자등록번호" left="0" top="91" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00" taborder="14" left="105" top="95" width="132" height="21" type="string" format="###-##-#####" textAlign="left" autoselect="true"/>
                              <Static id="Static11_00_00_01_00" taborder="16" text="담당자 연락처" left="0" top="147" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo01" taborder="17" left="105" top="151" width="132" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_00_01_00_00" taborder="19" text="이메일" left="0" top="175" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo01_00" taborder="20" left="105" top="179" width="132" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_00_01_00_00_00" taborder="22" text="팩스" left="0" top="203" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo01_00_00" taborder="23" left="105" top="207" width="132" height="21" enable="true" readonly="false"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="Div01" taborder="20" text="Div00" left="590" top="78" width="730" height="310" visible="false">
                          <Layouts>
                            <Layout>
                              <Static id="sta_01_00_00_00_00_00" taborder="41" left="94" top="63" height="59" cssclass="sta_WF_detailLine" width="636"/>
                              <TextArea id="TextArea00_00" taborder="40" left="110" top="68" width="615" height="49"/>
                              <Static id="sta_01_00_00_00_01_00" taborder="38" left="94" top="225" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_02" taborder="18" left="94" top="149" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_01" taborder="11" left="94" top="121" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_00" taborder="8" left="94" top="177" height="49" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_21" taborder="3" left="99" top="35" height="29" cssclass="sta_WF_detailLine" width="631"/>
                              <Static id="Static24_01" taborder="0" text="통장 입금" left="3" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                              <Radio id="Radio_dealType" taborder="1" left="118" top="40" width="164" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div6"/>
                              <Static id="Static05" taborder="2" text="결제 상태" left="0" top="35" width="105" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00" taborder="4" text="결제금액" left="282" top="35" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_00" taborder="5" text="예금주" left="523" top="35" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="6" left="386" top="39" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_01" taborder="7" text="메모 2" left="0" top="177" width="105" cssclass="sta_WF_detailLabel" height="49"/>
                              <TextArea id="TextArea00" taborder="9" left="110" top="182" width="615" height="39"/>
                              <Edit id="edt_mRoomNo" taborder="10" left="627" top="39" width="99" height="21" enable="true" readonly="false"/>
                              <Button id="btn_receiptPay" taborder="12" text="발행" top="124" width="80" height="23" right="184" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_Div01_btn_receiptPay_onclick"/>
                              <Button id="btn_receiptCancel" taborder="13" text="발행취소" top="124" width="80" height="23" right="94" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_Div01_btn_receiptCancel_onclick"/>
                              <Button id="btn_search01" taborder="14" text="영수증확인" top="124" width="80" height="23" right="4" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage5_Div01_btn_search01_onclick"/>
                              <Static id="Static05_00" taborder="15" text="결제 구분" left="0" top="121" width="105" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <Radio id="Radio_dealType00" taborder="16" left="118" top="126" width="215" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div9" onitemchanged="Div02_Tab00_Tabpage5_Div01_Radio_dealType00_onitemchanged"/>
                              <Static id="Static100" taborder="17" text="휴대폰/카드번호" left="0" top="149" width="105" cssclass="sta_WF_detailLabel_ess" height="29"/>
                              <Static id="Static200" taborder="19" text="사업자 번호" left="482" top="189" width="105" cssclass="sta_WF_detailLabel_ess" height="29" tooltiptext="현금영수증 카드번호" visible="false"/>
                              <Static id="sta_01_00_00_00_02_00" taborder="20" left="94" top="281" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="sta_01_00_00_00_02_01" taborder="21" left="94" top="253" height="29" cssclass="sta_WF_detailLine" width="636"/>
                              <Static id="Static11_00_00_01_00" taborder="22" text="승인 번호" left="482" top="225" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00" taborder="23" left="586" top="229" width="138" height="20"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00_00" taborder="24" left="586" top="257" width="143" height="21"/>
                              <Static id="Static11_00_00_01_00_00" taborder="25" text="주문 번호" left="482" top="253" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Static id="Static11_00_00_02" taborder="26" text="과세금액" left="0" top="253" width="105" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01" taborder="27" left="109" top="257" width="127" height="21" format="##,###"/>
                              <Static id="Static11_00_00_02_00" taborder="28" text="비과세금액" left="240" top="253" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_01_00" taborder="29" left="344" top="257" width="133" height="21" format="##,###"/>
                              <Static id="Static11_00_00_02_01" taborder="30" text="공급가액" left="0" top="281" width="105" cssclass="sta_WF_detailLabel_ess" height="29" color="#0d2cf6" font="normal 600 10pt/normal &quot;Arial&quot;"/>
                              <MaskEdit id="MaskEdit00_00_00_01_01" taborder="31" left="109" top="285" width="127" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_02_00_01" taborder="32" text="부가세액" left="240" top="281" width="100" cssclass="sta_WF_detailLabel_ess" height="29" color="#0d2cf6" font="normal 600 10pt/normal &quot;Arial&quot;"/>
                              <MaskEdit id="MaskEdit00_00_00_01_00_00" taborder="33" left="344" top="285" width="133" height="21" enable="false" format="##,###"/>
                              <Static id="Static11_00_00_00_00_00" taborder="34" text="이메일" left="0" top="225" width="105" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo00_00" taborder="35" left="109" top="229" width="127" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_00_00_01" taborder="36" text="팩스" left="240" top="225" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="edt_mRoomNo01" taborder="37" left="344" top="229" width="133" height="21" enable="true" readonly="false"/>
                              <Static id="Static11_00_01_00" taborder="39" text="메모 1" left="0" top="63" width="105" cssclass="sta_WF_detailLabel" height="59"/>
                              <Static id="Static11_00_00_01_00_00_00" taborder="42" text="취소 번호" left="482" top="281" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00_00_00_00_00" taborder="43" left="586" top="285" width="143" height="21"/>
                              <Radio id="Radio_dealType01" taborder="44" left="409" top="154" width="302" height="21" codecolumn="CODE" datacolumn="CODE_NAME" direction="vertical" innerdataset="ds_tab_div11"/>
                              <Static id="Static05_01" taborder="45" text="발행 상태" left="291" top="149" width="100" cssclass="sta_WF_detailLabel" height="29"/>
                              <Edit id="ME_hp" taborder="46" left="111" top="153" width="129" height="21" readonly="false" inputtype="digit"/>
                              <Edit id="ME_card" taborder="47" left="592" top="193" width="134" height="21" readonly="false" inputtype="digit" visible="false"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage6" text="       메모       ">
                    <Layouts>
                      <Layout>
                        <Grid id="grd_list01" taborder="0" scrolltype="both" minwidth="" top="34" bottom="0" left="0" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" binddataset="ds_memo" right="0">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="110"/>
                                <Column size="102"/>
                                <Column size="152"/>
                                <Column size="850"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="65"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="작성일자"/>
                                <Cell col="1" text="작성자"/>
                                <Cell col="2" text="메모구분"/>
                                <Cell col="3" text="내용"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:INSRT_DT" calendardateformat="yyyy-MM-dd HH:mm:ss" calendardisplaynulltype="none" textAlign="center"/>
                                <Cell col="1" combodataset="ds_user" combocodecol="USR_ID" combodatacol="USR_NM" combotype="filterlike" text="bind:INSRT_USER_ID" displaytype="combotext"/>
                                <Cell col="2" combodataset="ds_tab_div10" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" displaytype="combocontrol" edittype="combo" text="bind:MEMO_DIV"/>
                                <Cell col="3" text="bind:MEMO" textAlign="left" maskeditformat="###.##" displaytype="textareacontrol" edittype="textarea"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                        <Static id="Static02" taborder="1" text="메모" left="0" top="1" width="121" height="30" cssclass="sta_WF_title"/>
                        <Button id="btn_add_memo" taborder="2" text="추가" top="5" width="45" height="24" visible="true" onclick="fn_addBtnClick_2" cssclass="btn_WF_main1" right="62"/>
                        <Button id="btn_del_memo" taborder="3" text="삭제" top="5" width="45" height="24" visible="false" onclick="fn_delBtnClick_2" cssclass="btn_WF_main1" right="7"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage7" text="     주문확정     ">
                    <Layouts>
                      <Layout>
                        <Div id="Div00" taborder="0" text="Div00" left="0" top="3" height="393" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="Static24" taborder="0" text="결제 금액 정보" left="3" top="0" width="121" height="30" cssclass="sta_WF_title"/>
                              <Static id="sta_24" taborder="1" left="101" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                              <Static id="sta_24_01" taborder="2" left="376" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                              <Static id="sta_24_00_00" taborder="3" left="656" top="39" height="29" cssclass="sta_WF_detailLine" width="164"/>
                              <Static id="Static00_00_00_02" taborder="4" text="주문삭제사유" top="44" height="20" textAlign="right" right="131" width="83"/>
                              <Combo id="cmb_PM00" taborder="5" top="43" height="21" text="선택" value="" index="-1" codecolumn="CODE" datacolumn="CODE_NAME" type="filterlike" right="1" width="119" innerdataset=""/>
                              <Button id="btn_confirm" taborder="6" text="주문확정" top="11" width="80" height="24" right="270" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_confirm_onclick" enable="true" visible="true"/>
                              <Button id="btn_cancel" taborder="7" text="주문취소" top="11" width="80" height="24" right="180" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_cancel_onclick" enable="true" visible="true"/>
                              <Button id="btn_DEL" taborder="8" text="주문삭제" top="11" width="80" height="24" right="90" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_DEL_onclick" enable="true"/>
                              <Grid id="grd_list03" taborder="9" scrolltype="both" minwidth="" left="0" right="0" top="79" bottom="0" autoenter="select" selecttype="cell" autofittype="col" binddataset="ds_list_2" summarytype="top">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="65"/>
                                      <Column size="100"/>
                                      <Column size="380"/>
                                      <Column size="60"/>
                                      <Column size="100"/>
                                      <Column size="100"/>
                                      <Column size="182"/>
                                      <Column size="195"/>
                                      <Column size="87"/>
                                      <Column size="114"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                      <Row size="24" band="summ"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="구분"/>
                                      <Cell col="1" text="품목코드"/>
                                      <Cell col="2" text="품목명"/>
                                      <Cell col="3" text="수량"/>
                                      <Cell col="4" text="단가"/>
                                      <Cell col="5" text="금액"/>
                                      <Cell col="6" text="지점"/>
                                      <Cell col="7" text="리본메시지"/>
                                      <Cell col="8" text="탁송처리여부"/>
                                      <Cell col="9" text="FSMS 품목추가여부"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="bind:DEAL_TYPE" displaytype="combotext" edittype="none" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" combotype="filterlike" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="1" text="bind:ITEM_CD" combotype="filterlike" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="2" text="bind:ITEM_NM" combotype="filterlike" tooltiptext="bind:ITEM_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="3" text="bind:SO_QTY" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="4" text="bind:SO_PRICE" calendardisplaynulltype="nulltext" displaytype="mask" maskeditformat="##,###" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="5" text="bind:TOTAL_PRICE" calendardisplaynulltype="nulltext" displaytype="mask" maskeditformat="##,###" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="6" text="bind:REGION_NM" calendardisplaynulltype="nulltext" tooltiptext="bind:REGION_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="7" text="bind:RIBBON_MESSAGE" calendardisplaynulltype="nulltext" tooltiptext="bind:RIBBON_MESSAGE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="8" text="bind:MOVE_YN" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="9" text="bind:FSMS_ADD_YN" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                    </Band>
                                    <Band id="summary">
                                      <Cell colspan="5" text="합       계 " textAlign="right"/>
                                      <Cell col="5" text="expr:dataset.getSum(&quot;NET_AMT&quot;)+dataset.getSum(&quot;VAT_AMT&quot;)" displaytype="mask" maskeditformat="##,###"/>
                                      <Cell col="6" colspan="4"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                              <Button id="btn_report" taborder="10" text="미리보기" top="11" width="80" height="24" right="0" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_report_onclick" enable="true"/>
                              <Static id="Static19" taborder="11" text="결제 대상 금액" left="0" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00" taborder="12" left="114" top="43" width="146" height="21" format="##,###" enable="false"/>
                              <Static id="Static19_01" taborder="13" text="과세 금액" left="275" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_01" taborder="14" left="389" top="43" width="146" height="21" format="##,###" enable="false"/>
                              <Static id="Static19_00_00" taborder="15" text="비과세 금액" left="555" top="39" width="110" cssclass="sta_WF_detailLabel" height="29"/>
                              <MaskEdit id="MaskEdit00_00_00" taborder="16" left="669" top="43" width="146" height="21" format="##,###" enable="false"/>
                              <Button id="btn_sinwooriSms" taborder="17" top="11" width="109" height="24" text="신우리몰 알림" cssclass="btn_WF_main1" right="360" onclick="Div02_Tab00_Tabpage7_Div00_btn_sinwooriSms_onclick" visible="false"/>
                            </Layout>
                          </Layouts>
                        </Div>
                        <Div id="Div00_00" taborder="1" text="Div00" left="1300" top="3" height="394" visible="false" right="0">
                          <Layouts>
                            <Layout>
                              <Static id="Static00_00_00_02" taborder="0" text="주문삭제사유" top="44" height="20" textAlign="right" right="131" width="83"/>
                              <Combo id="cmb_PM00" taborder="1" top="43" height="21" text="선택" value="" index="-1" codecolumn="CODE" datacolumn="CODE_NAME" type="filterlike" right="0" width="119" innerdataset=""/>
                              <Button id="btn_confirm" taborder="2" text="주문확정" top="11" width="80" height="24" right="270" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_confirm_onclick"/>
                              <Button id="btn_cancel" taborder="3" text="주문취소" top="11" width="80" height="24" right="180" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_cancel_onclick"/>
                              <Button id="btn_DEL" taborder="4" text="주문삭제" top="11" width="80" height="24" right="90" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_DEL_onclick"/>
                              <Grid id="grd_list03" taborder="5" scrolltype="both" minwidth="" left="0" right="0" top="79" bottom="1" autoenter="select" selecttype="cell" autofittype="col" binddataset="ds_list_2" summarytype="top" oncellclick="Div02_Tab00_Tabpage7_Div00_00_grd_list03_oncellclick">
                                <Formats>
                                  <Format id="default">
                                    <Columns>
                                      <Column size="65"/>
                                      <Column size="100"/>
                                      <Column size="380"/>
                                      <Column size="60"/>
                                      <Column size="100"/>
                                      <Column size="182"/>
                                      <Column size="51"/>
                                      <Column size="182"/>
                                      <Column size="51"/>
                                      <Column size="87"/>
                                    </Columns>
                                    <Rows>
                                      <Row size="24" band="head"/>
                                      <Row size="24"/>
                                    </Rows>
                                    <Band id="head">
                                      <Cell text="구분"/>
                                      <Cell col="1" text="품목코드"/>
                                      <Cell col="2" text="품목명"/>
                                      <Cell col="3" text="수량"/>
                                      <Cell col="4" text="발주금액"/>
                                      <Cell col="5" colspan="2" text="출발지점"/>
                                      <Cell col="7" colspan="2" text="도착지점"/>
                                      <Cell col="9" text="원주문번호"/>
                                    </Band>
                                    <Band id="body">
                                      <Cell text="bind:DEAL_TYPE" displaytype="combotext" edittype="none" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" combotype="filterlike" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="1" text="bind:ITEM_CD" combotype="filterlike" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="2" text="bind:ITEM_NM" combotype="filterlike" tooltiptext="bind:ITEM_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="3" text="bind:SO_QTY" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="4" text="bind:PO_PRICE" calendardisplaynulltype="nulltext" displaytype="mask" maskeditformat="##,###" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="5" text="bind:REGION_NM" calendardisplaynulltype="nulltext" tooltiptext="bind:REGION_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="6" text="선택" calendardisplaynulltype="nulltext" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" textAlign="center" displaytype="buttoncontrol" edittype="button"/>
                                      <Cell col="7" text="bind:TS_BP_NM" calendardisplaynulltype="nulltext" tooltiptext="bind:TS_BP_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                      <Cell col="8" text="선택" calendardisplaynulltype="nulltext" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" textAlign="center" displaytype="buttoncontrol" edittype="button"/>
                                      <Cell col="9" text="bind:SO_NO_ORI" calendardisplaynulltype="nulltext" textAlign="center" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="buttoncontrol" edittype="button"/>
                                    </Band>
                                  </Format>
                                </Formats>
                              </Grid>
                              <Button id="btn_report" taborder="6" text="미리보기" top="11" width="80" height="24" right="0" visible="true" cssclass="btn_WF_main1" onclick="Div02_Tab00_Tabpage7_btn_report_onclick"/>
                            </Layout>
                          </Layouts>
                        </Div>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="Tabpage8" text="플라시스템 정보">
                    <Layouts>
                      <Layout>
                        <Static id="Static24" taborder="0" text="플라시스템 정보" left="3" top="0" width="121" height="30" cssclass="sta_WF_title"/>
                        <Grid id="grd_list03" taborder="1" scrolltype="both" minwidth="" left="0" right="0" top="34" bottom="0" autoenter="select" selecttype="cell" autofittype="col" binddataset="ds_list_2" oncellclick="Div02_Tab00_Tabpage8_grd_list03_oncellclick">
                          <Formats>
                            <Format id="default">
                              <Columns>
                                <Column size="69"/>
                                <Column size="97"/>
                                <Column size="226"/>
                                <Column size="50"/>
                                <Column size="79"/>
                                <Column size="148"/>
                                <Column size="99"/>
                                <Column size="119"/>
                                <Column size="119"/>
                                <Column size="97"/>
                                <Column size="168"/>
                                <Column size="76"/>
                                <Column size="76"/>
                                <Column size="76"/>
                              </Columns>
                              <Rows>
                                <Row size="24" band="head"/>
                                <Row size="24"/>
                              </Rows>
                              <Band id="head">
                                <Cell text="구분"/>
                                <Cell col="1" text="품목코드"/>
                                <Cell col="2" text="품목명"/>
                                <Cell col="3" text="수량"/>
                                <Cell col="4" text="지점코드"/>
                                <Cell col="5" text="지점명"/>
                                <Cell col="6" text="연락처"/>
                                <Cell col="7" text="FLA 주문번호"/>
                                <Cell col="8" text="FLA 주문상태"/>
                                <Cell col="9" text="결과코드"/>
                                <Cell col="10" text="결과내용"/>
                                <Cell col="11" text="발주"/>
                                <Cell col="12" text="발주취소"/>
                                <Cell col="13" text="사진"/>
                              </Band>
                              <Band id="body">
                                <Cell text="bind:DEAL_TYPE" displaytype="combotext" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_div3" combotype="filterlike" tooltiptext="bind:DEAL_TYPE" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="1" text="bind:ITEM_CD" combodataset="ds_position" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" textAlign="center" tooltiptext="bind:ITEM_CD" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="2" text="bind:ITEM_NM" combodataset="ds_user" combocodecol="USER_ID" combodatacol="USER_NAME" combotype="filterlike" tooltiptext="bind:ITEM_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="3" text="bind:SO_QTY" calendardisplaynulltype="nulltext" textAlign="center" displaytype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'maskeditcontrol' : 'nomal'" edittype="expr:UPDT_DIV=='2' &amp;&amp; PO_STATUS=='0' ? 'mask' : 'none'" maskeditformat="##,###" tooltiptext="bind:SO_QTY" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="4" text="bind:PO_BP_CD" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:PO_BP_CD" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="5" text="bind:REGION_NM" calendardisplaynulltype="nulltext" tooltiptext="bind:REGION_NM" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="6" text="bind:TEL_NO2" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:TEL_NO2" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="7" text="bind:ADD_CD2" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:ADD_CD2" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="8" text="bind:ADD_CD3" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:ADD_CD3" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="combotext" edittype="combo" combocodecol="CODE" combodatacol="CODE_NAME" combodataset="ds_fla_status"/>
                                <Cell col="9" text="bind:ADD_CD5" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="bind:ADD_CD5" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="10" text="bind:ADD_CD6" calendardisplaynulltype="nulltext" textAlign="left" tooltiptext="bind:ADD_CD6" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'"/>
                                <Cell col="11" text="발주" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="발주" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="buttoncontrol" edittype="button"/>
                                <Cell col="12" text="발주취소" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="발주취소" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="buttoncontrol" edittype="button"/>
                                <Cell col="13" text="보기" calendardisplaynulltype="nulltext" textAlign="center" tooltiptext="보기" cssclass="expr:PO_STATUS==&quot;1&quot; ? 'status' : 'status2'" displaytype="buttoncontrol" edittype="button"/>
                              </Band>
                            </Format>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Static id="Static00" taborder="1" top="11" height="20" background="#ededed" right="84" width="30"/>
              <Static id="Static01" taborder="2" text=": 발주확정" top="9" height="25" font="normal bold 10pt/normal &quot;Arial&quot;" right="10" width="64"/>
            </Layout>
          </Layouts>
        </Div>
        <Plugin id="Plugin00" taborder="7" left="1093" top="991" width="37" height="39" classid="{5DA6D279-ADDA-4F5B-821F-B211EB09EF1A}" classid64="{5DA6D279-ADDA-4F5B-821F-B211EB09EF1A}" visible="false"/>
        <WebBrowser id="WebBrowser00" taborder="8" left="364" top="1022" width="610" height="138" visible="false"/>
        <Static id="Static10_00_00_00" taborder="9" text="상품팁" left="10" top="501" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
        <Static id="Static10_00_00_00_00" taborder="10" text="안내팁" left="10" top="529" width="100" cssclass="sta_WF_detailLabel_ess" height="29"/>
        <Static id="sta_05_00_00_00" taborder="11" top="529" height="29" cssclass="sta_WF_detailLine" left="110" right="11"/>
        <Edit id="edt_cMemo" taborder="12" top="505" height="21" readonly="true" onkeyup="div_search_onkeyup" left="113" right="17" font="normal bold 10pt/normal &quot;Arial&quot;" color="#f40000"/>
        <Edit id="edt_cMemo00" taborder="13" top="533" height="21" readonly="true" onkeyup="div_search_onkeyup" left="113" right="17" font="normal bold 10pt/normal &quot;Arial&quot;" color="#020af2"/>
        <Grid id="grd_list01" taborder="15" scrolltype="both" minwidth="" top="40" left="1017" autoenter="select" selecttype="cell" summarytype="default" autofittype="col" height="316" right="10" font="12px/normal &quot;Malgun Gothic&quot;,&quot;Verdana&quot;" binddataset="ds_grd1" autosizingtype="row" extendsizetype="row" onkeydown="Div01_grd_list01_onkeydown" cellsizingtype="row">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="272"/>
              </Columns>
              <Rows>
                <Row size="32"/>
              </Rows>
              <Band id="body">
                <Cell text="bind:TIP_DESC" combodataset="ds_survey" combocodecol="CODE" combodatacol="CODE_NAME" combotype="filterlike" wordWrap="char" cssclass="expr:IMPORTANT_FLAG=='Y'?'lv1' : ''"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <WebBrowser id="WebBrowser00_00" taborder="16" left="1036" top="94" right="147" onusernotify="WebBrowser00_00_onusernotify" height="115" visible="false"/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[// 전역변수 설정
var T_SO_NO = null;
var flaFlag = "N";
// /**
// *  주문등록
// *  @MenuPath    SO > SO001
// *  @FileName 	SO001.xfdl 
// *  @Creator 	심재문
// *  @CreateDate 	2020.04.16
// *  @Desction    
// *  @TO_DO : 
// *************************** 소스 수정 이력 ************************************
// *  date          		        Modifier                      Description
// *******************************************************************************
// *  
// *******************************************************************************
// */
// 
// /************************************************************************************************
//  * FORM 변수 선언 영역
//  ************************************************************************************************/
 
// /***********************************************************************************************
// * FORM EVENT 영역(onload)
// /***********************************************************************************************/
this.Form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
 	this.gfn_formOnLoad(this);	
 	this.objApp = nexacro.getApplication();

	//콤보 세팅
	this.fn_setCombo(obj);
	
	if (!this.gfn_isNull(this.objApp.gds_so_no.getColumn(0,"SO_NO")))
	{	
		this.fn_search(this.objApp.gds_so_no.getColumn(0,"SO_NO"));
	} else 
	{
		this.fn_add();
	}
 };

// 콤보 세팅
this.fn_setCombo = function (obj)
{
	this.efn_SetComboData(obj,this.objApp.gds_user,"ds_userIn",this.Div00.form.cmb_regUser,"",false,false);		// 접수자
	this.efn_SetComboData(obj,this.objApp.gds_code,"ds_rcptMethIn",this.Div00.form.cmb_rcptMeth,"MAJOR_CD=='XN031'",false,false);	// 주문접수경로
	this.efn_SetComboData(obj,this.objApp.gds_code,"ds_delReason",this.Div02.form.Tab00.Tabpage7.form.Div00.form.cmb_PM00,"MAJOR_CD=='ZZ106'",false,false);	// 삭제사유
	this.efn_SetComboData(obj,this.objApp.gds_code,"ds_delReason2",this.Div02.form.Tab00.Tabpage7.form.Div00_00.form.cmb_PM00,"MAJOR_CD=='ZZ106'",false,false);	// 삭제사유
	this.efn_SetDatasetData(this.ds_div3,this.objApp.gds_code,'XS072');			// 법인/개인구분
	this.efn_SetDatasetData(this.ds_div1,this.objApp.gds_code,'ZZ101');			// 배송일자 타입구분
	this.efn_SetDatasetData(this.ds_tab_div1,this.objApp.gds_code,'ZZ102');		// Web_표준예외구분
	this.efn_SetDatasetData(this.ds_tab_div2,this.objApp.gds_code,'M2201');		// 지급구분(유,무상)
	this.efn_SetDatasetData(this.ds_tab_div3,this.objApp.gds_code,'ZZ103');		// Web_무상사유
	this.efn_SetDatasetData(this.ds_tab_div10,this.objApp.gds_code,'ZZ104');		// 메모 구분
	//this.efn_SetDatasetData(this.ds_tab_div10_1,this.objApp.gds_code,'ZZ301');		// 메모 구분(대)
	//this.efn_SetDatasetData(this.ds_tab_div10_2,this.objApp.gds_code,'ZZ302');		// 메모 구분(중)
	//this.efn_SetDatasetData(this.ds_tab_div10_3,this.objApp.gds_code,'ZZ303');		// 메모 구분(소)
	this.efn_SetDatasetData(this.ds_tab_div12,this.objApp.gds_code,'ZZ105');		// 조정 사유
	this.efn_SetDatasetData2(this.ds_fuDiv,this.objApp.gds_code2,'SO010');		// 장례구분
	
	
	this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);
	
	//trace(this.objApp.gds_user4.saveXML())
	//this.efn_SetDatasetData(this.ds_client_grade,this.objApp.gds_code,'10650');
 	this.efn_SetGrdUserData(this.ds_user,this.objApp.gds_user);
	this.efn_SetGrdUserData(this.ds_userIn2,this.objApp.gds_user4);   // 재직중 유저
// 	this.efn_SetGrdUserData(this.ds_dept,this.objApp.gds_dept);
};

 /************************************************************************************************
 * 사용자 FUNCTION 영역
 ************************************************************************************************/
 /**
* @description 		공통신규버튼
* @작성자	   		심재문
* @작성일자	   	2020.04.14
* @수정자	   
* @수정일자
*/
// 조회
this.fn_search = function (soNo)
{
	if (this.gfn_isNull(soNo))
	{
		if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition)))
		{
			if (!this.confirm("저장된 주문번호가 없습니다. 조회하시겠습니까?"))
			{
				return;
			}
		} else
		{
			soNo = this.ds_list.getColumn(this.ds_list.rowposition);
		}		
	}
	
	var id = "SO001_S00_00";
	var url = "svcUrl::SO001_S00_00";
	var inDs = "";
	var outDs = "ds_list=ds_list";
	var args = "SO_NO="+soNo;
	var callBackid = "fn_afterSearch";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	
	T_SO_NO = null;
};

this.fn_afterSearch = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}	
	
	if (!this.gfn_isNull(this.objApp.gds_so_no.getColumn(0,"SO_NO")))
	{
		this.objApp.gds_so_no.setColumn(0,"SO_NO","");
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6213") //  꽃잠
	{
		this.Div00.form.btn_manual.set_visible(true);
		this.Div00.form.btn_manual.set_text("꽃잠 대응 매뉴얼");
	} else if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6244" || this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6267")
	{
		this.Div00.form.btn_manual.set_visible(true);
		this.Div00.form.btn_manual.set_text("신우리 추천상품");
	} else
	{
		this.Div00.form.btn_manual.set_visible(false);
	}
	
	//대상자 팝업버튼 체크
	if (this.ds_list.getColumn(this.ds_list.rowposition,"USR_FLAG") > 0)
	{
		this.Div00.form.btn_usr1.set_visible(true);
		this.Div00.form.edt_usr1.set_enable(true);
	} else
	{
		this.Div00.form.btn_usr1.set_visible(false);
		this.Div00.form.edt_usr1.set_enable(true);
	}
	
	//주문자 팝업버튼 체크
	if (this.ds_list.getColumn(this.ds_list.rowposition,"USR_FLAG2") > 0)
	{
		this.Div00.form.btn_usr2.set_visible(true);
		this.Div00.form.edt_usr2.set_enable(true);
	} else 
	{
		this.Div00.form.btn_usr2.set_visible(false);
		this.Div00.form.edt_usr2.set_enable(true);
	}
	
	// 주문팁 조회
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var contNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	
	var id = "SO001_S01";
	var url = "svcUrl::SO001_S01";
	var inDs = "";
	var outDs = "ds_grd1=ds_list ds_item_tip=ds_list_2 ds_item_tip2=ds_list_3";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterSearch2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	
	//부고문자서비스
	this.fn_bugochk();
}

this.fn_afterSearch2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var tip1 = this.ds_item_tip.getColumn(this.ds_item_tip.rowposition,"TIP_DESC");
	var tip2 = this.ds_item_tip2.getColumn(this.ds_item_tip2.rowposition,"TIP_DESC");
	tip1 = this.gfn_nvl(tip1,"1");
	tip2 = this.gfn_nvl(tip2,"1");
	if (tip1.indexOf("편의") != '-1' || tip2.indexOf("편의") != '-1')
	{
		this.Div00.form.btn_reqSms00_00.set_visible(true);
	} else
	{
		this.Div00.form.btn_reqSms00_00.set_visible(false);
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6244" || this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6267")
	{
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.btn_sinwooriSms.set_visible(true);
	} else
	{
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.btn_sinwooriSms.set_visible(false);
	}
	
	// 디테일 조회
	var sono = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_S11";
	var url = "svcUrl::SO001_S11";
	var inDs = "";
	var outDs = "ds_grd2=ds_grd2 ds_grd3=ds_grd3 ds_grd4=ds_grd4 ds_list_2=ds_list_2 ds_list_3=ds_list_3 ds_memo=ds_memo ds_soAdd=ds_soAdd";
	var args = "SO_NO="+sono+"";
	var callBackid = "fn_afterSearch3";  //경조사유 조회
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_afterSearch3 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	//trace(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"UPDT_DIV"))
	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"UPDT_DIV") == "2")
	{
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(1);
		this.Div02.form.Tab00.Tabpage1.form.btn_add00.set_visible(true);		//추가버튼
		this.Div02.form.Tab00.Tabpage1.form.btn_search01.set_visible(true);		//삭제버튼
	} else if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"UPDT_DIV") == "1")
	{
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);
		this.Div02.form.Tab00.Tabpage1.form.btn_add00.set_visible(false);
		this.Div02.form.Tab00.Tabpage1.form.btn_search01.set_visible(false);
	}
	
	// 발주 확정 시 고객사 에디트박스 비활성화
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
	{
		this.Div00.form.edt_client.set_readonly(true);
	} else
	{
		this.Div00.form.edt_client.set_readonly(false);
	}
	
	//this.Div02.form.Tab00.set_tabindex(0);
	this.Div00.form.edt_STATUS.set_visible(true);
	this.Div00.form.edt_MOVE.set_visible(true);
	
	//탁송여부
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO")
	{
		this.Div00.form.edt_MOVE.set_value("탁송주문");
	} else
	{
		this.Div00.form.edt_MOVE.set_value("정상주문");		
	}
	
	// 주문 상태
	if (this.ds_list.getColumn(this.ds_list.rowposition,"CUR") == "DEL")
	{
		this.Div00.form.edt_STATUS.set_value("삭제주문");
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_enable(true);
		
	} else if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "0")
	{
		this.Div00.form.edt_STATUS.set_value("발주대기");
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_enable(true);
		
	} else if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
	{
		this.Div00.form.edt_STATUS.set_value("발주확정");
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_enable(false);
	}
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO")))
	{
		this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(true);
	} else
	{
		this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(false);
	}
	
	// 결제 시 
	var tabIndex = this.objApp.gds_so_no.getColumn(0,"TAB_INDEX");
	if (tabIndex == "4")
	{
		this.Div02.form.Tab00.set_tabindex(4);
		
		// 결제 대상금액
		this.ds_list_2.filter("DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		// 과세 금액
		this.ds_list_2.filter("VAT_RATE=='10' && DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_01.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		// 비과세 금액
		this.ds_list_2.filter("VAT_RATE=='0' && DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_00_00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		var chk = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE");
	
		if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO")))
		{
			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(true);
		} else
		{
			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(false);
		}
		
		if (!this.gfn_isNull(chk))
		{
			this.fn_chgDiv(chk);
		}		
	}
	
	// 현금영수증 edit 체인지
	this.fn_edtChg();

	// 주문 복사 시
	if (tabIndex == "copy")
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"CFM_FLAG","N")
	
		for (i=0; i<this.ds_list_2.rowcount; i++)
		{
			this.ds_list_2.setColumn(i, "SO_NO", null);
			this.ds_list_2.setColumn(i, "SO_SEQ", null);
			this.ds_list_2.setColumn(i, "SO_NO_ORI", null);
			this.ds_list_2.setColumn(i, "SO_SEQ_ORI", null);
			this.ds_list_2.setColumn(i, "PO_STATUS", "0");
			this.ds_list_2.setColumn(i, "CFM_FLAG", "N");
		}
		
		this.Div02.form.Tab00.Tabpage1.form.Radio00.set_enable(true);
		
		this.Div00.form.edt_MOVE.set_value("");
		this.Div00.form.edt_STATUS.set_value("");
		this.Div00.form.edt_BUGO.set_value("");
		
		this.ds_list.set_updatecontrol(false);
		
		this.ds_list.setRowType(this.ds_list.rowposition,Dataset.ROWTYPE_INSERT);
		
		this.ds_list.set_updatecontrol(true);
		
		var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
		var dte = this.gfn_getDate();		
		var dte2 = this.gfn_getDate("time");
		var date = dte2.substring(0,8);
		var time = dte2.substring(8,10);
		var min = dte2.substring(10,11)+"0";	
		
		if (time == "21")
		{
			time = "00"
			date = String(parseInt(date)+1)
		} else if (time == "22")
		{
			time = "01"
			date = String(parseInt(date)+1)
		} else if (time == "23")
		{
			time = "02"
			date = String(parseInt(date)+1)
		} else
		{
			time = String(parseInt(time)+3)
		}
		
		this.ds_list.setColumn(this.ds_list.rowposition,"SO_NO",null);
		this.ds_list.setColumn(this.ds_list.rowposition, "SO_DT", dte);
		this.ds_list.setColumn(this.ds_list.rowposition, "CONFIRM_DT", null);		
		this.ds_list.setColumn(this.ds_list.rowposition, "INSRT_USER_ID", regUser);
		this.ds_list.setColumn(this.ds_list.rowposition, "SO_DT", dte);
		this.Div00.form.cmb_time.set_value(time);
		this.Div00.form.cmb_min.set_value(min);
		this.Div00.form.cal_dlvyDt.set_value(date);
	}
	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	
	// 소속 조회
	var id = "SO010_S04";
	var url = "svcUrl::SO010_S04";
	var inDs = "";
	var outDs = "ds_sosoc=ds_list";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterSearch4";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

//대상자콤보, 주문자콤보 조회
this.fn_afterSearch4 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
	var id = "SO001_S12";
	var url = "svcUrl::SO001_S12";
	var inDs = "";
	var outDs = "ds_grd3_chg=ds_list2 ds_grd4_chg=ds_list3";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_hsSearch";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 입력
this.fn_add = function ()
{
	this.Div00.form.edt_client.set_readonly(false);
	var saveYn = this.ds_list_2.getColumn(0,"SAVE_YN");
	
	if (saveYn == "1")
	{
		if (!this.confirm("저장 되지 않은 데이터가 있습니다. 그래도 신규 주문 등록하시겠습니까?"))
		{
			return;
		}
	}
	
	if (this.ds_list.getRowType(this.ds_list.rowposition) == 2 || this.ds_list.getRowType(this.ds_list.rowposition) == 4)
	{
		if (!this.confirm("입력중인 데이터가 있습니다. 그래도 신규 주문 등록하시겠습니까?"))
		{
			return;
		}
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	
	if (!this.gfn_isNull(soNo))
	{
		// 기존 열람내역 삭제
		var id = "SO004_M03";
		var url = "svcUrl::SO004_M03";
		var inDs = "";
		var outDs = "";
		var args = "SO_NO="+soNo+" INSRT_USER_ID="+regUser+"";
		var callBackid = "fn_addCallback";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.fn_addCallback();
	}
}

// add callback
this.fn_addCallback = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dte = this.gfn_getDate();
	var dte2 = this.gfn_getDate("time");
	var date = dte2.substring(0,8);
	var time = dte2.substring(8,10);
	var min = dte2.substring(10,11)+"0";	
	
	if (time == "21")
	{
		time = "00"
		date = String(parseInt(date)+1)
	} else if (time == "22")
	{
		time = "01"
		date = String(parseInt(date)+1)
	} else if (time == "23")
	{
		time = "02"
		date = String(parseInt(date)+1)
	} else
	{
		time = String(parseInt(time)+3)
	}
	
	this.ds_list.clearData();
	this.ds_list_2.clearData();
	this.ds_list_3.clearData();
	this.ds_grd1.clearData();
	this.ds_grd2.clearData();
	this.ds_grd3.clearData();
	this.ds_grd4.clearData();
	this.ds_memo.clearData();
	this.ds_soAdd.clearData();
	this.ds_bugochk.clearData();
	this.ds_bugoflag.clearData();
	this.ds_list.addRow();
	//this.ds_list.setColumn(this.ds_list.rowposition, "SO_DT", dte);
	this.ds_list.setColumn(this.ds_list.rowposition, "INSRT_USER_ID", regUser);
	this.ds_list.setColumn(this.ds_list.rowposition, "SO_DT", dte);
	this.Div00.form.Radio_dealType.set_index(0);
	this.Div00.form.Radio_dlvyDtType.set_index(2);
	this.Div00.form.cmb_rcptMeth.set_index(0);
	this.Div00.form.cmb_time.set_value(time);
	this.Div00.form.cmb_min.set_value(min);
	this.Div00.form.cal_dlvyDt.set_value(date);
	this.Div02.form.Tab00.set_tabindex(0);
	this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);
	this.Div00.form.edt_mMemo.set_value(".");
	this.Div00.form.edt_MOVE.set_value("");
	this.Div00.form.edt_BUGO.set_value("");
	this.Div00.form.edt_STATUS.set_value("");
	this.Div02.form.Tab00.Tabpage1.form.Radio00.set_enable(true);
	this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
	this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
	this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
	this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
	this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
	this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	this.Div00.form.edt_MOVE.set_visible(false);
	this.Div00.form.edt_STATUS.set_visible(false);
	this.Div00.form.edt_BUGO.set_visible(false);
	this.Div00.form.Static19.set_cssclass("sta_WF_detailLabel")
	this.Div00.form.Static19_00.set_cssclass("sta_WF_detailLabel")
	this.Div00.form.edt_mRoomNo.set_background("#ffffff")
	this.Div00.form.cal_balinDt.set_background("#ffffff")
	T_SO_NO = null;
}

// 저장
this.fn_save = function ()
{
	this.ds_list_2.filter("")
	
// 	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 	{
// 		this.alert("발주 확정 후 수정 불가능 합니다.");
//  		return;
// 	}

	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE")))
	{
		this.alert("수주형태가 없습니다. 확인하시기 바랍니다.");
 		return;
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO")
	{
		this.alert("탁송주문은 수정할 수 없습니다.")
	}
	
	if (this.ds_bugochk.getColumn(this.ds_bugochk.rowposition,"BUGO_CHK") == "1")
	{
		if (this.ds_list.getColumn(this.ds_list.rowposition,"M_ROOM_NO") == "" || this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"M_ROOM_NO")))
		{	this.alert("부고문자서비스고객사는 호실정보는 필수값 입니다.");
			return;
		}
		
		if (this.ds_list.getColumn(this.ds_list.rowposition,"M_BALIN_DT") == "" || this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"M_BALIN_DT")))
		{	this.alert("부고문자서비스고객사는 발인일자는 필수값 입니다.");
			return;
		}
	}
	
	if (this.ds_list_2.rowcount < 1)
	{
		this.alert("상품정보가 없습니다. 확인하시기 바랍니다.");
 		return;
	}
	
// 	this.ds_list_2.filter("CHK == '1' && INV_CHK=='Y'")
// 	if (this.ds_list_2.rowcount > 0)
// 	{
// 		for (i=0; i < this.ds_list_2.rowcount; i++)
// 		{
// 			if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"TS_BP_CD")))
// 			{
// 				this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 상차지점을 선택하시기 바랍니다.");
// 				this.ds_list_2.filter("")
// 				return false;
// 			}
// 		}
// 	}
// 	this.ds_list_2.filter("")
	
// 	this.ds_list_2.filter("CHK == '1'")
// 	if (this.ds_list_2.rowcount > 0)
// 	{
// 		for (i=0; i < this.ds_list_2.rowcount; i++)
// 		{
// 			if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"ITEM_CD")))
// 			{
// 				this.alert((i+1)+"번째에 품목을 선택하시기 바랍니다.");
// 				this.ds_list_2.filter("")
// 				return false;
// 			}
// 		}
// 	}
// 	this.ds_list_2.filter("")
	
	this.ds_list_2.filter("CHK == '1'")
	if (this.ds_list_2.rowcount == 1)
	{
		if (this.ds_list_2.getColumn(0,"ITEM_CD").substr(0,3) == "A01")
		{
			this.alert("배송품목을 등록 후 저장하세요. 배송금액은 상품팁을 확인하세요")
			this.ds_list_2.filter("")
			return;
		}
	}
	this.ds_list_2.filter("")
	
	for (i=0; i < this.ds_list_2.rowcount; i++)
	{
		if ((this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"PAY_DIV") == "F" && this.gfn_isNull(this.ds_list_2.getColumn(i,"REASON"))) || (this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"PAY_DIV") == "F" && this.gfn_isNull(this.ds_list_2.getColumn(i,"ADD_CD1"))))
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 무상사유 및 무상요청자를 선택하시기 바랍니다.");
			return;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"SO_QTY")))
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 수량을 입력하시기 바랍니다.");
			return;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"ITEM_CD")))
		{
			this.alert("품목을 선택하시기 바랍니다.");
			return;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"PO_BP_CD")))
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 지점을 선택하시기 바랍니다.");
			return;
		}
	}
	
//  	for (var i=0; i<this.ds_list_2.rowcount; i++)
// 	{
// 		var chk = this.ds_list_2.getColumn(i,"CHK");
// 		var bpCd = this.ds_list_2.getColumn(i,"PO_BP_CD");
// 		var bg = this.ds_list_2.getColumn(i,"BRANCH_GROUP");
// 		if (chk == "1")
// 		{			
// 			for (var j=this.ds_list_2.rowcount-1; i<j; j--)
// 			{
// 				var chk2 = this.ds_list_2.getColumn(j,"CHK");
// 				var bpCd2 = this.ds_list_2.getColumn(j,"PO_BP_CD");
// 				var bg2 = this.ds_list_2.getColumn(j,"BRANCH_GROUP");
// 				
// 				if (chk2 == "1")
// 				{
// 					if (bg == bg2 && bpCd != bpCd2)
// 					{
// 						this.alert("지점은 플라워지점, 의전지점 각각 한군데 지점만 등록 가능합니다. 확인 바랍니다.")
// 						return;
// 					}
// 				}				
// 			}
// 		}		
// 	}
	
	// 신규 저장시 디테일 insert 타입으로 변경
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		//상품정보
		var tabIndex = this.objApp.gds_so_no.getColumn(0,"TAB_INDEX");
		if (tabIndex != "copy")
		{
			this.ds_list_2.set_updatecontrol(false);
			
			for(var i=0; i<this.ds_list_2.rowcount;i++)
			{
				if (this.ds_list_2.getColumn(i,"CHK") == 1)
				{
					this.ds_list_2.setRowType(i,Dataset.ROWTYPE_INSERT);
				} else
				{
					this.ds_list_2.setRowType(i,Dataset.ROWTYPE_NORMAL);
				}
			}
			
			this.ds_list_2.set_updatecontrol(true);
		} 
		
		// 소속
		this.ds_grd2.set_updatecontrol(false);
		
		for(var i=0; i<this.ds_grd2.rowcount;i++)
		{
			this.ds_grd2.setRowType(i,Dataset.ROWTYPE_INSERT);
		} 
		
		this.ds_grd2.set_updatecontrol(true);
		
		// 대상자		
		this.ds_grd3.set_updatecontrol(false);
		
		for(var i=0; i<this.ds_grd3.rowcount;i++)
		{
			this.ds_grd3.setRowType(i,Dataset.ROWTYPE_INSERT);
		}
		
		this.ds_grd3.set_updatecontrol(true);
		
		// 주문자
		this.ds_grd4.set_updatecontrol(false);
		
		for(var i=0; i<this.ds_grd4.rowcount;i++)
		{
			this.ds_grd4.setRowType(i,Dataset.ROWTYPE_INSERT);
		}
		
		this.ds_grd4.set_updatecontrol(true);
	} 
	else 
	{
		this.ds_list_2.set_updatecontrol(false);
		
		for(var i=0; i<this.ds_list_2.rowcount;i++)
		{
			if (this.ds_list_2.getColumn(i,"CHK") != 1)
			{
				this.ds_list_2.setRowType(i,Dataset.ROWTYPE_UPDATE);
			} 
		}
		
		this.ds_list_2.set_updatecontrol(true);
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var netAmt = 0;
	var vatAmt = 0;
	
	for (i=0; i < this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"CHK") == 1)
		{
			netAmt = netAmt + parseInt(this.ds_list_2.getColumn(i,"NET_AMT"));
			vatAmt = vatAmt + parseInt(this.ds_list_2.getColumn(i,"VAT_AMT"));
		}
	}
	
	var soldToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY")))
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"SHIP_TO_PARTY", soldToParty);
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"BILL_TO_PARTY")))
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"BILL_TO_PARTY", soldToParty);
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"PAYER")))
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"PAYER", soldToParty);
	}
	
	var id = "SO001_M01_00";
	var url = "svcUrl::SO001_M01_00";
	var inDs = "ds_list=ds_list:U";
	var outDs = "ds_list_out=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" NET_AMT="+netAmt+" VAT_AMT="+vatAmt+"";
	var callBackid = "fn_detailSave";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 저장 callback
this.fn_detailSave = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	if (this.gfn_isNull(soNo))
	{
		soNo = this.ds_list_out.getColumn(this.ds_list_out.rowposition,"SO_NO")
	}
	
	this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD5","V2");
	
	var id = "SO001_M05_00";
	var url = "svcUrl::SO001_M05_00";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_list_3=ds_list_3:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO="+soNo+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterSave";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 배송비 계산
this.fn_afterSave = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M06";
	var url = "svcUrl::SO001_M06";
	var inDs = "";
	var outDs = "";
	var args = "SO_NO="+soNo+"";
	//var callBackid = "";
	var callBackid = "fn_afterSave2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_afterSave2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.fn_afterSearch();
	
	if (this.Div02.form.Tab00.tabindex == 1)
	{
		this.ds_list_2.filter("CHK == '1' && RIBBON_CHK=='Y'")
	} else if (this.Div02.form.Tab00.tabindex == 3)
	{
		this.ds_list_2.filter("CHK == '1' && INV_CHK=='Y'")
	}
	//this.Div02.form.Tab00.set_tabindex(0);
	this.alert("저장 되었습니다.");
}

//삭제
this.fn_delete = function ()
{
// 	if(this.confirm("삭제 하시겠습니까?")){
// 		this.ds_list.deleteRow(this.ds_list.rowposition);
// 	}
// 	
// 	this.fn_save();
// 	
// 	this.ds_grd1.clearData();
// 	this.ds_grd2.clearData();
// 	this.ds_grd3.clearData();
// 	this.ds_grd4.clearData();
}

//주문조회 팝업
this.Div00_btn_sono_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var sPopupId  = "soInfo_popup";
    var sUrl      = "SO::SO001_P00.xfdl";
	var oArg      = {soNo : soNo};
	var sCallBack = "fn_popupCallback_soInfo";
    var oOption   = {title : "주문 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 주문조회 팝업 callback
this.fn_popupCallback_soInfo = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	var soNo = objRtn.soNo;
	
	this.Div02.form.Tab00.set_tabindex(0);
	
	this.Div00.form.edt_STATUS.set_value("");
	this.Div00.form.edt_MOVE.set_value("");
	this.Div00.form.edt_BUGO.set_value("");
	
	this.fn_search(soNo);
}

//Tel Info 팝업

this.Div00_btn_telInfo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list.rowcount == 0)
	{
		this.alert("주문을 조회하거나 입력 버튼을 클릭하세요");
		return;
	}
	
	var clientCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
	var sPopupId  = "telInfo_popup";
    var sUrl      = "SO::SO001_P04.xfdl";
	var oArg      = {clientCd : clientCd};
	var sCallBack = "fn_popupCallback_telInfo";
    var oOption   = {title : "Tel Info"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 고객사 검색 엔터 key
this.Div00_edt_client_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	if (e.keycode == 13)
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{
			this.alert("발주 확정 이후에는 고객사를 변경 할 수 없습니다.");
			return;
		}
		
		if (this.ds_list_2.rowcount > 0)
		{
			if(!this.confirm("발주 대기 상태에서는 저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
			{
				return;
			}
		}	
	
		var Arg_1 = this.Div00.form.edt_client.value;

		var id = "SO010_P01";
		var url = "svcUrl::SO010_P01";
		var inDs = "";
		var outDs = "ds_bpSearch=ds_list";
		var args = "BP_CD="+Arg_1+" BP_NM="+Arg_1+"";
		var callBackid = "fn_afterbpSearchCallback";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	}
};

this.fn_afterbpSearchCallback = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	//trace(this.ds_bpSearch.getColumn(0,"CONT_NO"));
	if (this.ds_bpSearch.rowcount == 1 && !this.gfn_isNull(this.ds_bpSearch.getColumn(0,"CONT_NO")))
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"SOLD_TO_PARTY",this.ds_bpSearch.getColumn(0,"bp_cd"));
		this.ds_list.setColumn(this.ds_list.rowposition,"BILL_TO_PARTY",this.ds_bpSearch.getColumn(0,"BILL_TO_PARTY"));
		this.ds_list.setColumn(this.ds_list.rowposition,"PAYER",this.ds_bpSearch.getColumn(0,"PAYER"));
		this.ds_list.setColumn(this.ds_list.rowposition,"SHIP_TO_PARTY",this.ds_bpSearch.getColumn(0,"SHIP_TO_PARTY"));
		this.ds_list.setColumn(this.ds_list.rowposition,"BP_NM",this.ds_bpSearch.getColumn(0,"BP_NM"));
		this.ds_list.setColumn(this.ds_list.rowposition,"CONT_NO",this.ds_bpSearch.getColumn(0,"CONT_NO"));
		this.ds_list.setColumn(this.ds_list.rowposition,"SO_TYPE",this.ds_bpSearch.getColumn(0,"REFERENCE"));
		this.ds_list.setColumn(this.ds_list.rowposition,"VAT_TYPE",this.ds_bpSearch.getColumn(0,"VAT_TYPE"));
		this.ds_list.setColumn(this.ds_list.rowposition,"VAT_RATE",this.ds_bpSearch.getColumn(0,"VAT_RATE"));
		this.ds_list.setColumn(this.ds_list.rowposition,"SALES_GRP",this.ds_bpSearch.getColumn(0,"SALES_GRP"));
		this.ds_list.setColumn(this.ds_list.rowposition,"SALES_ORG",this.ds_bpSearch.getColumn(0,"SALES_ORG"));
		this.ds_list.setColumn(this.ds_list.rowposition,"SALES_COST_CENTER",this.ds_bpSearch.getColumn(0,"SALES_COST_CENTER"));
		this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_GRP",this.ds_bpSearch.getColumn(0,"TO_BIZ_GRP"));
		this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_ORG",this.ds_bpSearch.getColumn(0,"TO_BIZ_ORG"));
		this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_COST_CENTER",this.ds_bpSearch.getColumn(0,"TO_BIZ_COST_CENTER"));
		this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD","");
		
		if (!this.gfn_isNull(this.ds_bpSearch.getColumn(0,"REFERENCE")))
		{
			this.Div00.form.cmb_soType.set_readonly(true);
		}
		
		if (this.ds_bpSearch.getColumn(0,"bp_cd") == "A6213") //  꽃잠
		{
			this.Div00.form.btn_manual.set_visible(true);
			this.Div00.form.btn_manual.set_text("꽃잠 대응 매뉴얼");
			this.Div00.form.edt_fMemo.set_value("")
		} else if (this.ds_bpSearch.getColumn(0,"bp_cd") == "A6244" || this.ds_bpSearch.getColumn(0,"bp_cd") == "A6267")
		{
			this.Div00.form.btn_manual.set_visible(true);
			this.Div00.form.btn_manual.set_text("신우리 추천상품");
			this.Div00.form.edt_fMemo.set_value("")
		} else if (this.ds_bpSearch.getColumn(0,"bp_cd") == "A6548" || this.ds_bpSearch.getColumn(0,"bp_cd") == "A6614")
		{
		this.Div00.form.edt_fMemo.set_value("■ 배송 인수증 전산등록 필수 고객사")
		this.Div00.form.btn_manual.set_visible(false);
		} else
		{
			this.Div00.form.edt_fMemo.set_value("")
			this.Div00.form.btn_manual.set_visible(false);
		}
		
		
		//대상자 팝업버튼 체크
		if (this.ds_bpSearch.getColumn(0,"USR_FLAG") > 0)
		{
			this.Div00.form.btn_usr1.set_visible(true);
			this.Div00.form.edt_usr1.set_enable(true);
		} else
		{
			this.Div00.form.btn_usr1.set_visible(false);
			this.Div00.form.edt_usr1.set_enable(true);
		}
		
		//주문자 팝업버튼 체크
		if (this.ds_bpSearch.getColumn(0,"USR_FLAG2") > 0)
		{
			this.Div00.form.btn_usr2.set_visible(true);
			this.Div00.form.edt_usr2.set_enable(true);
		} else 
		{
			this.Div00.form.btn_usr2.set_visible(false);
			this.Div00.form.edt_usr2.set_enable(true);
		}
		
		// 기존데이터 삭제	
		if (this.ds_grd2.rowcount > 0 || this.ds_grd3.rowcount > 0 || this.ds_grd4.rowcount > 0)
		{
			this.ds_grd2.deleteAll();
			this.ds_grd3.deleteAll();
			this.ds_grd4.deleteAll();
			
			var id = "SO001_D01";
			var url = "svcUrl::SO001_D01";
			var inDs = "ds_list_2=ds_list_2:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U";
			var outDs = "";
			var args = "";
			var callBackid = "fn_afterBpCallback";
				
			this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
		} else
		{
			this.fn_afterBpCallback();
		}
	} else
	{
		var Arg_1 = this.Div00.form.edt_client.value;
		
		var sPopupId  = "client_popup";
		var sUrl      = "SO::SO010_P01.xfdl";
		var oArg      = {MODE : Arg_1};
		var sCallBack = "fn_popupCallback_client";
		var oOption   = {title : "고객사 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
}

// 고객사 팝업
this.Div00_btn_client_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list.rowcount < 1)
	{
		this.alert("주문을 조회하거나 입력 버튼을 클릭하세요");
		return;
	}
	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
	{
		this.alert("발주 확정 이후에는 고객사를 변경 할 수 없습니다.");
		return;
	}
	
	if (this.ds_list_2.rowcount > 0)
	{
		if(!this.confirm("발주 대기 상태에서는 저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
		{
			return;
		}
	}	
	
	var Arg_1 = this.gfn_nvl(this.Div00.form.edt_client.value,"");

	var sPopupId  = "client_popup";
	var sUrl      = "SO::SO010_P01.xfdl";
	var oArg      = {MODE : Arg_1};
	var sCallBack = "fn_popupCallback_client";
	var oOption   = {title : "고객사 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 고객사 팝업 callback
this.fn_popupCallback_client = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	this.ds_list.setColumn(this.ds_list.rowposition,"SOLD_TO_PARTY",objRtn.bp_cd);
	this.ds_list.setColumn(this.ds_list.rowposition,"BILL_TO_PARTY",objRtn.BILL_TO_PARTY);
	this.ds_list.setColumn(this.ds_list.rowposition,"PAYER",objRtn.PAYER);
	this.ds_list.setColumn(this.ds_list.rowposition,"SHIP_TO_PARTY",objRtn.SHIP_TO_PARTY);
	this.ds_list.setColumn(this.ds_list.rowposition,"BP_NM",objRtn.BP_NM);
	this.ds_list.setColumn(this.ds_list.rowposition,"CONT_NO",objRtn.CONT_NO);
	this.ds_list.setColumn(this.ds_list.rowposition,"SO_TYPE",objRtn.REFERENCE);
	this.ds_list.setColumn(this.ds_list.rowposition,"VAT_TYPE",objRtn.VAT_TYPE);
	this.ds_list.setColumn(this.ds_list.rowposition,"VAT_RATE",objRtn.VAT_RATE);
	this.ds_list.setColumn(this.ds_list.rowposition,"SALES_GRP",objRtn.SALES_GRP);
	this.ds_list.setColumn(this.ds_list.rowposition,"SALES_ORG",objRtn.SALES_ORG);
	this.ds_list.setColumn(this.ds_list.rowposition,"SALES_COST_CENTER",objRtn.SALES_COST_CENTER);
	this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_GRP",objRtn.TO_BIZ_GRP);
	this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_ORG",objRtn.TO_BIZ_ORG);
	this.ds_list.setColumn(this.ds_list.rowposition,"TO_BIZ_COST_CENTER",objRtn.TO_BIZ_COST_CENTER);
	this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD","");
	
	if (objRtn.bp_cd == "A6213") //  꽃잠
	{
		this.Div00.form.btn_manual.set_visible(true);
		this.Div00.form.btn_manual.set_text("꽃잠 대응 매뉴얼");
		this.Div00.form.edt_fMemo.set_value("")
	} else if (objRtn.bp_cd == "A6244" || objRtn.bp_cd == "A6267")
	{
		this.Div00.form.btn_manual.set_visible(true);
		this.Div00.form.btn_manual.set_text("신우리 추천상품");
		this.Div00.form.edt_fMemo.set_value("")
	} else if (objRtn.bp_cd == "A6548" || objRtn.bp_cd == "A6614" || objRtn.bp_cd == "A3112")
	{
		this.Div00.form.edt_fMemo.set_value("■ 배송 인수증 전산등록 필수 고객사")
		this.Div00.form.btn_manual.set_visible(false);
	} else
	{
		this.Div00.form.edt_fMemo.set_value("")
		this.Div00.form.btn_manual.set_visible(false);
	}
	
	if (!this.gfn_isNull(objRtn.REFERENCE))
	{
		this.Div00.form.cmb_soType.set_readonly(true);
	}
	
	//대상자 팝업버튼 체크
	if (objRtn.USR_FLAG > 0)
	{
		this.Div00.form.btn_usr1.set_visible(true);
		this.Div00.form.edt_usr1.set_enable(true);
	} else
	{
		this.Div00.form.btn_usr1.set_visible(false);
		this.Div00.form.edt_usr1.set_enable(true);
	}
	
	//주문자 팝업버튼 체크
	if (objRtn.USR_FLAG2 > 0)
	{
		this.Div00.form.btn_usr2.set_visible(true);
		this.Div00.form.edt_usr2.set_enable(true);
	} else 
	{
		this.Div00.form.btn_usr2.set_visible(false);
		this.Div00.form.edt_usr2.set_enable(true);
	}
	
	//PKG 팝업 버튼 체크
	if (objRtn.BP_FLAG > 0)
	{
		this.Div00.form.btn_pkg_sms.set_visible(true);
	} else 
	{
		this.Div00.form.btn_pkg_sms.set_visible(false);
	}
	
	// 기존데이터 삭제	
	if (this.ds_grd2.rowcount > 0 || this.ds_grd3.rowcount > 0 || this.ds_grd4.rowcount > 0)
	{
		this.ds_grd2.deleteAll();
		this.ds_grd3.deleteAll();
		this.ds_grd4.deleteAll();
		
		var id = "SO001_D01";
		var url = "svcUrl::SO001_D01";
		var inDs = "ds_list_2=ds_list_2:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U";
		var outDs = "";
		var args = "";
		var callBackid = "fn_afterBpCallback";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.fn_afterBpCallback();
	}
}

//소속조회
this.fn_afterBpCallback = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO")
	
	// 소속 조회
	var id = "SO010_S04";
	var url = "svcUrl::SO010_S04";
	var inDs = "";
	var outDs = "ds_sosoc=ds_list";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterCallback";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

//주문팁
this.fn_afterCallback = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	

	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	var contNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO")
	
	var id = "SO001_S01";
	var url = "svcUrl::SO001_S01";
	var inDs = "";
	var outDs = "ds_grd1=ds_list ds_item_tip=ds_list_2 ds_item_tip2=ds_list_3";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterCallback2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
// 	var url = "svcUrl::SO001_S01";
// 	this.gfn_transaction( "SO001_S01",url,"","ds_grd1=ds_list","BP_CD="+bpCd+"","callbackFunction");
};

//고객사 계약 별 소속 리스트 조회 (콤보)
this.fn_afterCallback2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var tip1 = this.ds_item_tip.getColumn(this.ds_item_tip.rowposition,"TIP_DESC");
	var tip2 = this.ds_item_tip2.getColumn(this.ds_item_tip2.rowposition,"TIP_DESC");
	tip1 = this.gfn_nvl(tip1,"1");
	tip2 = this.gfn_nvl(tip2,"1");
	if (tip1.indexOf("편의") != '-1' || tip2.indexOf("편의") != '-1')
	{
		this.Div00.form.btn_reqSms00_00.set_visible(true);
	} else
	{
		this.Div00.form.btn_reqSms00_00.set_visible(false);
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6244" || this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6267")
	{
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.btn_sinwooriSms.set_visible(true);
	} else
	{
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.btn_sinwooriSms.set_visible(false);
	}
	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	var contNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO")
	
	var id = "SO010_S03";
	var url = "svcUrl::SO010_S03";
	var inDs = "";
	var outDs = "ds_grd2=ds_list";
	var args = "BP_CD="+bpCd+" CONT_NO="+contNo+"";
	var callBackid = "fn_afterCallback3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

//대상자, 주문자, 대상자콤보, 주문자콤보 조회
this.fn_afterCallback3 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_grd2.rowcount == 0)
	{
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(0,"SUB_TYPE","0")
		this.ds_grd2.setColumn(0,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(0,"SUB_CODE","")
		
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(1,"SUB_TYPE","0")
		this.ds_grd2.setColumn(1,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(1,"SUB_CODE","")
		
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(2,"SUB_TYPE","0")
		this.ds_grd2.setColumn(2,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(2,"SUB_CODE","")
	} else if (this.ds_grd2.rowcount == 1)
	{
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(1,"SUB_TYPE","0")
		this.ds_grd2.setColumn(1,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(1,"SUB_CODE","")
		
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(2,"SUB_TYPE","0")
		this.ds_grd2.setColumn(2,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(2,"SUB_CODE","")
	}  else if (this.ds_grd2.rowcount == 2)
	{
		this.ds_grd2.addRow();
		this.ds_grd2.setColumn(2,"SUB_TYPE","0")
		this.ds_grd2.setColumn(2,"SUB_TYPE_NM","*")
		this.ds_grd2.setColumn(2,"SUB_CODE","")
	}
	
	this.ds_grd2.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_grd2.rowcount;i++)
	{
		this.ds_grd2.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd2.set_updatecontrol(true);
	
	//trace(this.ds_grd2.getRowType(0));
	
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
	var id = "SO001_S08";
	var url = "svcUrl::SO001_S08";
	var inDs = "";
	var outDs = "ds_grd3=ds_list ds_grd4=ds_list1 ds_grd3_chg=ds_list2 ds_grd4_chg=ds_list3";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterCallback4";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 경조사유 조회
this.fn_afterCallback4 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.ds_grd3.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_grd3.rowcount;i++)
	{
		this.ds_grd3.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd3.set_updatecontrol(true);
	
	this.ds_grd4.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_grd4.rowcount;i++)
	{
		this.ds_grd4.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd4.set_updatecontrol(true);
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_grd2.getColumn(0,"SUB_CODE");
	var args3 = this.ds_grd2.getColumn(1,"SUB_CODE");
	var args4 = this.ds_grd2.getColumn(2,"SUB_CODE");
	var args5 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	
	var id = "SO010_P02_S";
	var url = "svcUrl::SO010_P02_S";
	var inDs = "";
	var outDs = "ds_hs=ds_list";
	var args = "CONT_NO="+args1+" SUB_CODE1="+args2+" SUB_CODE2="+args3+" SUB_CODE3="+args4+" DEAL_TYPE="+args5+"";
	var callBackid = "fn_afterCallback5";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 고객사 특이사항 조회
this.fn_afterCallback5 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	var id = "SO001_P21";
	var url = "svcUrl::SO001_P21";
	var inDs = "";
	var outDs = "ds_bpEtc=ds_list";
	var args = "BP_CD="+args1+"";
	var callBackid = "fn_afterCallback6";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 상품조회
this.fn_afterCallback6 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
	{
		this.fn_itemDelete3();
	}
}

this.fn_itemDelete3 = function ()
{
	
	if (this.ds_list_2.rowcount > 0)
	{
		this.ds_list_2.deleteAll();
		
		var id = "SO001_D01";
		var url = "svcUrl::SO001_D01";
		var inDs = "ds_list_2=ds_list_2:U";
		var outDs = "";
		var args = "";
		var callBackid = "fn_itemSearch3";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.fn_itemSearch3();
	}
};

this.fn_itemSearch3 = function ()
{
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args3 = this.gfn_nvl(this.ds_grd2.getColumn(0,"SUB_CODE"),"*");
	var args4 = this.gfn_nvl(this.ds_grd2.getColumn(1,"SUB_CODE"),"*");
	var args5 = this.gfn_nvl(this.ds_grd2.getColumn(2,"SUB_CODE"),"*");
	var args6 = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var args7 = "";
	var args8 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var args9 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	var args10 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD4");

	if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
	{
		args7 = "Y";
	} else
	{
		args7 = "";
	}
	this.ds_list_2.clearData();
	
	// 상품 조회
	var id = "SO010_S10";
	var url = "svcUrl::SO010_S10";
	var inDs = "";
	var outDs = "ds_list_2=ds_list";
	var args = "CONT_NO="+args1+" BP_CD="+args2+" SUB_CODE1="+args3+" SUB_CODE2="+args4+" SUB_CODE3="+args5+" HS_CODE="+args6+" DLVY_CD="+args8+" MANDATORY_YN="+args7+" DEAL_TYPE="+args9+" CASE_NO="+args10+"";
	var callBackid = "fn_itemSearchCallback3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
};

// 상품조회 콜백
this.fn_itemSearchCallback3 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.ds_list_2.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_list_2.rowcount;i++)
	{
		this.ds_list_2.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_list_2.set_updatecontrol(true);
	
	this.fn_afterCallback7();
	//this.fn_popupCallback_itemChange();
}

// 고객사 특이사항 조회 콜백
this.fn_afterCallback7 = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}

	if (this.ds_bpEtc.rowcount > 0)
	{
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
		var sPopupId  = "bppopup";
		var sUrl      = "SO::SO001_P22.xfdl";
		var oArg      = {bpCd : bpCd};
		var sCallBack = "";
		var oOption   = {title : "고객사 특이사항"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
};

// 콤보 체인지에 따른 경조사유 조회
this.ds_grd2_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	//this.fn_hsSearch();
	
	if (e.columnid == "SUB_CODE")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
		{
			if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
			{
				if (!this.gfn_isNull(this.ds_soAdd.getColumn(0,"ADD_CD4")) || !this.gfn_isNull(this.ds_list.getColumn(0,"HS_CD")))
				{
					this.ds_soAdd.setColumn(0,"ADD_CD4","");
					this.ds_list.setColumn(0,"HS_CD","");
					this.alert("주문정보의 경조사유 및 상품정보 탭의 유형을 다시 선택하시기 바랍니다.")
				}
				this.fn_itemDelete();
			} else
			{
				if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
				{
					if (!this.gfn_isNull(this.ds_soAdd.getColumn(0,"ADD_CD4")) || !this.gfn_isNull(this.ds_list.getColumn(0,"HS_CD")))
					{
						this.ds_soAdd.setColumn(0,"ADD_CD4","");
						this.ds_list.setColumn(0,"HS_CD","");
						this.alert("주문정보의 경조사유 및 상품정보 탭의 유형을 다시 선택하시기 바랍니다.")
					}
					this.fn_itemDelete();
				}		
			}
		}
	}
};

// 경조사유 조회
this.fn_hsSearch = function ()
{
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_grd2.getColumn(0,"SUB_CODE");
	var args3 = this.ds_grd2.getColumn(1,"SUB_CODE");
	var args4 = this.ds_grd2.getColumn(2,"SUB_CODE");
	var args5 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	
	var id = "SO010_P02_S";
	var url = "svcUrl::SO010_P02_S";
	var inDs = "";
	var outDs = "ds_hs=ds_list";
	var args = "CONT_NO="+args1+" SUB_CODE1="+args2+" SUB_CODE2="+args3+" SUB_CODE3="+args4+" DEAL_TYPE="+args5+"";
	var callBackid = "fn_trace";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

// 경조사유 조회 콜백
this.fn_trace = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_soAdd.rowcount == 0)
	{
		this.ds_soAdd.addRow();
	}
	
	if (this.objApp.gds_so_no.getColumn(0,"TAB_INDEX") == "copy")
	{
		this.fn_save();
	}	
	
	this.fn_caseSearch();
	
	this.objApp.gds_so_no.setColumn(0,"TAB_INDEX","");
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO" && this.ds_list_2.getColumn(0,"PO_STATUS") == "0")
	{
		var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
		var sPopupId  = "confirm_popup";
		var sUrl      = "SO::SO001_P13.xfdl";
		var oArg      = {soNo : soNo};
		var sCallBack = "fn_popupCallback_confirm";
		var oOption   = {title : "주문 확정"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}	
};

// 유형콤보 클릭시 이벤트
this.Div02_Tab00_Tabpage1_cmb_case_onsetfocus = function(obj:nexacro.Combo,e:nexacro.SetFocusEventInfo)
{
	this.fn_caseSearch();
};

// 유형조회
this.fn_caseSearch = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}

	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_grd2.getColumn(0,"SUB_CODE");
	var args3 = this.ds_grd2.getColumn(1,"SUB_CODE");
	var args4 = this.ds_grd2.getColumn(2,"SUB_CODE");
	var args5 = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var args6 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	var id = "SO010_S05";
	var url = "svcUrl::SO010_S05";
	var inDs = "";
	var outDs = "ds_case=ds_list";
	var args = "CONT_NO="+args1+" BP_CD="+args6+" SUB_CODE1="+args2+" SUB_CODE2="+args3+" SUB_CODE3="+args4+" HS_CODE="+args5+"";
	var callBackid = "fn_trace2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_trace2 = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
}

// 부고문자서비스체크
this.fn_bugochk = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}

	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args3 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	
	var id = "SO010_S08";
	var url = "svcUrl::SO010_S08";
	var inDs = "";
	var outDs = "ds_bugochk=ds_list";
	var args = "HS_CD="+args1+" BP_CD="+args2+" DEAL_TYPE="+args3+"";
	var callBackid = "fn_trace3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_trace3 = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	var args1 = this.ds_bugochk.getColumn(this.ds_bugochk.rowposition,"BUGO_CHK");
	if (args1 == "1")
	{
		//var balinDate = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"M_BALIN_DT"),"");
		//if  (balinDate == "") 
		//{
		//	balinDate = this.gfn_addDate(this.gfn_getDate(),3);
		//	this.Div00.form.cal_balinDt.set_value(balinDate)
		//}
		this.Div00.form.edt_BUGO.set_visible(true);
		this.Div00.form.edt_BUGO.set_value("부고문자서비스고객사");
		this.Div00.form.Static19.set_cssclass("sta_WF_detailLabel_ess")
		this.Div00.form.Static19_00.set_cssclass("sta_WF_detailLabel_ess")
		this.Div00.form.edt_mRoomNo.set_background("#fafdc8")
		this.Div00.form.cal_balinDt.set_background("#fafdc8")
		
	}
	else
	{
		this.Div00.form.edt_BUGO.set_visible(false);
		this.Div00.form.edt_BUGO.set_value("");
		this.Div00.form.Static19.set_cssclass("sta_WF_detailLabel")
		this.Div00.form.Static19_00.set_cssclass("sta_WF_detailLabel")
		this.Div00.form.edt_mRoomNo.set_background("#ffffff")
		this.Div00.form.cal_balinDt.set_background("#ffffff")
	}
}

// 소속 조회된 값에 따른 콤보 세팅
this.Div00_grd_list01_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 2)
	{
		var subType = this.ds_grd2.getColumn(this.ds_grd2.rowposition,"SUB_TYPE");

		this.ds_sosoc.filter("SUB_TYPE=='"+subType+"'");
	}
};

this.Div00_grd_list01_oncellposchanged = function(obj:nexacro.Grid,e:nexacro.GridSelectEventInfo)
{
	if (e.col == 2)
	{
		var subType = this.ds_grd2.getColumn(this.ds_grd2.rowposition,"SUB_TYPE");

		this.ds_sosoc.filter("SUB_TYPE=='"+subType+"'");
	}
};

// 대상자 인적사항 조회된 값에 따른 콤보 세팅
this.Div00_grd_list02_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 2)
	{
		var seq = this.ds_grd3.getColumn(this.ds_grd3.rowposition,"SEQ_NO");

		this.ds_grd3_chg.filter("SEQ_NO=='"+seq+"'");
	}
};

this.Div00_grd_list02_oncellposchanged = function(obj:nexacro.Grid,e:nexacro.GridSelectEventInfo)
{
	if (e.col == 2)
	{
		var seq = this.ds_grd3.getColumn(this.ds_grd3.rowposition,"SEQ_NO");

		this.ds_grd3_chg.filter("SEQ_NO=='"+seq+"'");
	}
};

// 주문자 인적사항 조회된 값에 따른 콤보 세팅
this.Div00_grd_list03_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 2)
	{
		var seq = this.ds_grd4.getColumn(this.ds_grd4.rowposition,"SEQ_NO");

		this.ds_grd4_chg.filter("SEQ_NO=='"+seq+"'");
	}
};

this.Div00_grd_list03_oncellposchanged = function(obj:nexacro.Grid,e:nexacro.GridSelectEventInfo)
{
	if (e.col == 2)
	{
		var seq = this.ds_grd4.getColumn(this.ds_grd4.rowposition,"SEQ_NO");

		this.ds_grd4_chg.filter("SEQ_NO=='"+seq+"'");
	}
};

// 성명(대상자) 팝업
this.Div00_btn_usr1_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var clientCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
	var sPopupId  = "usr1_popup";
    var sUrl      = "SO::SO001_P05.xfdl";
	var oArg      = {clientCd : clientCd, gbn : "0001"};
	var sCallBack = "fn_popupCallback_usr1";
    var oOption   = {title : "대상자 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 대상자 팝업 callback
this.fn_popupCallback_usr1 = function(sPopId, sRtn)
{
// 	var objRtn = JSON.parse(sRtn);
// 	
// 	
//     this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",objRtn.성명)
// 	
// 	for (i=0; i<this.ds_grd3.rowcount; i++)
// 	{
// 		var colNm = new Object();
// 		colNm[i] = this.ds_grd3.getColumn(i,"COL_NM");
// 		this.ds_grd3.setColumn(i,"COL_VAL",this.gfn_isNullRtn(objRtn.colNm))
// 	}
	
	if (sRtn != "||")
	{
		var objRtn = sRtn.split("||");
		
		this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",objRtn[0])
		
		//trace(objRtn.length);
		for (i=0; i<objRtn.length-1; i++)
		{
			this.ds_grd3.setColumn(i,"COL_VAL",this.gfn_isNullRtn(objRtn[i+1]))
		}		
	}
}

// 성명(주문자) 팝업
this.Div00_btn_usr2_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var clientCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY")
	
	var sPopupId  = "usr1_popup";
    var sUrl      = "SO::SO001_P05.xfdl";
	var oArg      = {clientCd : clientCd, gbn : "0002"};
	var sCallBack = "fn_popupCallback_usr2";
    var oOption   = {title : "주문자 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 주문자 팝업 callback
this.fn_popupCallback_usr2 = function(sPopId, sRtn)
{	
	if (sRtn != "||")
	{
		var objRtn = sRtn.split("||");
		
		this.ds_list.setColumn(this.ds_list.rowposition,"REQ_NM",objRtn[0])
		
		//trace(objRtn.length);
		for (i=0; i<objRtn.length-1; i++)
		{
			this.ds_grd4.setColumn(i,"COL_VAL",this.gfn_isNullRtn(objRtn[i+1]))
		}		
	}
}

// 배송지 엔터 KEY
this.Div00_edt_dlvyNm_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	if (e.keycode == 13)
	{
		if (this.ds_list_2.rowcount > 0)
		{
			if(!this.confirm("발주 대기 상태에서는 저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
			{
				return;
			}
		}	
		
		var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
		var row = this.ds_hs.findRow("HS_CODE",hsCd);
		var hsGu = this.gfn_nvl(this.ds_hs.getColumn(row,"HS_GU"),"");
		
		switch(hsGu){
			case "S": hsGu="A";break;
			case "H": hsGu="B";break;
			case "Z": hsGu="Z";break;
		}
		
		var Arg_1 = hsGu;		
		var Arg_2 = "";
		var Arg_3 = this.Div00.form.edt_dlvyNm.value;
		var Arg_4 = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");

		var id = "SO001_P03";
		var url = "svcUrl::SO001_P03";
		var inDs = "";
		var outDs = "ds_dlvySearch=ds_list ds_status_chk=ds_list_2";
		var args = "SO_NO="+Arg_4+" DLVY_TYPE="+Arg_1+" CON_TYPE="+Arg_2+" CON_VALUE="+Arg_3+"";
		var callBackid = "fn_afterdlvySearchCallback";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	}
};

this.fn_afterdlvySearchCallback = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (!this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")) && this.ds_list_2.rowcount > 0)
	{
		if (this.ds_status_chk.rowcount > 0)
		{
			this.alert("이미 출고 되어 배송지 수정이 불가능 합니다.");
			return;
		}
	}
	
	if (this.ds_dlvySearch.rowcount == 1)
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",this.ds_dlvySearch.getColumn(0,"DLVY_CD"));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",this.ds_dlvySearch.getColumn(0,"DLVY_CD")+" : "+this.ds_dlvySearch.getColumn(0,"DLVY_NM"));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",this.ds_dlvySearch.getColumn(0,"DLVY_ADDR")+"  TEL : "+this.ds_dlvySearch.getColumn(0,"TEL_NO1"));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM_ERP",this.ds_dlvySearch.getColumn(0,"DLVY_NM"));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP",this.ds_dlvySearch.getColumn(0,"DLVY_ADDR"));
		this.ds_list.setColumn(this.ds_list.rowposition,"YES_ITEM",this.gfn_nvl(this.ds_dlvySearch.getColumn(0,"YES_ITEM"),""));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",this.ds_dlvySearch.getColumn(0,"DLVY_CHANGE_DT").substring(0,8));
		
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
		{
			if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
			{
				this.fn_itemDelete2();
			} else
			{
				if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
				{
					this.fn_itemDelete2();
				}
			}
		}
	} else
	{
		var code = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
	
	
		var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
		var row = this.ds_hs.findRow("HS_CODE",hsCd);
		var hsGu = this.ds_hs.getColumn(row,"HS_GU");
		
		//trace(hsGu);
		var sPopupId  = "dlvy_popup";
		var sUrl      = "SO::SO001_P03.xfdl";
		var oArg      = {code : code, hsGu : hsGu};
		var sCallBack = "fn_popupCallback_dlvy";
		var oOption   = {title : "배송지 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);		
	}
}

// 배송지 팝업
this.Div00_btn_dlvy_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_2.rowcount > 0)
	{
		var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
		var id = "SO001_P23";
		var url = "svcUrl::SO001_P23";
		var inDs = "";
		var outDs = "ds_status_chk=ds_list_2";
		var args = "SO_NO="+soNo+"";
		var callBackid = "fn_afterstatuschk";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
		var row = this.ds_hs.findRow("HS_CODE",hsCd);
		var hsGu = this.ds_hs.getColumn(row,"HS_GU");
		var code = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");

		var sPopupId  = "dlvy_popup";
		var sUrl      = "SO::SO001_P03.xfdl";
		var oArg      = {code : code, hsGu : hsGu};
		var sCallBack = "fn_popupCallback_dlvy";
		var oOption   = {title : "배송지 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}	
};

this.fn_afterstatuschk = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (!this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")) && this.ds_list_2.rowcount > 0)
	{
		if (this.ds_status_chk.rowcount > 0)
		{
			this.alert("이미 출고 되어 배송지 수정이 불가능 합니다.");
			return;
		}
	}	
	
	var code = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
	
	
	var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var row = this.ds_hs.findRow("HS_CODE",hsCd);
	var hsGu = this.ds_hs.getColumn(row,"HS_GU");
	

	var sPopupId  = "dlvy_popup";
    var sUrl      = "SO::SO001_P03.xfdl";
	var oArg      = {code : code, hsGu : hsGu};
	var sCallBack = "fn_popupCallback_dlvy";
    var oOption   = {title : "배송지 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
}

// 배송지 팝업 callback
this.fn_popupCallback_dlvy = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",objRtn.DLVY_CD);
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",objRtn.DLVY_CD+" : "+objRtn.DLVY_NM);
	if (this.gfn_isNull(objRtn.TEL_NO1))
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",objRtn.DLVY_ADDR);
	} else
	{
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",objRtn.DLVY_ADDR+"  TEL : "+objRtn.TEL_NO1);
	}	
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM_ERP",objRtn.DLVY_NM);
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP",objRtn.DLVY_ADDR);
	this.ds_list.setColumn(this.ds_list.rowposition,"YES_ITEM",this.gfn_nvl(objRtn.YES_ITEM,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",objRtn.DLVY_CHANGE_DT.substring(0,8));
	
	// 표준 / 예외 표준으로 두기
	this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);
	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
	{
		if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
		{
			this.fn_itemDelete2();
		} else
		{
			if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
			{
				this.fn_itemDelete2();
			}
		}
	}
}

this.fn_itemDelete2 = function ()
{
	
	if (this.ds_list_2.rowcount > 0)
	{
		this.ds_list_2.deleteAll();
		
		var id = "SO001_D01";
		var url = "svcUrl::SO001_D01";
		var inDs = "ds_list_2=ds_list_2:U";
		var outDs = "";
		var args = "";
		var callBackid = "fn_itemSearch2";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.fn_itemSearch2();
	}
};

this.fn_itemSearch2 = function ()
{
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args3 = this.gfn_nvl(this.ds_grd2.getColumn(0,"SUB_CODE"),"*");
	var args4 = this.gfn_nvl(this.ds_grd2.getColumn(1,"SUB_CODE"),"*");
	var args5 = this.gfn_nvl(this.ds_grd2.getColumn(2,"SUB_CODE"),"*");
	var args6 = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var args7 = "";
	var args8 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var args9 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	var args10 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD4");

	if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
	{
		args7 = "Y";
	} else
	{
		args7 = "";
	}
	this.ds_list_2.clearData();
	
	// 상품 조회
	var id = "SO010_S10";
	var url = "svcUrl::SO010_S10";
	var inDs = "";
	var outDs = "ds_list_2=ds_list";
	var args = "CONT_NO="+args1+" BP_CD="+args2+" SUB_CODE1="+args3+" SUB_CODE2="+args4+" SUB_CODE3="+args5+" HS_CODE="+args6+" DLVY_CD="+args8+" MANDATORY_YN="+args7+" DEAL_TYPE="+args9+" CASE_NO="+args10+"";
	var callBackid = "fn_itemSearchCallback2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
};

// 상품조회 콜백
this.fn_itemSearchCallback2 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.ds_list_2.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_list_2.rowcount;i++)
	{
		this.ds_list_2.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_list_2.set_updatecontrol(true);
	
	this.fn_popupCallback_setDealType();
	//this.fn_popupCallback_itemChange();
}

// 상품 조회 후 구분 세팅
this.fn_popupCallback_setDealType = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
// 	if (this.ds_list_2.rowcount == 0)
// 	{
// 		this.alert("표준 품목이 없습니다. 예외품목에서 선택하세요");
// 	}
	
	this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);

	for (var i=0; i<this.ds_list_2.rowcount; i++)
	{
		this.ds_list_2.setColumn(i, "UPDT_DIV", "1");
	}
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	// 예외 거래처 확인
	var id = "SO001_P22";
	var url = "svcUrl::SO001_P22";
	var inDs = "";
	var outDs = "ds_exception=ds_list";
	var args = "BP_CD="+args1+"";
	var callBackid = "fn_afterExceptionChk";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 중복체크 콜백
this.fn_afterExceptionChk = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
		if (this.ds_exception.rowcount > 0)
	{
		this.alert("주문팁 확인 고객사입니다. 상품선택시 주문팁을 확인바랍니다.")
	}

	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var args3 = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var args4 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	
	// 중복 확인
	var id = "SO001_P07_S";
	var url = "svcUrl::SO001_P07";
	var inDs = "";
	var outDs = "ds_orderChk=ds_list";
	var args = "SOLD_TO_PARTY="+args1+" DLVY_CD="+args2+" SO_NO="+args3+" DLVY_DT2="+args4+"";
	var callBackid = "fn_afterOrderChk";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 중복체크 콜백
this.fn_afterOrderChk = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_orderChk.rowcount > 0)
	{
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		var bpNm = this.ds_list.getColumn(this.ds_list.rowposition,"BP_NM");
		var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
		var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
		var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
		var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
			
		var sPopupId  = "orderChk_popup";
		var sUrl      = "SO::SO001_P19.xfdl";
		var oArg      = {bpCd : bpCd, bpNm : bpNm, dlvyCd : dlvyCd, dlvyNm : dlvyNm, soNo : soNo, dlvyDt : dlvyDt};
		var sCallBack = "fn_orderChk";
		var oOption   = {title : "중복 확인"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
}

// 중복확인 callback
this.fn_orderChk = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	if (new String(sRtn).valueOf() == "undefined" )
	{
	}
	if (sRtn == null)
	{
	}
	if (("x" + sRtn == "xNaN") && (new String(sRtn).valueOf() == "undefined" ))
	{
	}
	if (sRtn.length == 0)
	{
	}
	else
	{
		var arrArg = [];
		this.gfn_openForm2(this.objApp.gds_menu, "SO100", arrArg, sRtn);	
	}
}

// 중복확인 버튼
this.Div00_btn_chk_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var bpNm = this.ds_list.getColumn(this.ds_list.rowposition,"BP_NM");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
			
	var sPopupId  = "orderChk_popup";
	var sUrl      = "SO::SO001_P19.xfdl";
	var oArg      = {bpCd : bpCd, bpNm : bpNm, dlvyCd : dlvyCd, dlvyNm : dlvyNm, soNo : soNo, dlvyDt : dlvyDt};
	var sCallBack = "fn_orderChk";
	var oOption   = {title : "중복 확인"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 상품정보 표준, 예외
this.Div02_Tab00_Tabpage1_Radio00_canitemchange = function(obj:nexacro.Radio,e:nexacro.ItemChangeEventInfo)
{	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
	{
		if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
		{
			this.fn_itemDelete();
		} else
		{
			if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
			{
				var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");

				var id = "SO001_S16";
				var url = "svcUrl::SO001_S16";
				var inDs = "";
				var outDs = "ds_dnChk=ds_dnChk";
				var args = "SO_NO="+soNo+"";
				var callBackid = "fn_dnChk";
					
				this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
			} else
			{
				this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(e.preindex);
			}
		}
	}
//	}	
};

this.fn_dnChk = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_dnChk.getColumn(0,"DN_CNT") == 0)
	{
		this.fn_itemDelete();
	} else
	{
		this.alert("출고 취소중입니다. 잠시후 다시 시도하시기 바랍니다.(최대3분)");
		return;
	}
}

this.fn_itemDelete = function ()
{
	
	if (this.ds_list_2.rowcount > 0)
	{
		this.ds_list_2.deleteAll();
		
		var id = "SO001_D01";
		var url = "svcUrl::SO001_D01";
		var inDs = "ds_list_2=ds_list_2:U";
		var outDs = "";
		var args = "";
		var callBackid = "fn_itemSearch";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.fn_itemSearch();
	}
};

this.fn_itemSearch = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args3 = this.gfn_nvl(this.ds_grd2.getColumn(0,"SUB_CODE"),"*");
	var args4 = this.gfn_nvl(this.ds_grd2.getColumn(1,"SUB_CODE"),"*");
	var args5 = this.gfn_nvl(this.ds_grd2.getColumn(2,"SUB_CODE"),"*");
	var args6 = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
	var args7 = "";
	var args8 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var args9 = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
	var args10 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD4");

	if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
	{
		args7 = "Y";
	} else
	{
		args7 = "";
	}
	this.ds_list_2.clearData();
	
	// 상품 조회
	var id = "SO010_S10";
	var url = "svcUrl::SO010_S10";
	var inDs = "";
	var outDs = "ds_list_2=ds_list";
	var args = "CONT_NO="+args1+" BP_CD="+args2+" SUB_CODE1="+args3+" SUB_CODE2="+args4+" SUB_CODE3="+args5+" HS_CODE="+args6+" DLVY_CD="+args8+" MANDATORY_YN="+args7+" DEAL_TYPE="+args9+" CASE_NO="+args10+"";
	var callBackid = "fn_itemSearchCallback";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
};

// 상품조회 콜백
this.fn_itemSearchCallback = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.ds_list_2.set_updatecontrol(false);
		
	for(var i=0; i<this.ds_list_2.rowcount;i++)
	{
		this.ds_list_2.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_list_2.set_updatecontrol(true);
	
	this.fn_popupCallback_itemChange();
}

// 표준 예외 선택 후 구분 세팅
this.fn_popupCallback_itemChange = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if(this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 1)
	{
		this.Div02.form.Tab00.Tabpage1.form.btn_add00.set_visible(true);
		this.Div02.form.Tab00.Tabpage1.form.btn_search01.set_visible(true);
		
		for (var i=0; i<this.ds_list_2.rowcount; i++)
		{
			this.ds_list_2.setColumn(i, "UPDT_DIV", "2");
			
			if (this.ds_list_2.getColumn(i,"MANDATORY_YN") == "N")
			{
				this.ds_list_2.setColumn(i,"CHK","0");
			}
		}
	} else
	{		
		this.Div02.form.Tab00.Tabpage1.form.btn_add00.set_visible(false);
		this.Div02.form.Tab00.Tabpage1.form.btn_search01.set_visible(false);
		
		for (var i=0; i<this.ds_list_2.rowcount; i++)
		{
			this.ds_list_2.setColumn(i, "UPDT_DIV", "1");
		}
	}
}

// 상품정보 추가
this.fn_addBtnClick_1 = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
	{					
		this.alert("발주 확정 된 주문은 상품 추가 할 수 없습니다.");
		return;
	}
	
	this.ds_list_2.addRow();
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PAY_DIV","C");
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"CHK","1");
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"UPDT_DIV","2");
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_STATUS","0");
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"CHOICE_YN","1");
};

// 상품정보 삭제
this.fn_delBtnClick_1 = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
	{					
		this.alert("발주 확정 된 주문은 상품 삭제 할 수 없습니다.");
		return;
	}
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"CHK","0");
	
	this.ds_list_2.deleteRow(this.ds_list_2.rowposition);
};

this.Div06_Tab00_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
{		
	if (e.postindex == 1)
	{
		this.ds_list_2.filter("CHK == '1' && RIBBON_CHK=='Y'")
	}
	else if (e.postindex == 2)
	{
		this.ds_list_2.filter("CHK == '1'")
	}
	else if (e.postindex == 3)
	{
		this.ds_list_2.filter("CHK == '1'")
		
		for(var i=0; i<this.ds_list_2.rowcount; i++)
		{
			var qty = this.ds_list_2.getColumn(i,"SO_QTY");
			var invQty = this.ds_list_2.getColumn(i,"INV_QTY");
			var invChk = this.gfn_nvl(invQty,9999)-qty;
			var setInvQty = qty-invQty;
			
			if (!this.gfn_isNull(this.ds_list_2.getColumn(i,"TS_BP_CD")))
			{
				this.ds_list_2.setColumn(i,"INV_CHK","Y");
			}
		
			if (invChk < 0)
			{
				this.ds_list_2.setColumn(i,"INV_CHK","Y");
				this.ds_list_2.setColumn(i,"MOVE_QTY",setInvQty);
				
				if (this.gfn_isNull(this.ds_list_2.getColumn(i,"MOVE_COST")))
				{
					this.ds_list_2.setColumn(i,"MOVE_COST","25000");
				}				
			}else if (invQty == "-" && this.ds_list_2.getColumn(i,"INV_CHK") == "Y")
			{
				this.ds_list_2.setColumn(i,"INV_CHK","Y")
				
				if (this.gfn_isNull(this.ds_list_2.getColumn(i,"MOVE_COST")))
				{
					this.ds_list_2.setColumn(i,"MOVE_COST","25000");
				}
			} else
			{
				this.ds_list_2.setColumn(i,"INV_CHK","N")
			}
		}
		
		this.ds_list_2.filter("CHK == '1' && INV_CHK=='Y'")
	}
	else if (e.postindex == 7)
	{
		this.ds_list_2.filter("CHK == '1' && PO_BP_CD=='B2039'")
	}
	else
	{
		this.ds_list_2.filter("")
	}
	
	if (e.postindex == 4)
	{		
// 		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 		{					
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.Radio_dealType.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.txt_Month.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.Edit00_00_00.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.TextArea00.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.edt_mRoomNo00.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.edt_mRoomNo.set_enable(false);
// 			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(false);
// 		}
		
		// 결제 대상금액
		this.ds_list_2.filter("DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		// 과세 금액
		this.ds_list_2.filter("VAT_RATE=='10' && DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_01.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		// 비과세 금액
		this.ds_list_2.filter("VAT_RATE=='0' && DEAL_TYPE=='B' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_00_00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		var chk = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE");
	
		if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO")))
		{
			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(true);
		} else
		{
			this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(false);
		}
		
		if (!this.gfn_isNull(chk))
		{
			this.fn_chgDiv(chk);
		}		
	}
	
	if (e.postindex == 6)
	{		
		if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO")
		{
			this.Div02.form.Tab00.Tabpage7.form.Div00.set_visible(false);
			this.Div02.form.Tab00.Tabpage7.form.Div00_00.set_visible(true);
			this.Div02.form.Tab00.Tabpage7.form.Div00_00.set_left(0);
		} else
		{
 			this.Div02.form.Tab00.Tabpage7.form.Div00.set_visible(true);
 			this.Div02.form.Tab00.Tabpage7.form.Div00_00.set_visible(false);
		}
		this.ds_list_2.filter("CHK=='1'");
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		this.ds_list_2.filter("VAT_RATE=='10' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_01.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		this.ds_list_2.filter("VAT_RATE=='0' && CHK=='1'");
		this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_00_00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
		this.ds_list_2.filter("");
		
		this.ds_list_2.filter("CHK=='1'");
	}
};

// 주문복사
this.Div00_btn_copySo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("복사할 주문을 선택해 주세요.");
		return;
	}
	
	// 주문복사 계약번호 체크 start
	var BpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	var id = "SO010_S07";
	var url = "svcUrl::SO010_S07";
	var inDs = "";
	var outDs = "ds_contSearch=ds_list";
	var args = "BP_CD="+BpCd+"";
	var callBackid = "fn_aftercontSearchCallback";		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	// 주문복사 계약번호 체크 end
};

// 주문복사 계약번호 체크 callback
this.fn_aftercontSearchCallback = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	var ContNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	var ContNo1 = this.ds_contSearch.getColumn(this.ds_contSearch.rowposition,"CONT_NO");
	if (ContNo != ContNo1)
	{
		this.alert("계약번호가 최신계약번호와 상의 하여 주문복사가 불가 합니다.");
		return;
	}else
	{
		var SoNo = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO");

		var arrArg = [];
		this.gfn_openForm2(this.objApp.gds_menu, "SO100", arrArg, SoNo, "copy");
	}
};

// 상품정보 클릭이벤트
this.Div06_Tab00_Tabpage2_grd_list01_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 0)
	{
		if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
		{					
			this.alert("예외인 경우에만 품목을 선택 할 수 있습니다.");
			return;
		}
	}
	
	if (e.col == 4)
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"CHOICE_YN") != '1')
		{
			return;
		}
		
		if (this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"DEAL_TYPE")))
		{					
			this.alert("법인/개인 구분을 선택해 주세요");
			return;
		}
		
// 		if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
// 		{					
// 			this.alert("예외인 경우에만 품목을 선택 할 수 있습니다.");
// 			return;
// 		}
		
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{					
			this.alert("발주 확정 된 주문은 상품 변경 할 수 없습니다.");
			return;
		}
		
		var contNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		var subCode1 = this.gfn_nvl(this.ds_grd2.getColumn(0,"SUB_CODE"),"*");
		var subCode2 = this.gfn_nvl(this.ds_grd2.getColumn(1,"SUB_CODE"),"*");
		var subCode3 = this.gfn_nvl(this.ds_grd2.getColumn(2,"SUB_CODE"),"*");
		var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
		var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
		var mandatoryYn = "";
		var dealType = this.ds_list.getColumn(this.ds_list.rowposition,"DEAL_TYPE");
		var caseNo = this.ds_soAdd.getColumn(this.ds_list.rowposition,"ADD_CD4");
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD2");
		var poBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD");
		
		if (this.Div02.form.Tab00.Tabpage1.form.Radio00.index == 0)
		{
			mandatoryYn = "Y";
		} else
		{
			mandatoryYn = "";
		}
			
		var sPopupId  = "item_popup";
		var sUrl      = "SO::SO010_P02.xfdl";
		var oArg      = {T_SO_NO : T_SO_NO, contNo : contNo, bpCd : bpCd, subCode1 : subCode1, subCode2 : subCode2, subCode3 : subCode3, hsCd : hsCd, dlvyCd : dlvyCd, mandatoryYn : mandatoryYn, dealType : dealType, caseNo : caseNo, itemCd : itemCd, poBpCd : poBpCd};
		var sCallBack = "fn_popupCallback_item";
		var oOption   = {title : "품목 선택"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	
	if (e.col == 19)
	{
		var item = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
	
		if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK","Y");
			
			this.Div02.form.Tab00.set_tabindex(3);
			
			this.ds_list_2.filter("CHK == '1' && INV_CHK=='Y'")
		}
	}
	
	if (e.col == 20)
	{
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var itemNm = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_NM");
			
		var sPopupId  = "BOM_popup";
		var sUrl      = "SO::SO001_P17.xfdl";
		var oArg      = {itemCd : itemCd, itemNm : itemNm};
		var sCallBack = "fn_popupCallback_BOM";
		var oOption   = {title : "BOM 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	
	if (e.col == 21)
	{
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var itemNm = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_NM");
		var poBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD");
		var poBpNm = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"REGION_NM");
			
		var sPopupId  = "INV_popup";
		var sUrl      = "SO::SO001_P20.xfdl";
		var oArg      = {itemCd : itemCd, itemNm : itemNm, poBpCd : poBpCd, poBpNm : poBpNm};
		var sCallBack = "fn_popupCallback_INV";
		var oOption   = {title : "재고 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	
	if (e.col == 22)
	{
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var slCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD");
		var itemNm = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_NM");
		var slNm = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"REGION_NM");
		
		if (this.gfn_isNull(itemCd))
		{
			this.alert("품목을 선택하시기 바랍니다.")
			return;
		}
		
		if (this.gfn_isNull(slCd))
		{
			this.alert("발주지점을 선택하시기 바랍니다.")
			return;
		}
			
		var sPopupId  = "INV_popup";
		var sUrl      = "SO::SO001_P29.xfdl";
		var oArg      = {itemCd : itemCd, slCd : slCd, itemNm : itemNm, slNm : slNm};
		var sCallBack = "fn_popupCallback_INV2";
		var oOption   = {title : "입고예정 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
};

// 상품 팝업 callback
this.fn_popupCallback_item = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"YES_ITEM")))
	{
		var dealType = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"DEAL_TYPE");
	
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_CD",this.gfn_isNullRtn(objRtn.ITEM_CD,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_NM",this.gfn_isNullRtn(objRtn.ITEM_NM,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_ACCT",this.gfn_isNullRtn(objRtn.ITEM_ACCT,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_TYPE",this.gfn_isNullRtn(objRtn.VAT_TYPE,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_RATE",this.gfn_isNullRtn(objRtn.VAT_RATE,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BASIC_UNIT",this.gfn_isNullRtn(objRtn.BASIC_UNIT,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"RIBBON_CHK",this.gfn_isNullRtn(objRtn.RIBBON_CHK,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BRANCH_GROUP",this.gfn_isNullRtn(objRtn.BRANCH_GROUP,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_BP_CD",this.gfn_isNullRtn(objRtn.PO_BP_CD,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"REGION_NM",this.gfn_isNullRtn(objRtn.REGION_NM,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"MANDATORY_YN",this.gfn_nvl(objRtn.MANDATORY_YN,"N"));
		
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",this.gfn_isNullRtn(objRtn.INV_QTY,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"DC_PRC",this.gfn_isNullRtn(objRtn.DC_PRC,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TEL_NO2",this.gfn_isNullRtn(objRtn.TEL_NO2,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_PRICE",this.gfn_isNullRtn(objRtn.PO_PRICE,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_AMT",this.gfn_isNullRtn(objRtn.PO_AMT,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK",this.gfn_isNullRtn(objRtn.INV_CHK,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",this.gfn_isNullRtn(objRtn.INV_QTY,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE",this.gfn_isNullRtn(objRtn.SO_PRICE,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_QTY",this.gfn_isNullRtn(objRtn.SO_QTY,""));
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ETC_REMARK",this.gfn_isNullRtn(objRtn.ETC_REMARK,""));
			
		if (dealType == "A")
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE",this.gfn_isNullRtn(objRtn.SO_PRICE,""));
		} else
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE",this.gfn_isNullRtn(objRtn.SO_PRICE,""));
		}	
	} else
	{
		var dealType = this.Div02.form.Tab00.Tabpage1.form.Radio00.value;
		//trace(objRtn.ITEM_CD.substr(0,1));
		if (dealType == "표준" && objRtn.ITEM_CD.substr(0,1) == "B")
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_CD",this.gfn_isNullRtn(objRtn.ITEM_CD,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_NM",this.gfn_isNullRtn(objRtn.ITEM_NM,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_ACCT",this.gfn_isNullRtn(objRtn.ITEM_ACCT,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_TYPE",this.gfn_isNullRtn(objRtn.VAT_TYPE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_RATE",this.gfn_isNullRtn(objRtn.VAT_RATE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BASIC_UNIT",this.gfn_isNullRtn(objRtn.BASIC_UNIT,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"RIBBON_CHK",this.gfn_isNullRtn(objRtn.RIBBON_CHK,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"MANDATORY_YN",this.gfn_nvl(objRtn.MANDATORY_YN,"N"));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ETC_REMARK",this.gfn_isNullRtn(objRtn.ETC_REMARK,""));
			
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK",this.gfn_isNullRtn(objRtn.INV_CHK,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",this.gfn_isNullRtn(objRtn.INV_QTY,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_QTY",objRtn.SO_QTY);
		}else
		{	
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_CD",this.gfn_isNullRtn(objRtn.ITEM_CD,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_NM",this.gfn_isNullRtn(objRtn.ITEM_NM,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ITEM_ACCT",this.gfn_isNullRtn(objRtn.ITEM_ACCT,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_TYPE",this.gfn_isNullRtn(objRtn.VAT_TYPE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_RATE",this.gfn_isNullRtn(objRtn.VAT_RATE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BASIC_UNIT",this.gfn_isNullRtn(objRtn.BASIC_UNIT,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"RIBBON_CHK",this.gfn_isNullRtn(objRtn.RIBBON_CHK,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BRANCH_GROUP",this.gfn_isNullRtn(objRtn.BRANCH_GROUP,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_BP_CD",this.gfn_isNullRtn(objRtn.PO_BP_CD,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"REGION_NM",this.gfn_isNullRtn(objRtn.REGION_NM,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"MANDATORY_YN",this.gfn_nvl(objRtn.MANDATORY_YN,"N"));
			
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",this.gfn_isNullRtn(objRtn.INV_QTY,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"DC_PRC",this.gfn_isNullRtn(objRtn.DC_PRC,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TEL_NO2",this.gfn_isNullRtn(objRtn.TEL_NO2,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_PRICE",this.gfn_isNullRtn(objRtn.PO_PRICE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_AMT",this.gfn_isNullRtn(objRtn.PO_AMT,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK",this.gfn_isNullRtn(objRtn.INV_CHK,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",this.gfn_isNullRtn(objRtn.INV_QTY,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE",this.gfn_isNullRtn(objRtn.SO_PRICE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_QTY",this.gfn_isNullRtn(objRtn.SO_QTY,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE",this.gfn_isNullRtn(objRtn.SO_PRICE,""));
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ETC_REMARK",this.gfn_isNullRtn(objRtn.ETC_REMARK,""));
		}
		
	}	
}

// 리본/카드 그리드 클릭 이벤트
this.Div02_Tab00_Tabpage2_grd_list_2_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 5)				//리본메시지
	{
// 		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 		{					
// 			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
// 			return;
// 		}
		
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		var hsCd = this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD");
		var subCode1 = this.ds_grd2.getColumn(0,"SUB_CODE");
		var subCode2 = this.ds_grd2.getColumn(1,"SUB_CODE");
		var sysDiv = "HJW";
	
		var sPopupId  = "msg1_popup";
		var sUrl      = "SO::SO001_P08.xfdl";
		//var oArg      = {bpCd : bpCd};
		var oArg      = {bpCd : bpCd, hsCd : hsCd, subCode1 : subCode1, subCode2 : subCode2, sysDiv : sysDiv};
		var sCallBack = "fn_popupCallback_msg1";
		var oOption   = {title : "리본메시지"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	else if (e.col == 7)		//경조사어
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{					
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}
		
		var sPopupId  = "msg2_popup";
		var sUrl      = "SO::SO001_P09.xfdl";
		var oArg      = {rcGu : "R"};
		var sCallBack = "fn_popupCallback_msg2";
		var oOption   = {title : "경조사어"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	else if (e.col == 9)		//카드메시지
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{					
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}
		
		var sPopupId  = "msg3_popup";
		var sUrl      = "SO::SO001_P09.xfdl";
		var oArg      = {rcGu : "C"};
		var sCallBack = "fn_popupCallback_msg3";
		var oOption   = {title : "카드메시지"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
};

// 리본 팝업 callback
this.fn_popupCallback_msg1 = function(sPopId, sRtn)
{
	sRtn = sRtn.replace(/\n/gi,"\\r\\n");

    var objRtn = JSON.parse(sRtn);
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"RIBBON_MESSAGE",objRtn.SENDER_NM);
}

// 경조사어 팝업 callback
this.fn_popupCallback_msg2 = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"HS_MESSAGE",objRtn.MSG_DESC);
}

// 카드메시지 팝업 callback
this.fn_popupCallback_msg3 = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"CARD_MESSAGE",objRtn.MSG_DESC);
}

// 지점정보 그리드 클릭이벤트
this.Div02_Tab00_Tabpage3_grd_list03_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 12)
	{
		if (this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD")))
		{
			this.alert("품목을 선택해주세요");
			return;
		}
		
		if (this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY")))
		{
			this.alert("수량을 입력해주세요");
			return;
		}
		
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{					
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}
		
		if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO")
		{					
			this.alert("탁송 주문은 지점을 선택 할 수 없습니다.");
			return;
		}
		
		if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") != "STO" && !this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
		{					
			this.alert("탁송주문" +this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")+ " 이 존재합니다. 탁송주문 삭제 후 지점 변경 하시기 바랍니다.");
			return;
		}
		
		var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
		var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var soQty = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY");
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		var type = "1";
		
		var sPopupId  = "fromBp_popup";
		var sUrl      = "SO::SO001_P10.xfdl";
		var oArg      = {dlvyCd : dlvyCd, branchGroup : branchGroup, itemCd : itemCd, bpCd : bpCd, type: type, soQty : soQty};
		var sCallBack = "fn_popupCallback_fromBp";
		var oOption   = {title : "발주지점"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	
	if (e.col == 14)
	{
		var clientCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD")
	
		var sPopupId  = "telInfo_popup";
		var sUrl      = "SO::SO001_P04.xfdl";
		var oArg      = {clientCd : clientCd};
		var sCallBack = "fn_popupCallback_telInfo";
		var oOption   = {title : "Tel Info"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
};

// 지점정보 팝업 callback
this.fn_popupCallback_fromBp = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	//trace(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"FAX_NO")+">>"+objRtn.FAX_NO)
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD") == "B3101010" && objRtn.BRANCH_GROUP != "F")
	{
		this.alert("의전지점은 배송(의전) 품목을 잡아야 합니다.");
		return;
	}
	
	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD") == "C1200010" && objRtn.BRANCH_GROUP != "M")
	{
		this.alert("플라워지점은 배송(FL) 품목을 잡아야 합니다.");
		return;
	}
	
	var poBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD");
	if (!this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
	{
		if (poBpCd != objRtn.BP_CD)
		{
			this.alert("지점이 변경 되었습니다. 탁송주문의 하차지점과 지점이 동일해야 하니 꼭 확인 하시기 바랍니다.");
		}
	}
	
// 	for (var i=0; i<this.ds_list_2.rowcount; i++)
// 	{d
// 		if (objRtn.BRANCH_GROUP == "F")
// 		{
// 			if (this.ds_list_2.getColumn(i,"BRANCH_GROUP") == "F")
// 			{
// 				this.ds_list_2.setColumn(i,"INV_QTY",objRtn.GOOD_QTY_INFO);
// 				this.ds_list_2.setColumn(i,"DC_PRC",objRtn.DC_PRC);
// 				this.ds_list_2.setColumn(i,"PO_BP_CD",objRtn.BP_CD);
// 				this.ds_list_2.setColumn(i,"REGION_NM",objRtn.BP_NM);
// 				this.ds_list_2.setColumn(i,"TEL_NO2",objRtn.TEL_NO2);
// 				this.ds_list_2.setColumn(i,"BRANCH_GROUP",objRtn.BRANCH_GROUP);
// 				this.ds_list_2.setColumn(i,"PO_PRICE",objRtn.PO_PRICE);
// 				if (objRtn.GOOD_QTY_INFO < this.ds_list_2.getColumn(i,"SO_QTY"))
// 				{
// 					this.ds_list_2.setColumn(i,"INV_CHK","Y");
// 				} else 
// 				{
// 					this.ds_list_2.setColumn(i,"INV_CHK","N");
// 				}
// 			}
// 		} else if (objRtn.BRANCH_GROUP == "M")
// 		{
// 			if (this.ds_list_2.getColumn(i,"BRANCH_GROUP") == "M")
// 			{
// 				this.ds_list_2.setColumn(i,"INV_QTY",objRtn.GOOD_QTY_INFO);
// 				this.ds_list_2.setColumn(i,"DC_PRC",objRtn.DC_PRC);
// 				this.ds_list_2.setColumn(i,"PO_BP_CD",objRtn.BP_CD);
// 				this.ds_list_2.setColumn(i,"REGION_NM",objRtn.BP_NM);
// 				this.ds_list_2.setColumn(i,"TEL_NO2",objRtn.TEL_NO2);
// 				this.ds_list_2.setColumn(i,"BRANCH_GROUP",objRtn.BRANCH_GROUP);
// 				this.ds_list_2.setColumn(i,"PO_PRICE",objRtn.PO_PRICE);
// 				if (objRtn.GOOD_QTY_INFO < this.ds_list_2.getColumn(i,"SO_QTY"))
// 				{
// 					this.ds_list_2.setColumn(i,"INV_CHK","Y");
// 				} else 
// 				{
// 					this.ds_list_2.setColumn(i,"INV_CHK","N");
// 				}
// 			}
// 		}
// 	}
	var invQty = objRtn.GOOD_QTY_INFO;
	if (this.gfn_isNull(objRtn.GOOD_QTY_INFO))
	{
		invQty = "-";
	}
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_QTY",invQty);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"DC_PRC",objRtn.DC_PRC);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_BP_CD",objRtn.BP_CD);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"REGION_NM",objRtn.BP_NM);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TEL_NO2",objRtn.TEL_NO2);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BRANCH_GROUP",objRtn.BRANCH_GROUP);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_PRICE",objRtn.PO_PRC);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_AMT",objRtn.PO_PRICE);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"FAX_NO",objRtn.FAX_NO);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ETC_REMARK",objRtn.ETC_REMARK);
	
	var qty = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY");
	var dcPrc = (objRtn.PO_PRC*qty)-objRtn.PO_PRICE;
	//trace(dcPrc)
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TOTAL_AMT",objRtn.PO_PRC*qty);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"DC_AMT",dcPrc);
	
	if (objRtn.GOOD_QTY_INFO < this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY"))
	{
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK","Y");
	} else 
	{
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"INV_CHK","N");
	}	
}

// 지점정보 팝업 callback
this.fn_popupCallback_fromBp2 = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	if (!this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
	{
		if (poBpCd != objRtn.BP_CD)
		{
			this.alert("지점이 변경 되었습니다. 도착지점과 원주문의 하차지점이 동일해야 하니 꼭 확인 하시기 바랍니다.");
		}
	}
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TS_BP_CD",objRtn.BP_CD);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TS_BP_NM",objRtn.BP_NM);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TEL_NO2",objRtn.TEL_NO2);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"BRANCH_GROUP",objRtn.BRANCH_GROUP);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_PRICE",objRtn.PO_PRICE);
}

// 탁송처리 그리드 클릭 이벤트
this.Div02_Tab00_Tabpage4_grd_list03_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 5)
	{
		if (!this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
		{					
			this.alert("탁송주문이 존재하여 원주문의 상차지점을 수정 할 수 없습니다.");
			return;
		}
		
		var item = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var poStatus = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS");
		
		if (item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
		{
			var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
			var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
			var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
			
			var sPopupId  = "toBp_popup";
			var sUrl      = "SO::SO001_P11.xfdl";
			var oArg      = {branchGroup : branchGroup, itemCd : itemCd};
			var sCallBack = "fn_popupCallback_toBp";
			var oOption   = {title : "상차지점"};
			this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
		} else if (poStatus == "0")
		{
			var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
			var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
			var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
			
			var sPopupId  = "toBp_popup";
			var sUrl      = "SO::SO001_P11.xfdl";
			var oArg      = {branchGroup : branchGroup, itemCd : itemCd};
			var sCallBack = "fn_popupCallback_toBp";
			var oOption   = {title : "상차지점"};
			this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
		} else
		{
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}		
	}
	
	if (e.col == 6)
	{
		var clientCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"TS_BP_CD")
	
		var sPopupId  = "telInfo_popup";
		var sUrl      = "SO::SO001_P04.xfdl";
		var oArg      = {clientCd : clientCd};
		var sCallBack = "fn_popupCallback_telInfo";
		var oOption   = {title : "Tel Info"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
	
	if (e.col == 9)
	{
		var clientCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_BP_CD")
	
		var sPopupId  = "telInfo_popup";
		var sUrl      = "SO::SO001_P04.xfdl";
		var oArg      = {clientCd : clientCd};
		var sCallBack = "fn_popupCallback_telInfo";
		var oOption   = {title : "Tel Info"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
	
	// 탁송처리
	if (e.col == 14)
	{
		var sono = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
		var moveChk = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI");
		var tsBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"TS_BP_CD");
		var moveQty = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"MOVE_QTY");
		var saveYn = this.ds_list_2.getColumn(0,"SAVE_YN");

		if (this.gfn_isNull(sono))
		{
			this.alert("원주문을 먼저 저장 하시기 바랍니다.")
			return;
		} else if (saveYn == "1")
		{
			this.alert("상품정보가 저장되어 있지 않습니다. 먼저 저장 하시기 바랍니다.");
			return;
		} else if (!this.gfn_isNull(moveChk))
		{
			this.alert("이미 탁송 처리 되었습니다.");
			return;
		} else if (this.gfn_isNull(tsBpCd))
		{
			this.alert("상차 지점을 입력하시기 바랍니다.");
			return;
		} else if (this.gfn_isNull(moveQty) || moveQty == "0")
		{
			this.alert("탁송수량을 입력하시기 바랍니다.");
			return;
		}
		else
		{	
			if (this.confirm("탁송 주문 하시겠습니까?"))
			{			
				var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
				var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
				var netAmt = 0;
				var vatAmt = 0;
				
				for (i=0; i < this.ds_list_2.rowcount; i++)
				{
					if (this.ds_list_2.getColumn(i,"CHK") == 1)
					{
						netAmt = netAmt + parseInt(this.ds_list_2.getColumn(i,"NET_AMT"));
						vatAmt = vatAmt + parseInt(this.ds_list_2.getColumn(i,"VAT_AMT"));
					}
				}	
				
				var id = "SO001_M01";
				var url = "svcUrl::SO001_M01";
				var inDs = "ds_list=ds_list:U";
				var outDs = "ds_list_out=ds_list_out";
				var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" NET_AMT="+netAmt+" VAT_AMT="+vatAmt+"";
				var callBackid = "fn_afterStoSave1";
					
				this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
			}
		}
	}
	
	// 탁송조회
	if (e.col == 16)
	{
		var soNo = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI");
		
		if (this.gfn_isNull(soNo))
		{
			this.alert("주문번호가 없습니다.")
			return;
		}
		
		var stoSoNo = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI");

		var arrArg = [];
		this.gfn_openForm2(this.objApp.gds_menu, "SO100", arrArg, stoSoNo);
		
// 		this.fn_search(soNo);
// 		this.Div02.form.Tab00.set_tabindex(6);
// 		
// 		this.Div02.form.Tab00.Tabpage7.form.Div00.set_visible(false);
// 		this.Div02.form.Tab00.Tabpage7.form.Div00_00.set_visible(true);
// 		this.Div02.form.Tab00.Tabpage7.form.Div00_00.set_left(0);
	}
};

// 주문 디테일 저장
this.fn_afterStoSave1 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	if (this.gfn_isNull(soNo))
	{
		soNo = this.ds_list_out.getColumn(this.ds_list_out.rowposition,"SO_NO")
	}
	
	var id = "SO001_M05_00";
	var url = "svcUrl::SO001_M05_00";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_list_3=ds_list_3:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO="+soNo+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterStoSave2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 배송비 계산
this.fn_afterStoSave2 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M06";
	var url = "svcUrl::SO001_M06";
	var inDs = "";
	var outDs = "";
	var args = "SO_NO="+soNo+"";
	//var callBackid = "";
	var callBackid = "fn_afterStoSave3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 탁송주문 등록
this.fn_afterStoSave3 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	//주문 헤더
	this.ds_list.set_updatecontrol(false);
	
	this.ds_list.setRowType(this.ds_list.rowposition,Dataset.ROWTYPE_INSERT);
	
	this.ds_list.set_updatecontrol(true);
	
	
	//상품정보			
	this.ds_list_2.set_updatecontrol(false);
	
	this.ds_list_2.setRowType(this.ds_list_2.rowposition,Dataset.ROWTYPE_INSERT);
	
	this.ds_list_2.set_updatecontrol(true);
	
	// 소속
	this.ds_grd2.set_updatecontrol(false);
	
	for(var i=0; i<this.ds_grd2.rowcount;i++)
	{
		this.ds_grd2.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd2.set_updatecontrol(true);
	
	// 대상자		
	this.ds_grd3.set_updatecontrol(false);
	
	for(var i=0; i<this.ds_grd3.rowcount;i++)
	{
		this.ds_grd3.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd3.set_updatecontrol(true);
	
	// 주문자
	this.ds_grd4.set_updatecontrol(false);
	
	for(var i=0; i<this.ds_grd4.rowcount;i++)
	{
		this.ds_grd4.setRowType(i,Dataset.ROWTYPE_INSERT);
	}
	
	this.ds_grd4.set_updatecontrol(true);
	
	// 사전상담
// 	if (this.ds_soAdd.rowcount > 0)
// 	{
// 		this.ds_soAdd.set_updatecontrol(false);	
// 		this.ds_soAdd.setRowType(0,Dataset.ROWTYPE_INSERT);
// 		this.ds_soAdd.set_updatecontrol(true);
// 	}	
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNoOri = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO");
	var soSeqOri = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_SEQ");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	var id = "SO001_M02";
	var url = "svcUrl::SO001_M02";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_move_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO_ORI="+soNoOri+" SO_SEQ_ORI="+soSeqOri+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterMove";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_afterMove = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	this.fn_search(soNo);
	this.alert("탁송주문이 등록되었습니다.");
}

// 원주문 조회
this.Div02_Tab00_Tabpage7_Div00_00_grd_list03_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if (e.col == 6)
	{
// 		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 		{					
// 			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
// 			return;
// 		}
		
		var item = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var poStatus = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS");
		
		if (item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
		{
			var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
			var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
			var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
			
			var sPopupId  = "toBp_popup";
			var sUrl      = "SO::SO001_P11.xfdl";
			var oArg      = {branchGroup : branchGroup, itemCd : itemCd};
			var sCallBack = "fn_popupCallback_toBp2";
			var oOption   = {title : "상차지점"};
			this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
		} else if (poStatus == "0")
		{
			var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
			var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
			var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
			
			var sPopupId  = "toBp_popup";
			var sUrl      = "SO::SO001_P11.xfdl";
			var oArg      = {branchGroup : branchGroup, itemCd : itemCd};
			var sCallBack = "fn_popupCallback_toBp2";
			var oOption   = {title : "출발지점"};
			this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
		} else
		{
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}		
	}
	
	if (e.col == 8)
	{
		if (this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD")))
		{
			this.alert("품목을 선택해주세요");
			return;
		}
		
		if (this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY")))
		{
			this.alert("수량을 입력해주세요");
			return;
		}
		
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{					
			this.alert("발주 확정 된 주문은 수정 할 수 없습니다.");
			return;
		}
		
		var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
		var branchGroup = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"BRANCH_GROUP");
		var itemCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"ITEM_CD");
		var soQty = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY");
		var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		var type = "1";
		
		var sPopupId  = "fromBp_popup";
		var sUrl      = "SO::SO001_P10.xfdl";
		var oArg      = {dlvyCd : dlvyCd, branchGroup : branchGroup, itemCd : itemCd, bpCd : bpCd, type: type, soQty : soQty};
		var sCallBack = "fn_popupCallback_fromBp2";
		var oOption   = {title : "도착지점"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
	
	// 원주문 조회
	if (e.col == 9)
	{
		var soNo = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI");
		
		if (this.gfn_isNull(soNo))
		{
			this.alert("주문번호가 없습니다.")
			return;
		}
		
// 		this.fn_search(soNo);
// 		this.Div02.form.Tab00.set_tabindex(0);
		var stoSoNo = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI");
		//trace(soNo);
		var arrArg = [];
		this.gfn_openForm2(this.objApp.gds_menu, "SO100", arrArg, stoSoNo);
	}
};

// 상차지점 팝업 callback
this.fn_popupCallback_toBp = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	var poBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"TS_BP_CD");
	if (!this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
	{
		if (poBpCd != objRtn.BP_CD)
		{
			this.alert("지점이 변경 되었습니다. 원주문의 상차지점과 탁송주문의 출발지점이 동일해야 하니 꼭 확인 하시기 바랍니다.");
		}
	}
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TS_BP_CD",objRtn.BP_CD);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TS_BP_NM",objRtn.BP_NM);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"GOOD_QTY_INFO",objRtn.GOOD_QTY_INFO);
}

// 탁송 상차지점 팝업 callback
this.fn_popupCallback_toBp2 = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);
	
	var poBpCd = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"TS_BP_CD");
	if (!this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
	{
		if (poBpCd != objRtn.BP_CD)
		{
			this.alert("지점이 변경 되었습니다. 출발지점과 원주문의 상차지점이 동일해야 하니 꼭 확인 하시기 바랍니다.");
		}
	}
	
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_BP_CD",objRtn.BP_CD);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"REGION_NM",objRtn.BP_NM);
	this.ds_list_2.setColumn(this.ds_list_2.rowposition,"GOOD_QTY_INFO",objRtn.GOOD_QTY_INFO);
}

// 메모 추가
this.fn_addBtnClick_2 = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dte = this.gfn_getDate();
	
	this.ds_memo.addRow();
	this.ds_memo.setColumn(this.ds_memo.rowposition,"INSRT_USER_ID",regUser);
	this.ds_memo.setColumn(this.ds_memo.rowposition, "INSRT_DT", dte)
};

// 메모 삭제
this.fn_delBtnClick_2 = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.ds_memo.deleteRow(this.ds_memo.rowposition);
};

this.ds_list_2_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if (e.columnid == "SO_QTY")
	{
		this.alert("발주금액이 다를 수 있으니, 지점정보 탭의 지점을 선택하세요");
	}
	
	if (e.columnid == "SO_PRICE" || e.columnid == "SO_QTY")
	{
		var qty = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY");
		var cost = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_PRICE");
		var vatRate = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"VAT_RATE");
		var poPrice = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_PRICE");
		var netAmt = nexacro.round(qty*cost/1.1,0);
		var vatAmt = qty*cost - netAmt;
		
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TOTAL_PRICE",qty*cost);
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"PO_AMT",qty*poPrice);
		this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TOTAL_AMT",qty*poPrice);
		// 공급가액, 부가세
		if (vatRate > 0)
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"NET_AMT",netAmt);
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_AMT",vatAmt);
		} else
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"NET_AMT",qty*cost);
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_AMT","0");
		}
	}
	
	if (e.columnid == "PAY_DIV")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PAY_DIV") == "F")
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"SO_PRICE","0");
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"NET_AMT","0");
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_AMT","0");
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"TOTAL_PRICE","0");
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"VAT_RATE","0");
		} else if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PAY_DIV") == "C" && this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_PRICE") == "0")
		{
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"REASON",null);
			this.ds_list_2.setColumn(this.ds_list_2.rowposition,"ADD_CD1",null);
			this.alert("유상인데 금액 설정이 되어 있지 않습니다. 품목을 다시 선택해주세요");
			return;
		}
	}
};

// 대상자 SMS
this.Div00_btn_ownSms_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var hp = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
	var user = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var sPopupId  = "sms_popup";
	var sUrl      = "SO::SO001_P12.xfdl";
	var oArg      = {user : user, hp : hp, soNo : soNo};
	var sCallBack = "";
	var oOption   = {title : "대상자 SMS"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 주문자 SMS
this.Div00_btn_reqSms_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var hp = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO1");
	var user = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var sPopupId  = "reqSms_popup";
	var sUrl      = "SO::SO001_P12.xfdl";
	var oArg      = {user : user, hp : hp, soNo : soNo};
	var sCallBack = "";
	var oOption   = {title : "주문자 SMS"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 주문 확정
this.Div02_Tab00_Tabpage7_btn_confirm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	// 유효성체크
	if(this.fn_valChk() == false)
	{
		return;
	}
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var args2 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var args3 = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var args4 = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	
	// 중복 확인
	var id = "SO001_P07_S";
	var url = "svcUrl::SO001_P07";
	var inDs = "";
	var outDs = "ds_orderChk=ds_list";
	var args = "SOLD_TO_PARTY="+args1+" DLVY_CD="+args2+" SO_NO="+args3+" DLVY_DT2="+args4+"";
	var callBackid = "fn_afterOrderChk2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
};



// 주문 헤더 저장
this.fn_afterOrderChk2 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var netAmt = 0;
	var vatAmt = 0;
	this.ds_list.setColumn(this.ds_list.rowposition,"INSRT_USER_ID",regUser)
	
	for (i=0; i < this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"CHK") == 1)
		{
			netAmt = netAmt + parseInt(this.ds_list_2.getColumn(i,"NET_AMT"));
			vatAmt = vatAmt + parseInt(this.ds_list_2.getColumn(i,"VAT_AMT"));
		}
	}	
	
	var id = "SO001_M01";
	var url = "svcUrl::SO001_M01";
	var inDs = "ds_list=ds_list:U";
	var outDs = "ds_list_out=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" NET_AMT="+netAmt+" VAT_AMT="+vatAmt+"";
	var callBackid = "fn_afterOrderChk3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 주문 디테일 저장
this.fn_afterOrderChk3 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	if (this.gfn_isNull(soNo))
	{
		soNo = this.ds_list_out.getColumn(this.ds_list_out.rowposition,"SO_NO")
	}
	
	var id = "SO001_M05_00";
	var url = "svcUrl::SO001_M05_00";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_list_3=ds_list_3:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO="+soNo+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterOrderChk4";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 배송비 계산
this.fn_afterOrderChk4 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M06";
	var url = "svcUrl::SO001_M06";
	var inDs = "";
	var outDs = "";
	var args = "SO_NO="+soNo+"";
	//var callBackid = "";
	var callBackid = "fn_afterOrderChk5";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 실시간 재고 체크
this.fn_afterOrderChk5 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	// 실시간 재고 확인 (A01 용품만)
	var id = "SO001_S14";
	var url = "svcUrl::SO001_S14";
	var inDs = "";
	var outDs = "ds_qtyChk=ds_list";
	var args = "SO_NO="+args1+"";
	var callBackid = "fn_afterOrderChk6";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);		
}

// 재고체크 콜백
this.fn_afterOrderChk6 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_qtyChk.getColumn(0,"QTY") < 0 && this.ds_qtyChk.getColumn(0,"MOVE_YN") != "Y")
	{
		this.alert("품목코드 : "+this.ds_qtyChk.getColumn(0,"ITEM_CD")+" 의 실시간 재고가 부족합니다. 상품을 재조회 하시어 진행 바랍니다.")
		return ;
	}
	
	if (this.ds_orderChk.rowcount > 0)
	{
		if (this.confirm("중복주문이 의심됩니다. 그래도 확정 하시겠습니까?"))
		{
			this.fn_confirm();
		} else
		{
			var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
			var bpNm = this.ds_list.getColumn(this.ds_list.rowposition,"BP_NM");
			var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
			var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
			var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
			var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
			
			var sPopupId  = "orderChk_popup";
			var sUrl      = "SO::SO001_P19.xfdl";
			var oArg      = {bpCd : bpCd, bpNm : bpNm, dlvyCd : dlvyCd, dlvyNm : dlvyNm, soNo : soNo, dlvyDt : dlvyDt};
			var sCallBack = "fn_orderChk";
			var oOption   = {title : "중복 확인"};
			this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
		}
	} else
	{
		this.fn_confirm();
	}
}

// 실시간 재고 체크
// this.fn_qtyChk = function(strSvcID, nErrorCode, strErrorMag)
// {
// 	if (nErrorCode < 0) 
// 	{
// 		this.alert(strErrorMag)
// 		return ;
// 	}
// 	trace(this.ds_qtyChk.getColumn(0,"QTY"));
// 	trace(this.ds_qtyChk.getColumn(0,"MOVE_YN"));
// 	
// 	if (this.ds_qtyChk.getColumn(0,"QTY") < 0 && this.ds_qtyChk.getColumn(0,"MOVE_YN") != "Y")
// 	{
// 		this.alert("품목코드 : "+this.ds_qtyChk.getColumn(0,"ITEM_CD")+" 의 실시간 재고가 부족합니다. 상품을 재조회 하시기 바랍니다.")
// 		return ;
// 	}
// }

this.fn_confirm = function ()
{	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("주문 저장 후 확정 하시기 바랍니다.");
		return;
	}
	
	if (this.ds_list_2.getColumn(0,"CFM_FLAG") == "Y")
	{
		this.alert("이미 확정 된 주문입니다. 확인 하시기 바랍니다.");
		return;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var sUrl_01 = "";
	
	if (this.ds_bugochk.getColumn(0,"BUGO_CHK") == "1")
	{
		sUrl_01 = "SO::SO001_P13_01.xfdl";
	}
	else
	{
		sUrl_01 = "SO::SO001_P13.xfdl";
	}
	
	var sPopupId  = "confirm_popup";
	var sUrl      = sUrl_01;
	var oArg      = {soNo : soNo};
	var sCallBack = "fn_popupCallback_confirm";
	var oOption   = {title : "주문 확정"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 주문확정 팝업 callback
this.fn_popupCallback_confirm = function(sPopId, sRtn)
{
	var objRtn = JSON.parse(sRtn);
	
	var workNm = "발주 확정";
	
	this.fn_confirmDo(objRtn, workNm);
}

this.Div02_Tab00_Tabpage7_btn_cancel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_2.getColumn(0,"CFM_FLAG") != "Y")
	{
		this.alert("확정 된 주문이 아닙니다. 확인 하시기 바랍니다.");
		return;
	}
	
	for (var i=0; i<this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"MOVE_YN") == "Y")
		{
			this.alert("탁송주문이 확정 되어 원주문을 취소 할 수 없습니다.")
			return;
		}
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");

	var id = "SO001_S16";
	var url = "svcUrl::SO001_S16";
	var inDs = "";
	var outDs = "ds_dnChk=ds_dnChk";
	var args = "SO_NO="+soNo+"";
	var callBackid = "fn_dnChk2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

this.fn_dnChk2 = function(strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_dnChk.getColumn(0,"DN_CNT") == 0)
	{
		var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
		// 발주 상태 조회 (대기, 확정 제외)
		var id = "SO001_S13";
		var url = "svcUrl::SO001_S13";
		var inDs = "";
		var outDs = "ds_dn=ds_list";
		var args = "SO_NO="+soNo+"";
		var callBackid = "fn_afterDnChk";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
	} else
	{
		this.alert("출고 취소중입니다. 잠시후 다시 시도하시기 바랍니다.(최대3분)");
		return;
	}
}

this.fn_afterDnChk = function ()
{
	if (this.ds_dn.rowcount > 0)
	{
		this.alert("발주진행상태가 배정완료 이상 진행 되어 취소할 수 없습니다.")
		return;
	} else
	{
		var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
		
		var sPopupId  = "cancel_popup";
		var sUrl      = "SO::SO001_P14.xfdl";
		var oArg      = {soNo : soNo};
		var sCallBack = "fn_popupCallback_cancel";
		var oOption   = {title : "주문 취소"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	}
};

// 주문취소 팝업 callback
this.fn_popupCallback_cancel = function(sPopId, sRtn)
{
	var objRtn = JSON.parse(sRtn);
	
	var workNm = "발주 취소";
	
	this.fn_confirmDo(objRtn, workNm);
}

this.fn_confirmDo = function (objRtn, workNm)
{
	var talkFlag = objRtn.SEND_TALK_FLAG;
	var faxFlag = objRtn.SEND_FAX_FLAG;
	var callFlag = objRtn.SEND_AUTO_CALL;
	var fBranchG = objRtn.F_BRANCH_GROUP;
	var fbpCd = objRtn.F_BP_CD;
	var fbpNm = objRtn.F_BP_NM;
	var fReason = objRtn.F_REASON;
	var mBranchG = objRtn.M_BRANCH_GROUP;
	var mbpCd = objRtn.M_BP_CD;
	var mbpNm = objRtn.M_BP_NM;
	var mReason = objRtn.M_REASON;
	var faxMgNo = objRtn.MG_NO;
	var bugoFlag = objRtn.SEND_BUGO_TALK_FLAG;
		
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var sujuDiv = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	
	if (!this.gfn_isNull(fbpCd))
	{
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","po_cancel");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",fBranchG);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA2",fbpCd);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA3",fReason);
	}
	
	if (!this.gfn_isNull(mbpCd))
	{
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","po_cancel");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",mBranchG);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA2",mbpCd);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA3",mReason);
	}
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","temp_cd");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","");
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","prsn_type");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","");
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","log_program_id");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","so007ma1_ko843");
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","log_usr_id");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",regUser);
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","so_no");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",soNo);
	
	this.ds_param.addRow();
	this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","log_work_nm");
	this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",workNm);
	
	if (talkFlag == "1")
	{
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","send_talk_flag");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","y");
	}
	
	this.ds_bugoflag.clearData();
	if (bugoFlag == "1")
	{
		this.ds_bugoflag.addRow();
		this.ds_bugoflag.setColumn(this.ds_bugoflag.rowposition,"SO_NO",soNo);
		this.ds_bugoflag.setColumn(this.ds_bugoflag.rowposition,"BUGO_FLAG","y");
	}
	
	if (faxFlag == "1")
	{		
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","send_fax_flag");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","y");
		
		this.ds_list_2.filter("BRANCH_GROUP=='F'");
		var faxNo = "";
		var poBpCd = "";
		var poBpCd_temp = "";
		
 		for (var i=0; i < this.ds_list_2.rowcount; i++)
 		{
 			faxNo = this.ds_list_2.getColumn(i,"FAX_NO");
			poBpCd = this.ds_list_2.getColumn(i,"PO_BP_CD");
			if (poBpCd != "" &&  poBpCd != poBpCd_temp)
			{
				sleep(100);
				this.ds_param.addRow();
				this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","fax_data");
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","02-504-2144");
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA2",faxNo);
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA3",faxMgNo + "_" + i);
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA4","f");
				this.ds_param.setColumn(this.ds_param.rowposition,"DATA5",poBpCd);
				
				this.ds_faxChk.addRow();
				this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"CHK","Y");
				this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"FAX_SO_NO",faxMgNo + "_" + i);
				this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"PO_BP_CD",poBpCd);
				this.fn_faxDo(faxMgNo + "_" + i, soNo, poBpCd);
			}
		
			poBpCd_temp = poBpCd;
 		}
		
		this.ds_list_2.filter("");
		
// 		this.ds_param.addRow();
// 		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","fax_data");
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","02-504-2144");		
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA2",faxNo);
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA3",faxMgNo);
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA4","f");
// 		this.ds_param.setColumn(this.ds_param.rowposition,"DATA5",poBpCd);
// 
// 		this.ds_faxChk.addRow();
// 		this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"CHK","Y");
// 		this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"FAX_SO_NO",faxMgNo);
// 		this.ds_faxChk.setColumn(this.ds_faxChk.rowposition,"PO_BP_CD",poBpCd);
	}
	
	if (callFlag == "1")
	{
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","send_auto_call");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","y");
	}
	
	// 탁송체크
	if (sujuDiv == "STO")
	{
		this.ds_param.addRow();
		this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","so_seq");
		this.ds_param.setColumn(this.ds_param.rowposition,"DATA1","1");
	} else
	{
		for (var i=0; i < this.ds_list_2.rowcount; i++)
		{
			this.ds_param.addRow();
			this.ds_param.setColumn(this.ds_param.rowposition,"SO_NO",soNo);
			this.ds_param.setColumn(this.ds_param.rowposition,"DATA_TYPE","so_list");
			this.ds_param.setColumn(this.ds_param.rowposition,"DATA1",soNo);
			this.ds_param.setColumn(this.ds_param.rowposition,"DATA2",this.ds_list_2.getColumn(i,"SO_SEQ"));
			this.ds_param.setColumn(this.ds_param.rowposition,"DATA3",this.ds_list_2.getColumn(i,"PO_BP_CD"));
		}
	}
	
	
	
	this.fn_doChk(workNm);
	
};

this.fn_doChk = function (workNm)
{
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	//this.alert(workNm);
	var chk = "";
	if (workNm == "발주 확정")
	{
		chk = "fn_afterConfirm"
	} else
	{
		chk = "fn_afterCancel"
	}
	var id = "SO001_M03";
	var url = "svcUrl::SO001_M03";
	var inDs = "ds_param=ds_param:U";
	var outDs = "";
	var args = "INSRT_USER_ID="+regUser+"";
	var callBackid = chk;
	//var callBackid = "";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

// 발주확정 처리
this.fn_afterConfirm = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var message = "http://m.hyunjinsn.com/KO843_mobile/Module/MO/PCR.aspx?so_no="+soNo;
	
	// 의전 연락처
	this.ds_list_2.filter("BRANCH_GROUP=='M'")
	var hp = this.ds_list_2.getColumn(0,"TEL_NO2");
	this.ds_list_2.filter("");
	
	var id = "SO001_M04";
	var url = "svcUrl::SO001_M04";
	var inDs = "";
	var outDs = "ds_confirm_out=ds_confirm_out";
	var args = "WORK_TYPE='CONFIRM' SO_NO_IN="+soNo+" MSG_CD='' MSG_TEXT='' INSRT_USER_ID="+regUser+" MESSAGE='"+message+"' HP="+hp+"";
	var callBackid = "fn_afterConfirmDo";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
}

// 확정여부 체크
this.fn_afterConfirmDo = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M09";
	var url = "svcUrl::SO001_M09";
	var inDs = "";
	var outDs = "ds_confirmChk=ds_list";
	var args = "SO_NO="+soNo+"";
	var callBackid = "fn_afterConfirmDo2";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
}

// 확정일자 넣기
this.fn_afterConfirmDo2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	if (this.ds_confirmChk.getColumn(0,"PO_STATUS") == "0")
	{
		this.alert("발주 확정 실패 하였습니다. 다시 시도하시기 바랍니다.");
		return;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	
	var id = "SO001_M08";
	var url = "svcUrl::SO001_M08";
	var inDs = "";
	var outDs = "";
	var args = "WORK_TYPE='CONFIRM' SO_NO_IN="+soNo+" INSRT_USER_ID="+regUser+"";
	var callBackid = "fn_afterConfirmDo3";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 부고문자서비스
this.fn_afterConfirmDo3 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_bugoflag.getColumn(this.ds_bugoflag.rowposition,"SO_NO");
	var bugoFlag = this.ds_bugoflag.getColumn(this.ds_bugoflag.rowposition,"BUGO_FLAG");
	
//	var args1 = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
//	var backid = ""
	
// 	// 현대자동차_조사 고객사 장례지원 일자별 문자서비스로 이동
// 	if (args1 == "A6426" || args1 == "A6427" || args1 == "A6428" || args1 == "A6429" || args1 == "A6430" || args1 == "A6431" || args1 == "A6432" || args1 == "A6433")
// 	{
// 		// 현대자동차 장례지원 일자별 문자 서비스
// 		backid = "fn_afterConfirmDo_hyundai"
// 	} else
// 	{
// 		// mrp 저장 처리
// 		backid = "fn_afterConfirmDo4"
// 	}
// 	

	// 장례지원 일자별 문자서비스로 이동
	var id = "SO001_M11";
	var url = "svcUrl::SO001_M11";
	var inDs = "";
	var outDs = "";
	var args = "SO_NO="+soNo+" BUGO_FLAG ="+bugoFlag+"";
	var callBackid = "fn_afterConfirmDo_hyundai";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	
}

// 장례지원 일자별 문자 서비스 주문 확정시
this.fn_afterConfirmDo_hyundai = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M12";
	var url = "svcUrl::SO001_M12";
	var inDs = "";
	var outDs = "";
	var args = "SO_NO="+soNo+"";
	var callBackid = "fn_afterConfirmDo4";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	
}

// mrp 저장 처리
this.fn_afterConfirmDo4 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M07";
	var url = "svcUrl::SO001_M07";
	var inDs = "";
	var outDs = "";
	var args = "WORK_TYPE='CONFIRM' SO_NO_IN="+soNo+"";
	var callBackid = "fn_mpsMrpSave";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	
}


this.fn_mpsMrpSave = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	// MMS 발송대상 거래처 조회
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	
	var id = "SO001_S15";
	var url = "svcUrl::SO001_S15";
	var inDs = "";
	var outDs = "ds_bp_mms=ds_list";
	var args = "BP_CD="+bpCd+"";
	var callBackid = "fn_afterBpMmsSnd";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_afterBpMmsSnd = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	//trace(this.ds_bp_mms.rowcount);
	
	if (this.ds_bp_mms.rowcount > 0)
	{
		var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
		//hp = "010-8733-0709";
		var hp2 = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
		var message = this.ds_bp_mms.getColumn(0,"REMARK2");
		var mgNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
		var prgmId = "SO001_BP_MMS";
		var sndNum = "16000113";
		
		// MMS 발송대상 거래처 문자발송
		var id = "FM003_M01";
		var url = "svcUrl::FM003_M01";
		var inDs = "";
		var outDs = "";
		var args = "INSRT_USER_ID="+regUser+" MG_NO="+mgNo+" HP="+hp2+" MESSAGE='"+message+"' PRGM_ID="+prgmId+" SND_NUM="+sndNum+"";
		var callBackid = "fn_afterbpmms";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		// B2B 사전상담 연결 시 의전 MMS 발송
		//의전 연락처
		this.ds_list_2.filter("CHK == '1' && BRANCH_GROUP=='M'")
		var args3 = this.ds_list_2.getColumn(0,"TEL_NO2");
		this.ds_list_2.filter("");
		
// 		trace(this.gfn_isNull(this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD19")))
// 		trace(this.gfn_isNull(args3))
		
		if (this.gfn_isNull(this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD19")) || this.gfn_isNull(args3))
		{
			this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
		
			this.alert("주문 확정 되었습니다.");
			
			this.flaOrder();
		} else
		{
			var args1 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD19");
			var args2 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD20");
			
			var id = "SO001_M10";
			var url = "svcUrl::SO001_M10";
			var inDs = "";
			var outDs = "";
			var args = "MMS_SN="+args1+" MMS_SEQ="+args2+" HP="+args3+"";
			var callBackid = "fn_aftermmsImgsnd";
				
			this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
		}	
	}
}

this.fn_afterbpmms = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	//trace("111")
	// B2B 사전상담 연결 시 의전 MMS 발송
	//의전 연락처
	this.ds_list_2.filter("CHK == '1' && BRANCH_GROUP=='M'")
	var args3 = this.ds_list_2.getColumn(0,"TEL_NO2");
	this.ds_list_2.filter("");
	
	if (this.gfn_isNull(this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD19")) || this.gfn_isNull(args3))
	{
		this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
	
		this.alert("주문 확정 되었습니다.");
		
		this.flaOrder();
	} else
	{
		var args1 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD19");
		var args2 = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD20");
		
		var id = "SO001_M10";
		var url = "svcUrl::SO001_M10";
		var inDs = "";
		var outDs = "";
		var args = "MMS_SN="+args1+" MMS_SEQ="+args2+" HP="+args3+"";
		var callBackid = "fn_aftermmsImgsnd";
			
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	}
}

this.fn_aftermmsImgsnd = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	//trace("222")
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
	
	this.alert("주문 확정 되었습니다.");
	
	this.flaOrder();
}

// 발주취소
this.fn_afterCancel = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var message = "http://m.hyunjinsn.com/KO843_mobile/Module/MO/PCR.aspx?so_no="+soNo;
	
	// 의전 연락처
	this.ds_list_2.filter("BRANCH_GROUP=='M'")
	var hp = this.ds_list_2.getColumn(0,"TEL_NO2");
	this.ds_list_2.filter("");
	
	var id = "SO001_M04";
	var url = "svcUrl::SO001_M04";
	var inDs = "";
	var outDs = "ds_confirm_out=ds_confirm_out";
	var args = "WORK_TYPE='CANCEL' SO_NO_IN="+soNo+" MSG_CD='' MSG_TEXT='' INSRT_USER_ID="+regUser+" MESSAGE='"+message+"' HP="+hp+"";
	var callBackid = "fn_afterCancelDo";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);	
}

this.fn_afterCancelDo = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_M07";
	var url = "svcUrl::SO001_M07";
	var inDs = "";
	var outDs = "";
	var args = "WORK_TYPE='CANCEL' SO_NO_IN="+soNo+"";
	var callBackid = "fn_mpsMrpCancel";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

this.fn_mpsMrpCancel = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
	
	this.alert("주문 확정 취소 되었습니다.");	
}


// 결제
this.Div02_Tab00_Tabpage5_btn_pay_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SAVE_CHK") == "N")
	{
		this.alert("저장 후 결제 하시기 바랍니다.");
		return;
	}
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE")))
	{
		this.alert("결제방법 선택 후 저장한 뒤 결제 하시기 바랍니다.");
		return;
	}
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"BILL_AMT")))
	{
		this.alert("결제 금액을 입력 바랍니다.");
		return;
	}
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"CARD_APP_NO")) && this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT2")))
	{
		this.alert("메모1을 입력 바랍니다.");
		return;
	}
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"CARD_APP_NO")) && this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT3")))
	{
		this.alert("메모2를 입력 바랍니다.");
		return;
	}
	
	if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT1") == "2")
	{
		this.alert("이미 결제 되었습니다.");
		return;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	if (this.gfn_isNull(soNo))
	{
		soNo = this.ds_list_out.getColumn(this.ds_list_out.rowposition,"SO_NO")
	}
	
	var id = "SO001_M05_00";
	var url = "svcUrl::SO001_M05_00";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_list_3=ds_list_3:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO="+soNo+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterpaychk";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

this.fn_afterpaychk = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}

	var paychk = this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.value;
	
	var paySum = 0;
	
	for (var i=0; i<this.ds_list_3.rowcount; i++)
	{
		if (this.ds_list_3.getColumn(i,"PAY_TYPE") == "C1" && this.ds_list_3.getColumn(i,"C1_TEXT1") == "2")
		{
			paySum = paySum + this.gfn_nvl(this.ds_list_3.getColumn(i,"BILL_AMT"),0);
		}
	}
	
	
// 	if (paySum > paychk)
// 	{
// 		this.alert("결제 대상금액을 초과할 수 없습니다.");
// 		return;
// 	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var seq = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SEQ");
	var payAmt = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"BILL_AMT");
	var netAmt = this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_01.value;
	var vatAmt = this.Div02.form.Tab00.Tabpage5.form.MaskEdit00_00_00.value;
	var cardNum = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT2");
	var ym = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT3");
	var ownNm = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var dt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyDt = dt.substr(0,4)+"-"+dt.substr(4,2)+"-"+dt.substr(6,2)+" "+this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_TIME")+":"+this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_MIN")
	
	var sPopupId  = "pay_popup";
	var sUrl      = "SO::SO001_P15.xfdl";
	var oArg      = {soNo : soNo, seq : seq, payAmt : payAmt, cardNum : cardNum, ym : ym, paySum : paySum, paychk : paychk, netAmt : netAmt, vatAmt : vatAmt, ownNm : ownNm, dlvyDt : dlvyDt};
	var sCallBack = "fn_popupCallback_pay";
	var oOption   = {title : "페이엣 결제"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
}

// 결제 팝업 callback
this.fn_popupCallback_pay = function(sPopId, sRtn)
{
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
}

// 카드결제 항목 추가
this.Div02_Tab00_Tabpage5_btn_addCard_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
// 	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 	{					
// 		this.alert("발주 확정 된 주문은 추가 할 수 없습니다.");
// 		return;
// 	}
	
	if (this.gfn_isNull(this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.value))
	{
		this.alert("결제 대상 금액이 없습니다. 확인하시기 바랍니다.");
		return;
	}
	
	this.ds_list_3.addRow();
	this.Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType00.set_index(0); // 통장입금 > 결제구분
	this.ds_list_3.setColumn(this.ds_list_3.rowposition,"SAVE_CHK","N");
	this.ds_list_3.setColumn(this.ds_list_3.rowposition,"RCPT_METH","2");
	this.ds_list_3.setColumn(this.ds_list_3.rowposition,"PAYMENT_TYPE","E");
};

// 카드결제 항목 삭제
this.Div02_Tab00_Tabpage5_btn_delCard_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
// 	if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
// 	{					
// 		this.alert("발주 확정 된 주문은 삭제 할 수 없습니다.");
// 		return;
// 	}
	
	this.ds_list_3.deleteRow(this.ds_list_3.rowposition);
};

// 결제상태 수동으로 변경 시 데이터 업데이트
this.Div02_Tab00_Tabpage5_Div00_Radio_dealType_onitemchanged = function(obj:nexacro.Radio,e:nexacro.ItemChangeEventInfo)
{
	this.ds_list_3.setColumn(this.ds_list_3.rowposition,"PAYMENT_TYPE","U");
};

// change Div
this.Div02_Tab00_Tabpage5_grd_list01_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	var chk = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE");
	
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO")))
	{
		this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(true);
	} else
	{
		this.Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00.set_enable(false);
	}
	this.fn_chgDiv(chk);
};

// change Div
this.ds_list_3_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if (e.col == 1)
	{
		var chk = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE");
		
		this.fn_chgDiv(chk);
	}
	
	if (e.columnid == "PAY_TYPE")
	{
		if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAY_TYPE") == "C2")
		{		
			// 과세 금액
			this.ds_list_2.filter("VAT_RATE=='10' && DEAL_TYPE=='B' && CHK=='1'");
			this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
			this.ds_list_2.filter("");
			
			// 비과세 금액
			this.ds_list_2.filter("VAT_RATE=='0' && DEAL_TYPE=='B' && CHK=='1'");
			this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_00.set_value(this.ds_list_2.getSum("NET_AMT")+this.ds_list_2.getSum("VAT_AMT"));
			this.ds_list_2.filter("");
			
			var netAmt = parseInt(this.gfn_nvl(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM1"),0));
			var payCost2 = parseInt(this.gfn_nvl(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM2"),0));
			var payCost = nexacro.round(netAmt/1.1,0);
			var payVat = netAmt - payCost;
			this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_01.set_value(payCost+payCost2);
			this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_00_00.set_value(payVat);
			this.ds_list_3.setColumn(this.ds_list_3.rowposition,"BILL_AMT",netAmt+payCost2);
		}
	}
	
	if (e.columnid == "C2_NUM1" || e.columnid == "C2_NUM2")
	{
		var netAmt = parseInt(this.gfn_nvl(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM1"),0));
		var payCost2 = parseInt(this.gfn_nvl(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM2"),0));
		var payCost = nexacro.round(netAmt/1.1,0);
		var payVat = netAmt - payCost;
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_01.set_value(payCost+payCost2);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_00_00.set_value(payVat);
		this.ds_list_3.setColumn(this.ds_list_3.rowposition,"BILL_AMT",netAmt+payCost2);
	}
};

this.fn_chgDiv = function (chk)
{
	if (chk == "C1")    				// 카드 결제
	{
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	} else if (chk == "C2")			// 통장 입금
	{
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	} else if (chk == "C3")			// 계산서 발행
	{
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	} else if (chk == "F1")			// 본사 지원
	{
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	} else if (chk == "F2")			// 의전 수금
	{
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(false);
	} else if (chk == "Z2")			// 조정 결제
	{
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_left(550);
		this.Div02.form.Tab00.Tabpage5.form.Div00.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div02.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div03.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div04.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div05.set_visible(true);
	}
};

// 결제 취소
this.Div02_Tab00_Tabpage5_Div00_btn_payCancel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C1_TEXT1") == "3")
	{
		this.alert("이미 결제 취소 되었습니다.");
		return;
	}
	
	if (this.confirm("결제 취소 하시겠습니까?"))
	{
		var access_token = "a0ba43224a2048027aeb4734a851bdcbc0d70350569d66a16cdf6aaec6800f72";
		var store_screen_name = "69hyunjin";
		var employee_screen_name = "69hyunjin";
		var order_no = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO");
		
		var id = "SO001_P15_CARD_CANCEL";
		var url = "svcUrl::SO001_P15_CARD_CANCEL";
		var inDs = "";
		var outDs = "ds_return=ds_list";
		var args = "access_token="+access_token+" store_screen_name="+store_screen_name+" employee_screen_name="+employee_screen_name+" order_no="+order_no+"";
		var callBackid = "fn_afterPayCancel";
		
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	}	
};

//결제 취소 콜백
this.fn_afterPayCancel = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	if (this.ds_return.getColumn(this.ds_return.rowposition,"code") == "200")
	{
		var orderNo = this.ds_return.getColumn(this.ds_return.rowposition,"ORDER_NO");
		var uuid = this.ds_return.getColumn(this.ds_return.rowposition,"UUID");
		var soNo = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SO_NO");
		var seq = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SEQ");
		
		var id = "SO001_P15_CARD_CANCEL_CALLBACK";
		var url = "svcUrl::SO001_P15_CARD_CANCEL_CALLBACK";
		var inDs = "";
		var outDs = "";
		var args = "CANCEL_ORDER_NO="+orderNo+" so_no="+soNo+" UUID="+uuid+" seq="+seq+"";
		var callBackid = "fn_afterPayCancel2";		
		
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else
	{
		this.alert(this.ds_return.getColumn(this.ds_return.rowposition,"message"));
		return;
	}
}

this.fn_afterPayCancel2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	this.alert("정상적으로 취소 되었습니다.");
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
}

// 영수증 확인
this.Div02_Tab00_Tabpage5_Div00_btn_receipt_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"PAYAT_ORDER_NO")))
	{
		this.alert("카드 결제 된 내역이 없습니다.")
		return;
	}
	
	var uuid = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"UUID")
	
	var sPopupId  = "pay_popup";
	var sUrl      = "SO::SO001_P18.xfdl";
	var oArg      = {uuid : uuid};
	var sCallBack = "";
	var oOption   = {title : "페이엣 영수증"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 현금영수증 결제
this.Div02_Tab00_Tabpage5_Div01_btn_receiptPay_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SAVE_CHK") == "N")
	{
		this.alert("저장 후 결제 하시기 바랍니다.");
		return;
	}
	var rowposition = this.ds_list_3.rowposition;
	
	this.ds_list_3.filter("C2_TEXT9=='2'");
	var billAmt = this.ds_list_3.getSum("BILL_AMT");
	this.ds_list_3.filter("");
	
	this.ds_list_3.set_rowposition(rowposition);

	//trace(this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.value+">>"+this.ds_list_3.getSum("BILL_AMT"))
	if (this.Div02.form.Tab00.Tabpage5.form.MaskEdit00.value < billAmt)
	{
		this.alert("현금영수증 대상 금액이 결제 대상보다 큽니다 확인 하시기 바랍니다.");
		return;
	}
	
	if (!this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_APP_NO")) && this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_CANCEL_ORDER_NO")))
	{
		this.alert("이미 발행 되었습니다.");
		return;
	}
	
	if (!this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_APP_NO")) && !this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_CANCEL_ORDER_NO")))
	{
		this.alert("이미 발행 후 취소 되었습니다. 다시 발행하시려면 결제 항목리스트에 새로 추가 후 발행해주세요.");
		return;
	}

	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var id = "SO001_P15_S01";
	var url = "svcUrl::SO001_P15_S01";
	var inDs = "";
	var outDs = "ds_bp_nm=ds_bp_nm";
	var args = "SO_NO="+soNo+"";
	var callBackid = "fn_afterBpSearch";
	
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

this.fn_afterBpSearch = function (strSvcID, nErrorCode, strErrorMag)
{
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var access_token = "a0ba43224a2048027aeb4734a851bdcbc0d70350569d66a16cdf6aaec6800f72";
	var store_screen_name = "69hyunjin";
	var employee_screen_name = "69hyunjin";
	var type = "";
	if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_TEXT6") == "1")
	{
		type = "personal";
	} else if (this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_TEXT6") == "2")
	{
		type = "business";
	}
	var serial = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_TEXT7");
	var amount = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM3");
	var tax = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM4");;
	var fee = 0;
	
	var ownNm = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var bpNm = this.ds_bp_nm.getColumn(0,"BP_FULL_NM");
	var dte = this.gfn_getDate();
	var comment = "대상자 : " + ownNm + " 고객사 : " + bpNm + " " + dte.substr(0,4) + "-" + dte.substr(4,2) + "-" + dte.substr(6,2)

// 	if (this.gfn_isNull(tax))
// 	{
// 		tax = 0;
// 	}


	//return;
	var id = "SO001_P15_RECEIPT_CONFIRM";
	var url = "svcUrl::SO001_P15_RECEIPT_CONFIRM";
	var inDs = "";
	var outDs = "ds_receiptPayReturn=ds_list";
	var args = "access_token="+access_token+" store_screen_name="+store_screen_name+" employee_screen_name="+employee_screen_name+" type="+type+" serial="+serial+" amount="+amount+" tax="+tax+" fee="+fee+" comment='"+comment+"'";
	var callBackid = "fn_receiptPayReturn";
	
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 현금영수증 결제 콜백
this.fn_receiptPayReturn = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	//trace(this.ds_receiptPayReturn.saveXML())
	
	if (this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"code") == "200")
	{
		var soNo = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SO_NO");
		var seq = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SEQ");
		var app_no = this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"APPROVAL_NO");
		var orderNo = this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"ORDER_NO");
		var uuid = this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"UUID");
		var cost1 = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM1");
		var cost2 = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM2");
		var cost3 = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM3");
		var cost4 = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_NUM4");
		var cost5 = parseInt(cost3)+parseInt(cost4);
		
		var id = "SO001_P15_RECEIPT_CONFIRM_CALLBACK";
		var url = "svcUrl::SO001_P15_RECEIPT_CONFIRM_CALLBACK";
		var inDs = "";
		var outDs = "";
		var args = "APP_NO="+app_no+" ORDER_NO="+orderNo+" UUID="+uuid+" SO_NO="+soNo+" SEQ="+seq+" COST1="+cost1+" COST2="+cost2+" COST3="+cost3+" COST4="+cost4+" COST5="+cost5+"";
		var callBackid = "fn_afterReceiptCallback";		
		
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else if (this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"code") == "400")
	{
		this.alert(this.ds_receiptPayReturn.getColumn(this.ds_receiptPayReturn.rowposition,"message"));
		return;
	}
}

this.fn_afterReceiptCallback = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	this.alert("정상적으로 현금영수증 처리 되었습니다.");
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
}

// 현금영수증 취소
this.Div02_Tab00_Tabpage5_Div01_btn_receiptCancel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_APP_NO")))
	{
		this.alert("발행 이력이 없습니다.");
		return;
	}
	
	if (!this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_CANCEL_ORDER_NO")))
	{
		this.alert("이미 취소 되었습니다.");
		return;
	}
	
	var access_token = "a0ba43224a2048027aeb4734a851bdcbc0d70350569d66a16cdf6aaec6800f72";
	var store_screen_name = "69hyunjin";
	var employee_screen_name = "69hyunjin";
	var order_no = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_ORDER_NO");
	var reason = "1";
	
	var id = "SO001_P15_RECEIPT_CANCEL";
	var url = "svcUrl::SO001_P15_RECEIPT_CANCEL";
	var inDs = "";
	var outDs = "ds_receiptCancelReturn=ds_list";
	var args = "access_token="+access_token+" store_screen_name="+store_screen_name+" employee_screen_name="+employee_screen_name+" order_no="+order_no+" reason="+reason+"";
	var callBackid = "fn_receiptCancelReturn";
	
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

//현금영수증 취소 콜백
this.fn_receiptCancelReturn = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	if (this.ds_receiptCancelReturn.getColumn(this.ds_receiptCancelReturn.rowposition,"code") == "200")
	{
		var orderNo = this.ds_receiptCancelReturn.getColumn(this.ds_receiptCancelReturn.rowposition,"ORDER_NO");
		var uuid = this.ds_receiptCancelReturn.getColumn(this.ds_receiptCancelReturn.rowposition,"UUID");
		var soNo = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SO_NO");
		var seq = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"SEQ");
		
		var id = "SO001_P15_RECEIPT_CANCEL_CALLBACK";
		var url = "svcUrl::SO001_P15_RECEIPT_CANCEL_CALLBACK";
		var inDs = "";
		var outDs = "";
		var args = "ORDER_NO="+orderNo+" so_no="+soNo+" UUID="+uuid+" seq="+seq+"";
		var callBackid = "fn_afterReceiptCallback2";		
		
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
	} else if (this.ds_receiptCancelReturn.getColumn(this.ds_receiptCancelReturn.rowposition,"code") == "400")
	{
		this.alert(this.ds_receiptCancelReturn.getColumn(this.ds_receiptCancelReturn.rowposition,"message"));
		return;
	}
}

this.fn_afterReceiptCallback2 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag);
		return ;
	}
	
	this.fn_search(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"));
	
	this.alert("정상적으로 취소 되었습니다.");	
}

// 현금 영수증 확인
this.Div02_Tab00_Tabpage5_Div01_btn_search01_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list_3.getColumn(this.ds_list_3.rowposition,"C2_ORDER_NO")))
	{
		this.alert("발행 된 내역이 없습니다.")
		return;
	}
	
	var uuid = this.ds_list_3.getColumn(this.ds_list_3.rowposition,"RECEIPT_UUID")
	
	var sPopupId  = "pay_popup";
	var sUrl      = "SO::SO001_P18.xfdl";
	var oArg      = {uuid : uuid};
	var sCallBack = "";
	var oOption   = {title : "페이엣 영수증"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

// 미리보기
this.Div02_Tab00_Tabpage7_btn_report_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	this.ds_list_2.filter("CHK == '1' && BRANCH_GROUP=='F'")
	var poBpCd = this.ds_list_2.getColumn(0,"PO_BP_CD");
	this.ds_list_2.filter("");
	
	var sPopupId  = "pay_popup";
	var sUrl      = "SO::SO001_P16.xfdl";
	var oArg      = {soNo : soNo, poBpCd : poBpCd};
	var sCallBack = "";
	var oOption   = {title : "주문서"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	

// 	var str="";
//     str +="connection.servlet=http://182.162.91.62/OZReport/Server.aspx@@";
// 	 str +="connection.reportname=SO007MA1_KO843_2.ozr@@";
// 	  str +="information.debug=true@@";
// 	 //str +="viewer.isframe=false@@";
// 	 str +="viewer.namespace=UNIERP_64\\ozviewer@@";
// 	 //str +="viewer.mode=export@@"; // 미리보기 없이 바로 파일 변환으로 설정합니다.
// 	 str +="viewer.useprogressbar=false@@"; // 프로그레스 바를 감춥니다
// 	 str +="odi.odinames=SO007MA1_KO843_2";
// 	 str +="odi.SO007MA1_KO843_2.pcount=21";
// 
// 	 str +="odi.SO007MA1_KO843_2.args1=dbAliasName=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args2=DBLANG=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args3=AmtDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args4=QtyDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args5=UnitCostDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args6=ExchRateDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args7=AmtRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args8=QtyRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args9=UnitCostRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args10=ExchRateRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args11=Num1000=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args12=DateFormat=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args13=MonthFormat=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args14=ArrCur=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args15=ArrDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args16=ArrRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args17=ArrDefaultDec=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args18=gAlignOpt=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args19=UsrID=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args20=SP_ID=146@@";
// 	 str +="odi.SO007MA1_KO843_2.args21=PO_BP_CD=B1021@@";
// 		 //파일을 미리보기 없이 저장하는 방법
// 	 str +="export.mode=silent@@"; // 설정하는 창을 사용하지 않습니다.
// 	 str +="export.path=C:\\@@"; // 저장경로
// 	 str +="export.filename=test@@"; // 저장파일명
// 	 str +="export.format=pdf@@"; // 파일 형식
// 	 str +="export.confirmsave=false@@"; // 파일저장 확인 메시지를 사용안합니다.
// 	 this.Plugin00.callMethod("CreateReportEx",str,"@@");  //넥사크로에서 오즈뷰어 호출시에 callMethod 
};

this.fn_edtChg = function ()
{
	if (this.Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType00.index == 0)
	{
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static100.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_hp.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_left(482);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_top(189);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_left(587);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_top(193);
	} else if (this.Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType00.index == 1)
	{
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static100.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_hp.set_visible(false);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_visible(true);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_left(0);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.Static200.set_top(149);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_left(110);
		this.Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card.set_top(153);
	}
};


this.Div02_Tab00_Tabpage5_Div01_Radio_dealType00_onitemchanged = function(obj:nexacro.Radio,e:nexacro.ItemChangeEventInfo)
{
	this.fn_edtChg();
};

this.Div00_cmb_hsCd_oneditclick = function(obj:nexacro.Combo,e:nexacro.EditClickEventInfo)
{
	this.fn_hsSearch();
};

// 경조사유 변경
this.ds_list_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if (e.columnid == "HS_CD")
	{
		this.fn_bugochk();
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
		{
			if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
			{
				this.fn_itemDelete();
			} else
			{
				if (!this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD")))
				{
					if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
					{
						this.fn_itemDelete();
					}
				}				
			}
		}
	}
};

// 대상자 정보 복사
this.Div00_btn_reqSms00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.ds_list.setColumn(this.ds_list.rowposition,"REQ_NM",this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM"));
	this.ds_list.setColumn(this.ds_list.rowposition,"REQ_TEL_NO1",this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1"));
	this.ds_list.setColumn(this.ds_list.rowposition,"REQ_TEL_NO2",this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO2"));
};

// 주문 삭제
this.Div02_Tab00_Tabpage7_btn_DEL_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list_2.getColumn(0,"PO_STATUS") == "1")
	{					
		this.alert("발주 확정 된 주문은 삭제 할 수 없습니다.");
		return;
	}
		
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("주문 저장 후 확정 하시기 바랍니다.");
		return;
	} else if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"DEL_REASON")))
	{
		this.alert("주문 삭제 사유를 선택해 주세요");
		return;
	} else
	{
		if(this.confirm("삭제 하시겠습니까?")){
			var delReason = this.ds_list.getColumn(this.ds_list.rowposition,"DEL_REASON");
			this.ds_list.deleteRow(this.ds_list.rowposition);
			this.ds_list_2.deleteAll();
			
			var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
			
			var id = "SO001_D02";
			var url = "svcUrl::SO001_D02";
			var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U";
			var outDs = "";
			var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" DEL_REASON="+delReason+"";
			var callBackid = "fn_afterDelete";
				
			this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
			
			this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00.set_value("");
			this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_01.set_value("");
			this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_00_00.set_value("");
		}
	}
};

// 저장 callback
this.fn_afterDelete = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00.set_value("");
	this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_01.set_value("");
	this.Div02.form.Tab00.Tabpage7.form.Div00.form.MaskEdit00_00_00.set_value("");
	
	this.ds_list_2.clearData();
	this.ds_grd1.clearData();
	this.ds_grd2.clearData();
	this.ds_grd3.clearData();
	this.ds_grd4.clearData();
	this.ds_item_tip.clearData();
	this.ds_item_tip2.clearData();
	
	this.ds_bugochk.clearData();
	this.ds_bugoflag.clearData();
	
	this.Div00.form.edt_MOVE.set_value("");
	this.Div00.form.edt_BUGO.set_value("");
	this.Div00.form.edt_STATUS.set_value("");
	this.Div00.form.edt_BUGO.set_visible(false);
	this.Div00.form.edt_MOVE.set_visible(false);
	this.Div00.form.edt_STATUS.set_visible(false);
	this.Div00.form.Static19.set_cssclass("sta_WF_detailLabel")
	this.Div00.form.Static19_00.set_cssclass("sta_WF_detailLabel")
	this.Div00.form.edt_mRoomNo.set_background("#ffffff")
	this.Div00.form.cal_balinDt.set_background("#ffffff")
	
	this.alert("삭제 되었습니다.")
}

// 저장
this.fn_save2 = function ()
{
	this.ds_list_2.filter("")
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var netAmt = this.ds_list_2.getSum("NET_AMT");
	var vatAmt = this.ds_list_2.getSum("VAT_AMT");
	
	var id = "SO001_M01";
	var url = "svcUrl::SO001_M01";
	var inDs = "ds_list=ds_list:U";
	var outDs = "ds_list_out=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" NET_AMT="+netAmt+" VAT_AMT="+vatAmt+"";
	var callBackid = "fn_detailSave5";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 저장 callback
this.fn_detailSave5 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var dlvyCd = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var shipToParty = this.ds_list.getColumn(this.ds_list.rowposition,"SHIP_TO_PARTY");
	var soType = this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE");
	var dlvyDt = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	var dlvyAddr = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR_ERP");
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP");
	
	var id = "SO001_M05_00";
	var url = "svcUrl::SO001_M05_00";
	var inDs = "ds_list=ds_list:U ds_list_2=ds_list_2:U ds_list_3=ds_list_3:U ds_grd2=ds_grd2:U ds_grd3=ds_grd3:U ds_grd4=ds_grd4:U ds_memo=ds_memo:U ds_soAdd=ds_soAdd:U";
	var outDs = "ds_list=ds_list_out";
	var args = "INSRT_USER_ID="+regUser+" UPDT_USER_ID="+regUser+" PO_DLVY_CD="+dlvyCd+" SO_NO="+soNo+" SHIP_TO_PARTY="+shipToParty+" SO_TYPE="+soType+" DLVY_DT="+dlvyDt+" PO_DLVY_ADDR='"+dlvyAddr+"' PO_DLVY_NM='"+dlvyNm+"'";
	var callBackid = "fn_afterSave5";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
}

// 저장 callback
this.fn_afterSave5 = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}
	
	this.Div00.form.edt_STATUS.set_value("");
	this.Div00.form.edt_MOVE.set_value("");
	this.Div00.form.edt_BUGO.set_value("");
	
	this.ds_list_2.clearData();
	this.ds_grd1.clearData();
	this.ds_grd2.clearData();
	this.ds_grd3.clearData();
	this.ds_grd4.clearData();
	this.ds_item_tip.clearData();
	
	this.alert("삭제 되었습니다.");
}

this.fn_fax = function (faxMgNo)
{
	var sPopupId  = "fax_popup";
	var sUrl      = "SO::SO001_P21.xfdl";
	var oArg      = {};
	var sCallBack = "";
	var oOption   = {title : "팩스전송"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
};

this.Div01_edt_search_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	if (e.keycode == 13)
	{
		var search = this.Div01.form.edt_search.text;
		
		var filterstr = "";
		if(!this.gfn_isNull(search))
		{
			if(this.gfn_isNull(filterstr))
				filterstr = "TIP_DESC.indexOf('"+search+"')!='-1'";
			else
				filterstr += " && TIP_DESC.indexOf('"+search+"')!='-1'";				
		}
		
		this.ds_grd1.set_filterstr(filterstr);	
	}
};

//테스트
this.Div02_Tab00_Tabpage7_btn_test_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId  = "fax_popup";
	var sUrl      = "SO::SO001_P21.xfdl";
	var oArg      = {};
	var sCallBack = "";
	var oOption   = {title : "팩스전송"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);	
	
	//this.fn_faxInterface();

////////////////////////////////////////////////////로컬 pdf저장/////////////////////////////////////////////////

// 	// PARAM   SP_ID="146"    PO_BP_CD="B1021"
// 	//this.alert("123");
// 	var str="";
//     str +="connection.servlet=http://182.162.91.62/OZReport/Server.aspx@@";
// 	 str +="connection.reportname=SO007MA1_KO843_2.ozr@@";
// 	 str +="information.debug=true@@";
// 	 str +="viewer.namespace=UNIERP_64\\ozviewer@@";
// 	 str +="viewer.mode=export@@"; // 미리보기 없이 바로 파일 변환으로 설정합니다.
// 	 str +="viewer.useprogressbar=false@@"; // 프로그레스 바를 감춥니다
// 	 str +="odi.odinames=SO007MA1_KO843_2";
// 	 str +="odi.SO007MA1_KO843_2.pcount=21";
// 
// 	 str +="odi.SO007MA1_KO843_2.args1=dbAliasName=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args2=DBLANG=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args3=AmtDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args4=QtyDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args5=UnitCostDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args6=ExchRateDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args7=AmtRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args8=QtyRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args9=UnitCostRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args10=ExchRateRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args11=Num1000=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args12=DateFormat=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args13=MonthFormat=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args14=ArrCur=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args15=ArrDecPoint=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args16=ArrRndPolicy=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args17=ArrDefaultDec=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args18=gAlignOpt=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args19=UsrID=aaa@@";
// 	 str +="odi.SO007MA1_KO843_2.args20=SP_ID=146@@";
// 	 str +="odi.SO007MA1_KO843_2.args21=PO_BP_CD=B1021@@";
// 	 str +="pdf.fontembedding=true@@"; // 파일 형식
// 		 //파일을 미리보기 없이 저장하는 방법
// 	 str +="export.mode=silent@@"; // 설정하는 창을 사용하지 않습니다.
// 	 str +="export.path=C:\\hanafax\\file\\test\\@@"; // 저장경로
// 	 //str +="export.path=http:\\\182.162.91.66:8081\\web\\nui\\@@"; // 저장경로
// 	 str +="export.filename=test55@@"; // 저장파일명
// 	 str +="export.format=pdf@@"; // 파일 형식
// 	 str +="export.confirmsave=false@@"; // 파일저장 확인 메시지를 사용안합니다.
// 	 this.Plugin00.callMethod("CreateReportEx",str,"@@");  //넥사크로에서 오즈뷰어 호출시에 callMethod 
};

this.fn_faxInterface = function ()
{	
	//this.WebBrowser00.set_url("http://182.162.91.66/OZReport70/serverbind/serverbind.html");

// 	if(system.navigatorname == "nexacro"){ //runtime
// 		
// 		var str;
// 		
// 		str ='<html>'; 
// 		str +='<title>ServerExport';
// 		str +='</title>';
// 		str +='<head>';
// 		str +='<meta http-equiv="content-type" content="application/x-www-form-urlencoded; charset=UTF-8">';
// 		str +='</head>';
// 		str +='<body>';
// 		str +='<form id="postform" name="postform" action="http://182.162.91.66/OZReport70/serverbind/serverbind.aspx" method="post" accept-charset="utf-8">';
// 		
// 		str +='	<input type="hidden" id="filename" name="filename" value="sample.pdf"/>';
// 		str +='	<input type="hidden" id="reportname" name="connection.reportname" value="sample.ozr"/>';
// 		str +='</form>';
// 		str +='<script type="text/javascript">';
// 		str +='	document.title = "faxInterface";';
// 		str +='	document.postform.submit();';
// 		str +='</script>';
// 		str +='</body>';
// 		str +='</html>';
// 	
// 		this.WebBrowser00.getProperty("document").callMethod("Write", str);
// 		this.WebBrowser00.getProperty("document").callMethod("Close");	
// 		//return;
// 	}
};

/////////////////////////////////////// 파일 업로드 다운로드 /////////////////////////////////////////
this.FileDialog00_onclose = function(obj:nexacro.FileDialog,e:nexacro.FileDialogEventInfo)
{
	//trace(e.virtualfiles.length);
	
	for (var i = 0, len = e.virtualfiles.length, vFile; i < len; i++)
	{
		vFile = e.virtualfiles[i];
		
		this.FileUpTransfer00.addFile("file0"+i,vFile);
		
		vFile.addEventHandler("onsuccess", this.FileDialog_VirtualFile_onsuccess, this);
		vFile.addEventHandler("onerror", this.FileDialog_VirtualFile_onerror, this);
		vFile.open(null, 1);
		
		//this._vFiles.push(vFile);
	}

};

this.FileDialog_VirtualFile_onerror = function(obj, e)
{
	//trace( obj.name+"_"+e.eventid );
	//trace( "e.statuscode:"+e.statuscode );
}
this.FileDialog_VirtualFile_onsuccess = function(obj, e)
{
	//trace("FileDialog_VirtualFile_onsuccess init");
	var size_table = ["KB", "MB", "GB", "TB", "PB"];
	
	function cutFileSize(filesize, rate, count)
	{
		var ret = (filesize / (Math.pow(rate, count + 1))).toFixed(2);
		if (ret < rate)
		{
			if (size_table[count])
			{
				return ret + " " + size_table[count];
			}
			else
			{
				return filesize + " Byte";
			}
		}
		else
		{
			return cutFileSize(filesize, rate, ++count);
		}
	};


	if (e.reason == 1)
	{
		obj.getFileSize();
	}
	else if (e.reason == 9)
	{
		
		var d = new Date();
		
		var s;
	
		s = d.getFullYear() + ((d.getMonth() + 1) + "").padLeft(2, '0');

		var tmpStr = (new Date()).getTime();
		var tmpStr2 = (new Date()).getTime();
		var display_name = this.ds_SendDocList.getColumn(this.ds_SendDocList.rowposition,"PROJECT_NUM") + "_"+tmpStr
		//var docMgNo = this.ds_SendDocList.getColumn(this.ds_SendDocList.rowposition,"DOC_MG_NO");
		var docMgNo = this.ds_output.getColumn(0,0)

		this.ds_selectlist.setColumn(this.ds_selectlist.rowposition, "REAL_FILENAME", display_name);
		this.ds_selectlist.setColumn(this.ds_selectlist.rowposition, "FILENAME", obj.filename);
		this.ds_selectlist.setColumn(this.ds_selectlist.rowposition, "FILESIZE", cutFileSize(e.filesize, Math.pow(2, 10), 0));
		this.ds_selectlist.setColumn(this.ds_selectlist.rowposition, "LOADED", 0);
		this.ds_selectlist.setColumn(this.ds_selectlist.rowposition, "FILEPATH", "uploadFiles\\"+s+"\\"+this.ds_SendDocList.getColumn(this.ds_SendDocList.rowposition,"DOC_MG_NO")+"\\");
		
		this.fileSave();
	}
};

this.FileUpTransfer00_onerror = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferErrorEventInfo)
{
	//trace("11 " +obj.name+"_"+e.eventid );
	//trace(e.ErrorMsg);
	//trace(e.errorobj);
	this.alert("업로드에 실패했습니다.\r\n다시시도 부탁드립니다.");
};

this.FileUpTransfer00_onsuccess = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferEventinfo)
{
	//trace("2 " + obj.name+"_"+e.eventid );
	
	//this.fn_Save();
};

this.fileSave = function(){

	//trace(this.ds_fileinfo.saveXML());
	//trace(this.FileUpTransfer00.filelist.length);
	var real_filename = this.ds_selectlist.getColumn(this.ds_selectlist.rowposition,"REAL_FILENAME");
	var real_file_path = this.ds_selectlist.getColumn(this.ds_selectlist.rowposition,"FILEPATH");
	//trace(real_file_path);

	this.FileUpTransfer00.setPostData(
		"filename",
		""
	);

	this.FileUpTransfer00.setPostData(
		"filepath",
		"C:\\hanafax\\file\\test2\\"
	);
	
	this.FileUpTransfer00.upload("JSP::fileUpload_postdatatest.jsp?PATH22="+real_file_path);
}

// this.fileDownload = function(){
// //D:\pms\uploadFiles\201910\2019100013_1
// 	
// 	var file_path = this.ds_selectlist.getColumn(this.ds_selectlist.rowposition,"FILEPATH").replace(/\\/gi,"/");
// 	var file_name = this.ds_selectlist.getColumn(this.ds_selectlist.rowposition,"FILENAME");
// 	var r_file_name = this.ds_selectlist.getColumn(this.ds_selectlist.rowposition,"REAL_FILENAME");
// 	
// 	
// 	
// 	var file_url = "http://211.106.159.87:8080/"+file_path+r_file_name+file_name.substring(file_name.lastIndexOf("."));
// 	
// 	 this.FileDownTransfer00.set_downloadfilename( file_name ); 
// 	this.FileDownTransfer00.download(file_url);
// };

////////////////////////////////////////////// 유효성 체크 //////////////////////////////////////////////////////////
this.fn_valChk = function ()
{	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("주문번호가 없습니다. 저장 먼저 하시기 바랍니다.");
		return false;
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM")))
	{
		this.alert("성명(대상자)를 입력하시기 바랍니다.");
		return false;
	}
	
	if (this.ds_grd2.rowcount > 3)
	{
		this.alert("소속의 항목은 최대 3개까지만 표현되어야 합니다. 고객사를 다시 선택 후 진행 바랍니다.");
		return false;
	}
	
	//2021.01.15 다시 빼기로 함
// 	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"TITLE_NM")))
// 	{
// 		this.alert("호칭을 입력하시기 바랍니다.");
// 		return false;
// 	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"CUR") == "DEL")
	{
		this.alert("삭제된 주문은 발주 확정 할 수 없습니다.");
		return false;
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM")))
	{
		this.alert("성명(주문자)를 입력하시기 바랍니다.");
		return false;
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"HS_CD")))
	{
		this.alert("경조사유를 입력하시기 바랍니다.");
		return false;
	}
	
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_CD")))
	{
		this.alert("배송지를 입력하시기 바랍니다.");
		return false;
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") == "STO")
	{
		if (this.ds_list_2.rowcount > 1)
		{
			this.alert("탁송 주문 시 품목은 1개만 주문 넣을 수 있습니다. 확인 바랍니다.");
			return false;
		}
	}
	
// 	for (var i=0; i<this.ds_list_2.rowcount; i++)
// 	{
// 		var chk = this.ds_list_2.getColumn(i,"CHK");
// 		var bpCd = this.ds_list_2.getColumn(i,"PO_BP_CD");
// 		var bg = this.ds_list_2.getColumn(i,"BRANCH_GROUP");
// 		if (chk == "1")
// 		{			
// 			for (var j=this.ds_list_2.rowcount-1; i<j; j--)
// 			{
// 				var chk2 = this.ds_list_2.getColumn(j,"CHK");
// 				var bpCd2 = this.ds_list_2.getColumn(j,"PO_BP_CD");
// 				var bg2 = this.ds_list_2.getColumn(j,"BRANCH_GROUP");
// 				
// 				if (chk2 == "1")
// 				{
// 					if (bg == bg2 && bpCd != bpCd2)
// 					{
// 						this.alert("지점은 플라워지점, 의전지점 각각 한군데 지점만 등록 가능합니다. 확인 바랍니다.")
// 						return false;
// 					}
// 				}				
// 			}
// 		}		
//	}
	
	this.ds_grd3.filter("MANDATORY_YN=='Y'");
	if (this.ds_grd3.rowcount > 0)
	{
		for (i=0; i < this.ds_grd3.rowcount; i++)
		{
			if (this.gfn_isNull(this.ds_grd3.getColumn(i,"COL_VAL")))
			{
				this.alert("대상자 인적사항 "+this.ds_grd3.getColumn(i,"COL_NM")+"을 입력하시기 바랍니다.");
				return false;
			}
		}
	}
	this.ds_grd3.filter("");
	
	this.ds_grd4.filter("MANDATORY_YN=='Y'");
	if (this.ds_grd4.rowcount > 0)
	{
		for (i=0; i < this.ds_grd4.rowcount; i++)
		{
			if (this.gfn_isNull(this.ds_grd4.getColumn(i,"COL_VAL")))
			{
				this.alert("주문자 인적사항 "+this.ds_grd4.getColumn(i,"COL_NM")+"을 입력하시기 바랍니다.");
				return false;
			}
		}
	}
	this.ds_grd4.filter("");
	
	for (i=0; i < this.ds_list_2.rowcount; i++)
	{
		if ((this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"PAY_DIV") == "F" && this.gfn_isNull(this.ds_list_2.getColumn(i,"REASON"))) || (this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"PAY_DIV") == "F" && this.gfn_isNull(this.ds_list_2.getColumn(i,"ADD_CD1"))))
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 무상사유 및 요청자를 선택하시기 바랍니다.");
			return false;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"SO_QTY")) || this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"SO_QTY") == "0")
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 수량을 입력하시기 바랍니다.");
			return false;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"ITEM_CD")))
		{
			this.alert("품목을 선택하시기 바랍니다.");
			return false;
		}
		
		if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"PO_BP_CD")))
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 지점을 선택하시기 바랍니다.");
			return false;
		}
		
		if (this.ds_list_2.getColumn(i,"PO_BP_CD") == "B2033")
		{
			this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 지점 변경이 필요합니다. 확인 바랍니다.");
			return false;
		}
	}
	
	this.ds_list_2.filter("CHK == '1' && RIBBON_CHK=='Y'")
	if (this.ds_list_2.rowcount > 0)
	{
		for (i=0; i < this.ds_list_2.rowcount; i++)
		{
			if (this.gfn_isNull(this.ds_list_2.getColumn(i,"RIBBON_MESSAGE")))
			{
				this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 리본메시지를 입력하시기 바랍니다.");
				this.ds_list_2.filter("")
				return false;
			}
		}
	}
	this.ds_list_2.filter("")
	
	this.ds_list_2.filter("CHK == '1' && INV_CHK=='Y'")
	if (this.ds_list_2.rowcount > 0)
	{
		for (i=0; i < this.ds_list_2.rowcount; i++)
		{
			if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.gfn_isNull(this.ds_list_2.getColumn(i,"TS_BP_CD")))
			{
				this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 상차지점을 선택하시기 바랍니다.");
				this.ds_list_2.filter("")
				return false;
			}
			
			if (this.ds_list_2.getColumn(i,"CHK") == 1 && this.ds_list_2.getColumn(i,"MOVE_YN") != "Y")
			{
				this.alert(this.ds_list_2.getColumn(i,"ITEM_NM")+"에 대한 탁송주문을 먼저 확정하시기 바랍니다.");
				this.ds_list_2.filter("")
				return false;
			}
		}
	}
	this.ds_list_2.filter("")
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SO_TYPE") != "STO" && !this.gfn_isNull(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")))
	{					
		this.alert("탁송주문" +this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_NO_ORI")+ " 이 존재합니다. 탁송주문 삭제 후 발주확정 하시기 바랍니다.");
		return false;
	}
	
	if (this.ds_list_2.rowcount < 1)
	{
		this.alert("상품이 없습니다. 상품 조회 및 저장 후 확정하시기 바랍니다.")
		return false;
	}
	
	this.ds_list_2.filter("CHK == '1'")
	if (this.ds_list_2.rowcount == 1)
	{
		if (this.ds_list_2.getColumn(0,"ITEM_CD").substr(0,3) == "A01")
		{
			this.alert("배송품목을 등록 후 저장하세요. 배송금액은 상품팁을 확인하세요")
			this.ds_list_2.filter("")
			return false;
		}
	}
	this.ds_list_2.filter("")
};

// 팩스 테스트 성공
this.Div02_Tab00_Tabpage7_Button00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var id = "SO001_M07";
	var url = "svcUrl::SO001_M07";
	var inDs = "";
	var outDs = "";
	var args = "WORK_TYPE="+"CONFIRM"+" SO_NO_IN="+"202007060284"+"";
	var callBackid = "fn_mrpTest";
		
	this.gfn_transaction( id, url, inDs, outDs, args, callBackid);
};

this.fn_faxDo = function (faxSono, soNo, poBpCd)
{

	var fileNm = faxSono+".pdf"
	if(system.navigatorname == "nexacro"){ //runtime
		
		var str;
		
		str ='<html>'; 
		str +='<title>ServerExport';
		str +='</title>';
		str +='<head>';
		str +='<meta http-equiv="content-type" content="application/x-www-form-urlencoded; charset=UTF-8">';
		str +='</head>';
		str +='<body>';
		str +='<form id="postform" name="postform" action="http://182.162.91.66/OZReport70/serverbind/serverbind.aspx" method="post" accept-charset="utf-8">';
		
		//str +='	<input type="hidden" id="filename" name="filename" value="sample123.pdf"/>';
		str +='	<input type="hidden" id="filename" name="filename" value="'+fileNm+'"/>';
		str +='	<input type="hidden" id="reportname" name="connection.reportname" value="SO001.ozr"/>';
		
		str +=' <input type="hidden" id="pcount" name="pcount" value="2"/>';
		str +=' <input type="hidden" id="args1" name="args1" value="SO_NO='+soNo+'"/>';
		str +=' <input type="hidden" id="args2" name="args2" value="PO_BP_CD='+poBpCd+'"/>';
		 
		str +='</form>';
		str +='<script type="text/javascript">';
		str +='	document.title = "faxInterface";';
		str +='	document.postform.submit();';
		str +='</script>';
		str +='</body>';
		str +='</html>';

		this.WebBrowser00.getProperty("document").callMethod("Write", str);
		this.WebBrowser00.getProperty("document").callMethod("Close");	
	}
};

// 특정 거래처 발주금액 수정 가능하게 풀기
this.fn_poPrice1 = function (currow)
{
// 	var poBpCd = this.ds_list_2.getColumn(currow,"PO_BP_CD");
// 	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
// 	
// 	if (poBpCd == "B2005" || poBpCd == "B2009" || poBpCd == "B2004" || poBpCd == "B2006")
// 	{
// 		return "maskeditcontrol";
// 	} else if (this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO") == "CO1802007" && regUser == "212003")
// 	{
// 		return "maskeditcontrol";
// 	} else
// 	{
// 		return "mask";
// 	} 

	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (poStatus == "0")
	{
		return "maskeditcontrol";
	} else
	{
		return "mask";
	} 
};

// 특정 거래처 발주금액 수정 가능하게 풀기
this.fn_poPrice2 = function (currow)
{
// 	var poBpCd = this.ds_list_2.getColumn(currow,"PO_BP_CD");
// 	var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
// 	
// 	if (poBpCd == "B2005" || poBpCd == "B2009" || poBpCd == "B2004" || poBpCd == "B2006")
// 	{
// 		return "mask";
// 	} else if (this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO") == "CO1802007" && regUser == "212003")
// 	{
// 		return "mask";
// 	} else
// 	{
// 		return "none";
// 	}
	
	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (poStatus == "0")
	{
		return "mask";
	} else
	{
		return "none";
	} 
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto1 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		return "buttoncontrol";
	} else
	{
		return "nomal";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto2 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		return "button";
	} else
	{
		return "none";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto3 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		return "탁송";
	} else
	{
		return "";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto4 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"MOVE_YN") == "Y")
		{
			return "mask";
		} else
		{
			return "maskeditcontrol";
		}	
	} else if (poStatus == "0")
	{
		return "maskeditcontrol";
	} else
	{
		return "mask";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto5 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"MOVE_YN") == "Y")
		{
			return "none";
		} else
		{
			return "text";
		}	
	} else if (poStatus == "0")
	{
		return "text";
	} else
	{
		return "none";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto6 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"MOVE_YN") == "Y")
		{
			return "nomal";
		} else
		{
			return "editcontrol";
		}	
	} else if (poStatus == "0")
	{
		return "editcontrol";
	} else
	{
		return "nomal";
	}
};

// 특정 아이템 탁송 가능하게 풀기
this.fn_sto7 = function (currow)
{
	var item = this.ds_list_2.getColumn(currow,"ITEM_CD");
	var poStatus = this.ds_list_2.getColumn(currow,"PO_STATUS");
	
	if (item.substr(0,3) == "A01" || item.substr(0,3) == "C03" || item.substr(0,3) == "C04" || item == "B2001061" || item == "B2001131" || item == "B3101010" || item == "C1200010")
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"MOVE_YN") == "Y")
		{
			return "none";
		} else
		{
			return "text";
		}		
	} else if (poStatus == "0")
	{
		return "text";
	} else
	{
		return "none";
	}
};

// 소속 색상변경
this.fn_subType = function (currow)
{
	var subType = this.ds_grd2.getColumn(currow,"SUB_TYPE_NM");
	
	if (subType != "*")
	{
		return "status9";
	}
};

// 대상자 인적사항 색상변경
this.fn_dept1 = function (currow)
{
	var yn = this.ds_grd3.getColumn(currow,"MANDATORY_YN");
	
	if (yn == "Y")
	{
		return "status9";
	}
};

// 주문자 인적사항 색상변경
this.fn_dept2 = function (currow)
{
	var yn = this.ds_grd4.getColumn(currow,"MANDATORY_YN");
	
	if (yn == "Y")
	{
		return "status9";
	}
};

// 주문팁 COPY & PASTE
this.Div01_grd_list01_onkeydown = function(obj:nexacro.Grid,e:nexacro.KeyEventInfo)
{
	this.gfn_grdCopy_Paste(obj, e);
};

// 법인개인 가능하게 풀기
this.fn_deal1 = function (currow)
{
	var reguser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var depcCd = this.objApp.gds_login_info.getColumn(0,"DEPT_CD");
	var updtDiv = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"UPDT_DIV");
	var status = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS");
	
	if (reguser == "210001" || depcCd == "H1430")
	{
		return "combocontrol";
	} else
	{
		if (updtDiv == "2" && status == "0")
		{
			return "combocontrol";
		} else
		{
			return "combotext";
		}
	} 
};

// 법인개인 가능하게 풀기
this.fn_deal2 = function (currow)
{
	var reguser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
	var depcCd = this.objApp.gds_login_info.getColumn(0,"DEPT_CD");
	var updtDiv = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"UPDT_DIV");
	var status = this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS");
	
	if (reguser == "210001" || depcCd == "H1430")
	{
		return "combo";
	} else
	{
		if (updtDiv == "2" && status == "0")
		{
			return "combo";
		} else
		{
			return "none";
		}
	} 
};

// 체크된 것만 합계 금액 내기
this.fn_sumPrice = function ()
{
	var sumPrice = 0;
	for (var i=0; i< this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"CHK") == "1")
		{
			sumPrice += (parseInt(this.ds_list_2.getColumn(i,"NET_AMT"))+parseInt(this.ds_list_2.getColumn(i,"VAT_AMT")))
		}
	}	
	return sumPrice;
};

// 체크된 것만 공급가액 합계 금액 내기
this.fn_sumNet = function ()
{
	var netAmt = 0;
	for (var i=0; i< this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"CHK") == "1")
		{
			netAmt += (parseInt(this.ds_list_2.getColumn(i,"NET_AMT")))
		}
	}	
	return netAmt;
};

// 체크된 것만 부가세 합계 금액 내기
this.fn_sumVat = function ()
{
	var vatAmt = 0;
	for (var i=0; i< this.ds_list_2.rowcount; i++)
	{
		if (this.ds_list_2.getColumn(i,"CHK") == "1")
		{
			vatAmt += (parseInt(this.ds_list_2.getColumn(i,"VAT_AMT")))
		}
	}	
	return vatAmt;
};

// 사전상담 팝업
this.Div00_btn_sono00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	
	var preNo = this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD1");
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
		
	if (!this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("저장 된 주문은 사전상담을 선택할 수 없습니다.");
		return;
	}
	
	if (this.gfn_isNull(bpCd))
	{
		this.alert("고객사를 선택하시기 바랍니다.")
		return;
	}
	
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6213")
	{
		var sPopupId  = "preInfo_popup";
		var sUrl      = "FM::FM001_P01.xfdl";
		var oArg      = {mode : "update", preNo : preNo};
		var sCallBack = "fn_popupCallback_preInfo";
		var oOption   = {title : "사전상담 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	} else
	{
		var sPopupId  = "preInfo_popup";
		var sUrl      = "FM::FM006_P01.xfdl";
		var oArg      = {mode : "update", preNo : preNo, bpCd : bpCd};
		var sCallBack = "fn_popupCallback_preInfo2";
		var oOption   = {title : "사전상담 정보"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}	
};

// 사전상담 팝업 callback
this.fn_popupCallback_preInfo = function(sPopId, sRtn)
{
    // json textarea 엔터값 변환
 	sRtn = sRtn.replace(/\n/gi,"\\r\\n");
// 	trace(sRtn)
    var objRtn = JSON.parse(sRtn);
	
	var preNo = objRtn.PRE_RCPT_NO;
	
	if (this.ds_soAdd.rowcount == 0)
	{
		this.ds_soAdd.addRow();
	}
	
	// 사전상담 접수번호
	this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD1",preNo);
	//trace(objRtn.OWN_NM);
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",this.gfn_isNullRtn(objRtn.DLVY_CD,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",this.gfn_isNullRtn(objRtn.FUNERAL_HALL,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",this.gfn_isNullRtn(objRtn.REGION_SIDO,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"REQ_NM",this.gfn_isNullRtn(objRtn.CUST_NM,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"REQ_TEL_NO1",this.gfn_isNullRtn(objRtn.CUST_TEL,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",this.gfn_isNullRtn(objRtn.CUST_NM,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"OWN_TEL_NO1",this.gfn_isNullRtn(objRtn.CUST_TEL,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"M_NAME",this.gfn_isNullRtn(objRtn.OWN_NM,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD",this.gfn_isNullRtn(objRtn.OWN_REL,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"M_ROOM_NO",this.gfn_isNullRtn(objRtn.SERVICE_ITEM,""));
	//this.ds_list.setColumn(this.ds_list.rowposition,"M_MEMO",this.gfn_isNullRtn(objRtn.PO_BP_CD,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"C_MEMO",this.gfn_isNullRtn(objRtn.MSG_MEMO,""));
	this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",this.gfn_isNullRtn(objRtn.DLVY_CHANGE_DT.substring(0,8),""));
}

// 사전상담 팝업 callback
this.fn_popupCallback_preInfo2 = function(sPopId, sRtn)
{
    var objRtn = JSON.parse(sRtn);

	var preNo = objRtn.PRE_RCPT_NO;
	
	if (this.ds_soAdd.rowcount == 0)
	{
		this.ds_soAdd.addRow();
	}
	
	if (this.gfn_isNull(this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD1")))
	{
		// 사전상담 접수번호
		this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD1",preNo);
		// 문자 발송여부
		this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD19",this.gfn_isNullRtn(objRtn.MMS_SN,""));
		this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD20",this.gfn_isNullRtn(objRtn.MMS_SEQ,""));

		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",this.gfn_isNullRtn(objRtn.DLVY_CD,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",this.gfn_isNullRtn(objRtn.FUNERAL_HALL,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",this.gfn_isNullRtn(objRtn.REGION_SIDO,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",this.gfn_isNullRtn(objRtn.CUST_NM,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"OWN_TEL_NO1",this.gfn_isNullRtn(objRtn.CUST_TEL,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"M_NAME",this.gfn_isNullRtn(objRtn.OWN_NM,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD",this.gfn_isNullRtn(objRtn.OWN_REL,""));
		this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",this.gfn_isNullRtn(objRtn.DLVY_CHANGE_DT.substring(0,8),""));
		
		if (objRtn.SUB_CODE1 != "|")
		{
			this.ds_grd2.setColumn(0,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE1,""));
		}
		
		if (objRtn.SUB_CODE2 != "|")
		{
			this.ds_grd2.setColumn(1,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE2,""));
		}
		
		if (objRtn.SUB_CODE3 != "|")
		{
			this.ds_grd2.setColumn(2,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE3,""));
		}
		
		this.fn_hsSearch();
		
		this.fn_itemDelete2();
	} else
	{
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") == "1")
		{
			this.alert("확정 된 주문은 사전상담을 변경할 수 없습니다.");
			return;
		} else
		{
			if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
			{
				// 사전상담 접수번호
				this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD1",preNo);

				this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",this.gfn_isNullRtn(objRtn.DLVY_CD,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",this.gfn_isNullRtn(objRtn.FUNERAL_HALL,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",this.gfn_isNullRtn(objRtn.REGION_SIDO,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",this.gfn_isNullRtn(objRtn.CUST_NM,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"OWN_TEL_NO1",this.gfn_isNullRtn(objRtn.CUST_TEL,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"M_NAME",this.gfn_isNullRtn(objRtn.OWN_NM,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD",this.gfn_isNullRtn(objRtn.OWN_REL,""));
				this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",this.gfn_isNullRtn(objRtn.DLVY_CHANGE_DT.substring(0,8),""));
				
				if (objRtn.SUB_CODE1 != "|")
				{
					this.ds_grd2.setColumn(0,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE1,""));
				}
				
				if (objRtn.SUB_CODE2 != "|")
				{
					this.ds_grd2.setColumn(1,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE2,""));
				}
				
				if (objRtn.SUB_CODE3 != "|")
				{
					this.ds_grd2.setColumn(2,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE3,""));
				}
				
				this.fn_itemDelete2();
			} else
			{
				if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
				{
					// 표준 / 예외 표준으로 두기
					this.Div02.form.Tab00.Tabpage1.form.Radio00.set_index(0);
					
					// 사전상담 접수번호
					this.ds_soAdd.setColumn(this.ds_soAdd.rowposition,"ADD_CD1",preNo);

					this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CD",this.gfn_isNullRtn(objRtn.DLVY_CD,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_NM",this.gfn_isNullRtn(objRtn.FUNERAL_HALL,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_ADDR",this.gfn_isNullRtn(objRtn.REGION_SIDO,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"OWN_NM",this.gfn_isNullRtn(objRtn.CUST_NM,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"OWN_TEL_NO1",this.gfn_isNullRtn(objRtn.CUST_TEL,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"M_NAME",this.gfn_isNullRtn(objRtn.OWN_NM,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"HS_CD",this.gfn_isNullRtn(objRtn.OWN_REL,""));
					this.ds_list.setColumn(this.ds_list.rowposition,"DLVY_CHANGE_DT",this.gfn_isNullRtn(objRtn.DLVY_CHANGE_DT.substring(0,8),""));
					
					if (objRtn.SUB_CODE1 != "|")
					{
						this.ds_grd2.setColumn(0,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE1,""));
					}
					
					if (objRtn.SUB_CODE2 != "|")
					{
						this.ds_grd2.setColumn(1,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE2,""));
					}
					
					if (objRtn.SUB_CODE3 != "|")
					{
						this.ds_grd2.setColumn(2,"SUB_CODE",this.gfn_isNullRtn(objRtn.SUB_CODE3,""));
					}
			
					this.fn_itemDelete2();
				}
			}
		}
	}
}

// 상품정보 복사기능
this.Div02_Tab00_Tabpage1_grd_list01_onkeydown = function(obj:nexacro.Grid,e:nexacro.KeyEventInfo)
{
	this.gfn_grdCopy_Paste(obj, e);
};

// 계약 팝업
this.Div00_btn_contInfo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	var contNo = this.ds_list.getColumn(this.ds_list.rowposition,"CONT_NO");
	
	if (this.gfn_isNull(contNo))
	{
		this.alert("계약 번호가 없습니다. 고객사를 선택하세요");
		return;
	}
	
	var sPopupId  = "contInfo_popup";
	var sUrl      = "SO::SO001_P23.xfdl";
	var oArg      = {contNo : contNo};
	var sCallBack = "fn_popupCallback_contInfo";
	var oOption   = {title : "계약 정보"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 꽃잠 매뉴얼
this.Div00_btn_manual_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6213")
	{
		system.execBrowser("https://bit.ly/ggotjam-ubase");
	} else if (this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6244" || this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY") == "A6267")
	{
		var sPopupId  = "sinwoori_popup";
		var sUrl      = "SO::SO001_P26.xfdl";
		var oArg      = {};
		var sCallBack = "fn_popupCallback_contInfo";
		var oOption   = {title : "신우리 추천상품"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
};

// 편의용품 알림
this.Div00_btn_reqSms00_00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("주문 저장 후 편의용품 안내 문자 발송할 수 있습니다.")
		return;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var reqNm = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM");
	var ownNm = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var ownHp = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
	var reqHp = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO1");
	var bpNm = this.ds_list.getColumn(this.ds_list.rowposition,"BP_NM");
	var hsNm = this.Div00.form.cmb_hsCd.text;
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
	
	this.ds_list_2.filter("BRANCH_GROUP=='M'")
	var telNo2 = this.ds_list_2.getColumn(0,"TEL_NO2");
	this.ds_list_2.filter("");
	
	if (reqNm != ownNm && !this.gfn_isNull(telNo2))
	{
		var sPopupId  = "mms5_popup";
		var sUrl      = "SO::SO001_P24.xfdl";
		var oArg      = {soNo : soNo, ownNm : ownNm, ownHp : ownHp, telNo2 : telNo2, bpNm : bpNm, hsNm : hsNm, dlvyNm : dlvyNm};
		var sCallBack = "fn_popupCallback_mmsInfo5";
		var oOption   = {title : "편의용품 안내 문자발송"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	} else
	{
		var sPopupId  = "mms5_popup";
		var sUrl      = "SO::SO001_P24.xfdl";
		var oArg      = {soNo : soNo, reqNm : reqNm, reqHp : reqHp};
		var sCallBack = "fn_popupCallback_mmsInfo5";
		var oOption   = {title : "편의용품 안내 문자발송"};
		this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	}
};

this.Div02_Tab00_Tabpage7_Div00_btn_sinwooriSms_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
	{
		this.alert("주문 저장 후 플라워지점에 신우리주문 안내 문자 발송할 수 있습니다.")
		return;
	}
	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	var reqNm = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM");
	var ownNm = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var ownHp = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
	var reqHp = this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO1");
	var bpNm = this.ds_list.getColumn(this.ds_list.rowposition,"BP_NM");
	var hsNm = this.Div00.form.cmb_hsCd.text;
	var dlvyNm = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM");
	
	this.ds_list_2.filter("BRANCH_GROUP=='F'")
	var poBpCd = this.ds_list_2.getColumn(0,"PO_BP_CD");
	this.ds_list_2.filter("");
	
	if (this.gfn_isNull(poBpCd))
	{
		this.alert("신우리몰 주문 안내문자는 플라워지점에만 발송 됩니다.");
		return;
	}
	
	var sPopupId  = "mms6_popup";
	var sUrl      = "SO::SO001_P25.xfdl";
	var oArg      = {soNo : soNo, poBpCd : poBpCd, ownNm : ownNm, ownHp : ownHp, bpNm : bpNm, hsNm : hsNm, dlvyNm : dlvyNm, reqNm : reqNm, reqHp : reqHp};
	var sCallBack = "fn_popupCallback_mmsInfo6";
	var oOption   = {title : "플라워지점 신우리주문 안내 문자발송"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};

// 유형 변경
this.ds_soAdd_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if (e.columnid == "ADD_CD4")
	{
		//trace(e.oldvalue);
		var oldValue = e.oldvalue;
		if (this.ds_list_2.getColumn(this.ds_list_2.rowposition,"PO_STATUS") != "1")
		{
			if (this.gfn_isNull(this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO")))
			{
				this.fn_itemDelete();
			} else
			{
				if (!this.gfn_isNull(this.ds_soAdd.getColumn(this.ds_soAdd.rowposition,"ADD_CD4")))
				{
					if(this.confirm("저장된 데이터는 삭제되고 상품정보가 재조회 됩니다. 재조회 하시겠습니까?"))
					{
						this.fn_itemDelete();
					} else
					{
						this.ds_soAdd.setColumn(e.row,"ADD_CD4",oldValue);
						return;
					}
				}				
			}
		}
	}
};

// 이장개장 상담등록 팝업
this.Div00_btn_manual00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var sPopupId  = "mms6_popup";
	var sUrl      = "SO::SO001_P30.xfdl";
	var oArg      = {};
	var sCallBack = "";
	var oOption   = {title : "이장개장 접수등록"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};


// 단품몰 SMS
this.Div02_Tab00_Tabpage1_btn_mall_refresh_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");

	if(T_SO_NO == null){		
		var id = "SO010_MALL_T_SO_NO";
		var url = "svcUrl::SO010_MALL_T_SO_NO";
		var inDs = "";
		var outDs = "ds_tSoNo=ds_list";
		var args = "TYPE=T_SO_NO";
		var callBackid = "";
		
		this.gfn_transaction( id, url, inDs, outDs, args, callBackid, false);	
		T_SO_NO = this.ds_tSoNo.getColumn(0,"T_SO_NO")		
	}
	
	var hp = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
	var user = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var sPopupId  = "sms_popup";
	var sUrl      = "SO::SO010_MALL_SMS.xfdl";
	var oArg      = {user : user, hp : hp, soNo : soNo, T_SO_NO : T_SO_NO, bpCd : bpCd};
	var sCallBack = "";
	var oOption   = {title : "대상자 SMS"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
	
};

this.Div00_Radio_dealType_onitemchanged = function(obj:nexacro.Radio,e:nexacro.ItemChangeEventInfo)
{
	this.fn_bugochk();
};

this.flaOrder = function ()
{
	this.ds_list_2.filter("PO_BP_CD == 'B2039'")
	if (this.ds_list_2.rowcount > 0)
	{
		for (i=0; i < this.ds_list_2.rowcount; i++)
		{
			var orderDate = this.ds_list.getColumn(this.ds_list.rowposition,"ORDER_DT");
			orderDate = String(orderDate);
			var formattedDate = orderDate.substring(0, 4) + "-" +       // 연
								orderDate.substring(4, 6) + "-" +       // 월
								orderDate.substring(6, 8) + " " +       // 일
								orderDate.substring(8, 10) + ":" +      // 시
								orderDate.substring(10, 12) + ":" +     // 분
								orderDate.substring(12, 14);            // 초
			var dlvyDate = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
			dlvyDate = String(dlvyDate);
			var formattedDate2 = dlvyDate.substring(0, 4) + "-" +       // 연
								 dlvyDate.substring(4, 6) + "-" +       // 월
								 dlvyDate.substring(6, 8);       		// 일
			var ribbon = this.gfn_nvl(this.ds_list_2.getColumn(i, "RIBBON_MESSAGE"), "");
    
			// " / " 기준으로 split
			var ribbonParts = ribbon.split(" / ");
			var ribbonLeft = ribbonParts[0] || "";   // " / " 앞부분, 없으면 빈 문자열
			var ribbonRight = ribbonParts[1] || "";  // " / " 뒷부분, 없으면 빈 문자열	
						
			var soNo = this.ds_list_2.getColumn(i,"SO_NO");                  										// !! SO 번호
			var soSeq = this.ds_list_2.getColumn(i,"SO_SEQ");                                                   	// !! SO 시퀀스
			var order_number = soNo+"_"+soSeq;                              										// !! 주문번호
			var order_time = formattedDate;                       													// !! 주문시간
			var orderer_name = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM"),"");          // !! 주문자명
			var orderer_phone = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO1"),"");    // !! 주문자 핸드폰
			var orderer_email = "";                       															// 주문자 이메일
			var orderer_tel = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO2"),"");                             // 주문자 전화번호
			var receiver_name = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM"),"");         // !! 받는사람 이름
			var receiver_phone = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1"),"");   // !! 받는사람 핸드폰
			var receiver_tel = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO2"),"");                            // 받는사람 전화번호
			var payment_date = "";                        															// 결제시간
			var total_amount = 0;                                        											// 상품금액(할인 전 판매가)
			var pay_amount = 0;                              														// 소비자가(최종판매가)
			var supply_amount = this.gfn_nvl(this.ds_list_2.getColumn(i,"PO_AMT"),0);                               // !!공급금액(플라시스템 공급가)
			var point_amount = 0;                                         											// 포인트 금액
			var delivery_post = "";                                    												// 우편번호
			var delivery_address = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"M_ROOM_NO"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"M_NAME"),""); // !! 배송주소
			var delivery_date = formattedDate2;                         // !! 배송날짜
			var delivery_time = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_TIME"),"00")+":"+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_MIN"),"00")+":00";                                  // !! 배송시간
			var delivery_card = this.gfn_nvl(this.ds_list_2.getColumn(i,"CARD_MESSAGE"),"");                        // 카드메시지
			var delivery_ribbon_right = ribbonLeft;              													// 리본문구(오른쪽)
			var delivery_ribbon_left = ribbonRight;                     												// 리본문구(왼쪽)
			var order_memo = "현진시닝:"+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"F_MEMO"),"");                                 													// 관리자메모
			var goods_name = this.ds_list_2.getColumn(i,"ITEM_NM_ENG")+" / "+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"F_MEMO"),"")+" / "+this.gfn_nvl(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY"),"")+"개";                           						// !! 상품명
			var goods_url = "";                																		// !! 상품이미지
			var insrt_user_id = this.ds_list.getColumn(this.ds_list.rowposition,"INSRT_USER_ID");               	// !! 접수자
			var goods_code = this.gfn_nvl(this.ds_list_2.getColumn(i,"FLA_ITEM_CD"),"");                            // !! 플라시스템 코드

			if(system.navigatorname == "nexacro"){ //runtime
				
				var str;
				
				str ='<html>'; 
				str +='<title>flaSystem';
				str +='</title>';
				str +='<head>';
				str +='<meta charset=UTF-8">';
				str +='</head>';
				str +='<body>';
				str +='<form id="postform" name="postform" action="https://crm.ehyunjin.com:8081/API_FLA_ORDR" method="post" accept-charset="utf-8">';
				
				str += '	<input type="hidden" id="soNo" name="soNo" value="' + soNo + '">';
				str += '	<input type="hidden" id="soSeq" name="soSeq" value="' + soSeq + '">';
				str += '	<input type="hidden" id="order_number" name="order_number" value="' + order_number + '">';
				str += '	<input type="hidden" id="order_time" name="order_time" value="' + order_time + '">';
				str += '	<input type="hidden" id="orderer_name" name="orderer_name" value="' + orderer_name + '">';
				str += '	<input type="hidden" id="orderer_phone" name="orderer_phone" value="' + orderer_phone + '">';
				str += '	<input type="hidden" id="orderer_email" name="orderer_email" value="' + orderer_email + '">';
				str += '	<input type="hidden" id="orderer_tel" name="orderer_tel" value="' + orderer_tel + '">';
				str += '	<input type="hidden" id="receiver_name" name="receiver_name" value="' + receiver_name + '">';
				str += '	<input type="hidden" id="receiver_phone" name="receiver_phone" value="' + receiver_phone + '">';
				str += '	<input type="hidden" id="receiver_tel" name="receiver_tel" value="' + receiver_tel + '">';
				str += '	<input type="hidden" id="payment_date" name="payment_date" value="' + payment_date + '">';
				str += '	<input type="hidden" id="total_amount" name="total_amount" value="' + total_amount + '">';
				str += '	<input type="hidden" id="pay_amount" name="pay_amount" value="' + pay_amount + '">';
				str += '	<input type="hidden" id="supply_amount" name="supply_amount" value="' + supply_amount + '">';
				str += '	<input type="hidden" id="point_amount" name="point_amount" value="' + point_amount + '">';
				str += '	<input type="hidden" id="delivery_post" name="delivery_post" value="' + delivery_post + '">';
				str += '	<input type="hidden" id="delivery_address" name="delivery_address" value="' + delivery_address + '">';
				str += '	<input type="hidden" id="delivery_date" name="delivery_date" value="' + delivery_date + '">';
				str += '	<input type="hidden" id="delivery_time" name="delivery_time" value="' + delivery_time + '">';
				str += '	<input type="hidden" id="delivery_card" name="delivery_card" value="' + delivery_card + '">';
				str += '	<input type="hidden" id="delivery_ribbon_right" name="delivery_ribbon_right" value="' + delivery_ribbon_right + '">';
				str += '	<input type="hidden" id="delivery_ribbon_left" name="delivery_ribbon_left" value="' + delivery_ribbon_left + '">';
				str += '	<input type="hidden" id="order_memo" name="order_memo" value="' + order_memo + '">';
				str += '	<input type="hidden" id="goods_name" name="goods_name" value="' + goods_name + '">';
				str += '	<input type="hidden" id="goods_url" name="goods_url" value="' + goods_url + '">';
				str += '	<input type="hidden" id="insrt_user_id" name="insrt_user_id" value="' + insrt_user_id + '">';
				str += '	<input type="hidden" id="goods_code" name="goods_code" value="' + goods_code + '">';
				//str += '	<input type="hidden" id="goods_options" name="goods_options" value=\'' + goods_options + '\'>'; // JSON 문자열로 전송
				 
				str +='</form>';
				str +='<script type="text/javascript">';
				str +='	document.postform.submit();';
				str +='</script>';
				str +='</body>';
				str +='</html>';	
			
				this.WebBrowser00_00.getProperty("document").callMethod("Write", str);
				this.WebBrowser00_00.getProperty("document").callMethod("Close");	
				
				this.alert(soNo+"_"+soSeq+" 주문이 플라시스템으로 발주요청 되었습니다. 조회버튼을 클릭하여 플라시스템 주문번호가 생성되었는지 확인 바랍니다.");
			}
		}
	}
	this.ds_list_2.filter("")	
};

// 성공 처리 이벤트 핸들러
this.WebBrowser00_00_onusernotify = function(obj:nexacro.WebBrowser,e:nexacro.WebUserNotifyEventInfo)
{
	trace(e.userdata); // 서버 응답 로그 출력

//     try {
//         // 응답 데이터를 JSON으로 파싱 시도
//         var responseData = JSON.parse(e.userdata);
//         // 응답 데이터에 따라 특정 작업 수행
//         // 예시로 'status' 필드를 기준으로 성공/실패 처리
// 		
//         if(responseData.code === "200") {
//             trace("API 호출이 성공적으로 완료되었습니다.\n주문 ID: " + responseData.od_id);
//             // 추가적인 성공 처리 로직
//         } else {
//             trace("API 호출 실패: " + responseData.code);
//             // 추가적인 실패 처리 로직
//         }
//     } catch (error) {
//         // JSON 파싱 실패 시, 원본 응답을 문자열로 처리
//         if(e.userdata.startsWith("error:")) {
//             trace("JSON 데이터 전송 실패: " + e.userdata);
//         } else if(e.userdata.startsWith("exception:")) {
//             trace("JSON 데이터 전송 중 예외 발생: " + e.userdata);
//         } else {
//             trace("알 수 없는 응답: " + e.userdata);
//         }
// 	}
};

this.Div02_Tab00_Tabpage8_grd_list03_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	var odId = this.ds_list_2.getColumn(e.row,"ADD_CD2");
	var soSeq = this.ds_list_2.getColumn(e.row,"SO_SEQ");
	var orderDate = this.ds_list.getColumn(this.ds_list.rowposition,"ORDER_DT");
	orderDate = String(orderDate);
	var formattedDate = orderDate.substring(0, 4) + "-" +       // 연
						orderDate.substring(4, 6) + "-" +       // 월
						orderDate.substring(6, 8) + " " +       // 일
						orderDate.substring(8, 10) + ":" +      // 시
						orderDate.substring(10, 12) + ":" +     // 분
						orderDate.substring(12, 14);            // 초
	var dlvyDate = this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_DT");
	dlvyDate = String(dlvyDate);
	var formattedDate2 = dlvyDate.substring(0, 4) + "-" +       // 연
						 dlvyDate.substring(4, 6) + "-" +       // 월
						 dlvyDate.substring(6, 8);       		// 일
	var ribbon = this.gfn_nvl(this.ds_list_2.getColumn(e.row, "RIBBON_MESSAGE"), "");
    
    // " / " 기준으로 split
    var ribbonParts = ribbon.split(" / ");
    var ribbonLeft = ribbonParts[0] || "";   // " / " 앞부분, 없으면 빈 문자열
    var ribbonRight = ribbonParts[1] || "";  // " / " 뒷부분, 없으면 빈 문자열				 
	
	

	if (e.col == 11)
	{		
		if (this.gfn_isNull(soSeq))
		{
			this.alert("저장 먼저 진행해주시기 바랍니다.");
			return;
		}
		
		if (this.gfn_isNull(odId))
		{
			var soNo = this.ds_list_2.getColumn(e.row,"SO_NO");                  									// !! SO 번호
			//var soSeq = this.ds_list_2.getColumn(e.row,"SO_SEQ");                                                 // !! SO 시퀀스
			var order_number = soNo+"_"+soSeq;                              										// !! 주문번호
			var order_time = formattedDate;                       													// !! 주문시간
			var orderer_name = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_NM"),"");          // !! 주문자명
			var orderer_phone = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO1"),"");    // !! 주문자 핸드폰
			var orderer_email = "";                       															// 주문자 이메일
			var orderer_tel = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"REQ_TEL_NO2"),"");                         // 주문자 전화번호
			var receiver_name = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM"),"");         // !! 받는사람 이름
			var receiver_phone = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1"),"");   // !! 받는사람 핸드폰
			var receiver_tel = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO2"),"");                        // 받는사람 전화번호
			var payment_date = "";                        															// 결제시간
			var total_amount = 0;                                        											// 상품금액(할인 전 판매가)
			var pay_amount = 0;                              														// 소비자가(최종판매가)
			var supply_amount = this.gfn_nvl(this.ds_list_2.getColumn(e.row,"PO_AMT"),0);                           // !!공급금액(플라시스템 공급가)
			var point_amount = 0;                                         											// 포인트 금액
			var delivery_post = "";                                    												// 우편번호
			var delivery_address = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_ADDR"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_NM_ERP"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"M_ROOM_NO"),"")+' '+ this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"M_NAME"),""); // !! 배송주소
			var delivery_date = formattedDate2;                         // !! 배송날짜
			var delivery_time = this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_TIME"),"00")+":"+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"DLVY_MIN"),"00")+":00";                                  // !! 배송시간
			var delivery_card = this.gfn_nvl(this.ds_list_2.getColumn(e.row,"CARD_MESSAGE"),"");                    // 카드메시지
			var delivery_ribbon_right = ribbonLeft;          														// 리본문구(오른쪽)
			var delivery_ribbon_left = ribbonRight;                     												// 리본문구(왼쪽)
			var order_memo = "현진시닝:"+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"F_MEMO"),"");                                 													// 관리자메모
			var goods_name = this.ds_list_2.getColumn(e.row,"ITEM_NM_ENG")+" / "+this.gfn_nvl(this.ds_list.getColumn(this.ds_list.rowposition,"F_MEMO"),"")+" / "+this.gfn_nvl(this.ds_list_2.getColumn(this.ds_list_2.rowposition,"SO_QTY"),"")+"개";                           					// !! 상품명
			var goods_url = "";                																		// !! 상품이미지
			var insrt_user_id = this.ds_list.getColumn(this.ds_list.rowposition,"INSRT_USER_ID");               	// !! 접수자
			var goods_code = this.gfn_nvl(this.ds_list_2.getColumn(e.row,"FLA_ITEM_CD"),"");                        // !! 플라시스템 코드

			if(system.navigatorname == "nexacro"){ //runtime
				
				var str;
				
				str ='<html>'; 
				str +='<title>flaSystem';
				str +='</title>';
				str +='<head>';
				str +='<meta charset=UTF-8">';
				str +='</head>';
				str +='<body>';
				str +='<form id="postform" name="postform" action="https://crm.ehyunjin.com:8081/API_FLA_ORDR" method="post" accept-charset="utf-8">';
				//str +='<form id="postform" name="postform" action="http://10.36.170.229:8060/API_FLA_ORDR" method="post" accept-charset="utf-8">';
				
				str += '	<input type="hidden" id="soNo" name="soNo" value="' + soNo + '">';
				str += '	<input type="hidden" id="soSeq" name="soSeq" value="' + soSeq + '">';
				str += '	<input type="hidden" id="order_number" name="order_number" value="' + order_number + '">';
				str += '	<input type="hidden" id="order_time" name="order_time" value="' + order_time + '">';
				str += '	<input type="hidden" id="orderer_name" name="orderer_name" value="' + orderer_name + '">';
				str += '	<input type="hidden" id="orderer_phone" name="orderer_phone" value="' + orderer_phone + '">';
				str += '	<input type="hidden" id="orderer_email" name="orderer_email" value="' + orderer_email + '">';
				str += '	<input type="hidden" id="orderer_tel" name="orderer_tel" value="' + orderer_tel + '">';
				str += '	<input type="hidden" id="receiver_name" name="receiver_name" value="' + receiver_name + '">';
				str += '	<input type="hidden" id="receiver_phone" name="receiver_phone" value="' + receiver_phone + '">';
				str += '	<input type="hidden" id="receiver_tel" name="receiver_tel" value="' + receiver_tel + '">';
				str += '	<input type="hidden" id="payment_date" name="payment_date" value="' + payment_date + '">';
				str += '	<input type="hidden" id="total_amount" name="total_amount" value="' + total_amount + '">';
				str += '	<input type="hidden" id="pay_amount" name="pay_amount" value="' + pay_amount + '">';
				str += '	<input type="hidden" id="supply_amount" name="supply_amount" value="' + supply_amount + '">';
				str += '	<input type="hidden" id="point_amount" name="point_amount" value="' + point_amount + '">';
				str += '	<input type="hidden" id="delivery_post" name="delivery_post" value="' + delivery_post + '">';
				str += '	<input type="hidden" id="delivery_address" name="delivery_address" value="' + delivery_address + '">';
				str += '	<input type="hidden" id="delivery_date" name="delivery_date" value="' + delivery_date + '">';
				str += '	<input type="hidden" id="delivery_time" name="delivery_time" value="' + delivery_time + '">';
				str += '	<input type="hidden" id="delivery_card" name="delivery_card" value="' + delivery_card + '">';
				str += '	<input type="hidden" id="delivery_ribbon_right" name="delivery_ribbon_right" value="' + delivery_ribbon_right + '">';
				str += '	<input type="hidden" id="delivery_ribbon_left" name="delivery_ribbon_left" value="' + delivery_ribbon_left + '">';
				str += '	<input type="hidden" id="order_memo" name="order_memo" value="' + order_memo + '">';
				str += '	<input type="hidden" id="goods_name" name="goods_name" value="' + goods_name + '">';
				str += '	<input type="hidden" id="goods_url" name="goods_url" value="' + goods_url + '">';
				str += '	<input type="hidden" id="insrt_user_id" name="insrt_user_id" value="' + insrt_user_id + '">';
				str += '	<input type="hidden" id="goods_code" name="goods_code" value="' + goods_code + '">';
				//str += '	<input type="hidden" id="goods_options" name="goods_options" value=\'' + goods_options + '\'>'; // JSON 문자열로 전송
				 
				str +='</form>';
				str +='<script type="text/javascript">';
				str +='	document.postform.submit();';
				str +='</script>';
				str +='</body>';
				str +='</html>';	
			
				this.WebBrowser00_00.getProperty("document").callMethod("Write", str);
				this.WebBrowser00_00.getProperty("document").callMethod("Close");	
				
				this.alert(soNo+"_"+soSeq+" 주문이 플라시스템으로 발주요청 되었습니다. 조회버튼을 클릭하여 플라시스템 주문번호가 생성되었는지 확인 바랍니다.");
				
				this.fn_search(soNo);
			}
		} else
		{
			this.alert("이미 발주 되었습니다.");
			return;
		}		
	} else if (e.col == 12)
	{
		if (this.gfn_isNull(odId))
		{
			this.alert("발주를 먼저 진행하세요.");
			return;
		} else
		{
			if (this.confirm("플라시스템 발주를 취소하시겠습니까?"))
			{
				var soNo = this.ds_list_2.getColumn(e.row,"SO_NO"); 
				var soSeq = this.ds_list_2.getColumn(e.row,"SO_SEQ");
				var addCd2 = this.ds_list_2.getColumn(e.row,"ADD_CD2");
				var regUser = this.objApp.gds_login_info.getColumn(0,"USR_ID");
				
				var id = "SO010_FLA_CANCEL";
				var url = "svcUrl::SO010_FLA_CANCEL";
				var inDs = "";
				var outDs = "";
				var args = "SO_NO="+soNo+" SO_SEQ="+soSeq+" INSRT_USER_ID="+regUser+" ADD_CD2="+addCd2+"";
				var callBackid = "fn_fla_cancel";
				
				this.gfn_transaction( id, url, inDs, outDs, args, callBackid, false);	
			}			
		}		
	} else if (e.col == 13)	
	{
		var odId = this.ds_list_2.getColumn(e.row,"ADD_CD2");
	
		var id = "SO010_P40";
		var url = "svcUrl::SO010_P40";
		var inDs = "";
		var outDs = "ds_fla_img=ds_list";
		var args = "OD_ID="+odId+"";
		var callBackid = "fn_fla_image";

		this.gfn_transaction( id, url, inDs, outDs, args, callBackid, false);
	}
};

this.fn_fla_image = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}		
	var before = this.ds_fla_img.getColumn(0,"BEFORE");
	var after = this.ds_fla_img.getColumn(0,"AFTER");
	var receipt = this.ds_fla_img.getColumn(0,"RECEIPT");
	
	system.execShell( before );
	system.execShell( after );
	system.execShell( receipt );	
}

this.fn_fla_cancel = function (strSvcID, nErrorCode, strErrorMag) {
	if (nErrorCode < 0) 
	{
		this.alert(strErrorMag)
		return ;
	}	
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO"); 
	this.fn_search(soNo);
}
this.Div02_Tab00_Tabpage1_btn_PKG_refresh_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var bpCd = this.ds_list.getColumn(this.ds_list.rowposition,"SOLD_TO_PARTY");
	var hp = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_TEL_NO1");
	var user = this.ds_list.getColumn(this.ds_list.rowposition,"OWN_NM");
	var soNo = this.ds_list.getColumn(this.ds_list.rowposition,"SO_NO");
	
	var sPopupId  = "sms_popup";
	var sUrl      = "SO::SO010_PKG_SMS.xfdl";
	var oArg      = {user : user, hp : hp, soNo : soNo, T_SO_NO : T_SO_NO, bpCd : bpCd};
	var sCallBack = "";
	var oOption   = {title : "PKG 대상자 SMS"};
	this.gfn_openPopup(sPopupId, sUrl, oArg, sCallBack, oOption);
};


function sleep(ms) {
  const wakeUpTime = Date.now() + ms;
  while (Date.now() < wakeUpTime) {}
}]]></Script>
    <Objects>
      <Dataset id="ds_time">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">00</Col>
            <Col id="NAME">00</Col>
          </Row>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="NAME">01</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="NAME">02</Col>
          </Row>
          <Row>
            <Col id="CODE">03</Col>
            <Col id="NAME">03</Col>
          </Row>
          <Row>
            <Col id="CODE">04</Col>
            <Col id="NAME">04</Col>
          </Row>
          <Row>
            <Col id="CODE">05</Col>
            <Col id="NAME">05</Col>
          </Row>
          <Row>
            <Col id="CODE">06</Col>
            <Col id="NAME">06</Col>
          </Row>
          <Row>
            <Col id="CODE">07</Col>
            <Col id="NAME">07</Col>
          </Row>
          <Row>
            <Col id="CODE">08</Col>
            <Col id="NAME">08</Col>
          </Row>
          <Row>
            <Col id="CODE">09</Col>
            <Col id="NAME">09</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="NAME">10</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="NAME">11</Col>
          </Row>
          <Row>
            <Col id="CODE">12</Col>
            <Col id="NAME">12</Col>
          </Row>
          <Row>
            <Col id="CODE">13</Col>
            <Col id="NAME">13</Col>
          </Row>
          <Row>
            <Col id="CODE">14</Col>
            <Col id="NAME">14</Col>
          </Row>
          <Row>
            <Col id="CODE">15</Col>
            <Col id="NAME">15</Col>
          </Row>
          <Row>
            <Col id="CODE">16</Col>
            <Col id="NAME">16</Col>
          </Row>
          <Row>
            <Col id="CODE">17</Col>
            <Col id="NAME">17</Col>
          </Row>
          <Row>
            <Col id="CODE">18</Col>
            <Col id="NAME">18</Col>
          </Row>
          <Row>
            <Col id="CODE">19</Col>
            <Col id="NAME">19</Col>
          </Row>
          <Row>
            <Col id="CODE">20</Col>
            <Col id="NAME">20</Col>
          </Row>
          <Row>
            <Col id="CODE">21</Col>
            <Col id="NAME">21</Col>
          </Row>
          <Row>
            <Col id="CODE">22</Col>
            <Col id="NAME">22</Col>
          </Row>
          <Row>
            <Col id="CODE">23</Col>
            <Col id="NAME">23</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_minute">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">00</Col>
            <Col id="NAME">00</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="NAME">10</Col>
          </Row>
          <Row>
            <Col id="CODE">20</Col>
            <Col id="NAME">20</Col>
          </Row>
          <Row>
            <Col id="CODE">30</Col>
            <Col id="NAME">30</Col>
          </Row>
          <Row>
            <Col id="CODE">40</Col>
            <Col id="NAME">40</Col>
          </Row>
          <Row>
            <Col id="CODE">50</Col>
            <Col id="NAME">50</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_div1">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_div3">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd1">
        <ColumnInfo>
          <Column id="BP_CD" type="STRING" size="10"/>
          <Column id="TIP_GU" type="STRING" size="10"/>
          <Column id="SEQ_NO" type="INT" size="11"/>
          <Column id="TIP_DESC" type="STRING" size="400"/>
          <Column id="VALID_FR_DT" type="DATETIME" size="23"/>
          <Column id="VALID_TO_DT" type="DATETIME" size="23"/>
          <Column id="SORT_SEQ" type="INT" size="11"/>
          <Column id="IMPORTANT_FLAG" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd2" oncolumnchanged="ds_grd2_oncolumnchanged">
        <ColumnInfo>
          <Column id="SEQ" type="STRING" size="256"/>
          <Column id="SUB_TYPE" type="STRING" size="256"/>
          <Column id="SUB_TYPE_NM" type="STRING" size="256"/>
          <Column id="SUB_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd3">
        <ColumnInfo>
          <Column id="ITEM_FLAG" type="STRING" size="256"/>
          <Column id="BP_CD" type="STRING" size="256"/>
          <Column id="DEPT_GU" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="COL_NM" type="STRING" size="256"/>
          <Column id="COL_VAL" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd4">
        <ColumnInfo>
          <Column id="ITEM_FLAG" type="STRING" size="256"/>
          <Column id="BP_CD" type="STRING" size="256"/>
          <Column id="DEPT_GU" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="COL_NM" type="STRING" size="256"/>
          <Column id="COL_VAL" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd3_chg">
        <ColumnInfo>
          <Column id="ITEM_CODE" type="STRING" size="256"/>
          <Column id="ITEM_DATA" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="ITEM_SEQ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grd4_chg">
        <ColumnInfo>
          <Column id="ITEM_CODE" type="STRING" size="256"/>
          <Column id="ITEM_DATA" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="ITEM_SEQ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div1">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hs">
        <ColumnInfo>
          <Column id="HS_CODE" type="STRING" size="20"/>
          <Column id="HS_NM" type="STRING" size="2000"/>
          <Column id="HS_GU" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_2" oncolumnchanged="ds_list_2_oncolumnchanged">
        <ColumnInfo>
          <Column id="SO_NO" type="STRING" size="18"/>
          <Column id="SO_SEQ" type="BIGDECIMAL" size="4"/>
          <Column id="ITEM_CD" type="STRING" size="50"/>
          <Column id="DEAL_TYPE" type="STRING" size="50"/>
          <Column id="PLANT_CD" type="STRING" size="4"/>
          <Column id="SL_CD" type="STRING" size="10"/>
          <Column id="SHIP_TO_PARTY" type="STRING" size="10"/>
          <Column id="ITEM_ACCT" type="STRING" size="2"/>
          <Column id="DLVY_DT" type="STRING" size="23"/>
          <Column id="PRICE_SO" type="BIGDECIMAL" size="18"/>
          <Column id="NET_AMT" type="BIGDECIMAL" size="18"/>
          <Column id="NET_AMT_LOC" type="BIGDECIMAL" size="18"/>
          <Column id="VAT_TYPE" type="STRING" size="5"/>
          <Column id="VAT_RATE" type="BIGDECIMAL" size="15"/>
          <Column id="VAT_AMT" type="BIGDECIMAL" size="18"/>
          <Column id="VAT_AMT_LOC" type="BIGDECIMAL" size="18"/>
          <Column id="PAY_DIV" type="STRING" size="50"/>
          <Column id="REASON" type="STRING" size="50"/>
          <Column id="QTY" type="BIGDECIMAL" size="18"/>
          <Column id="SO_UNIT" type="STRING" size="3"/>
          <Column id="CLOSE_FLAG" type="STRING" size="1"/>
          <Column id="SO_STATUS" type="BIGDECIMAL" size="1"/>
          <Column id="PRICE_FLAG" type="STRING" size="1"/>
          <Column id="SO_TYPE" type="STRING" size="20"/>
          <Column id="BILL_TO_PARTY" type="STRING" size="20"/>
          <Column id="PO_PRICE" type="BIGDECIMAL" size="18"/>
          <Column id="PO_AMT" type="BIGDECIMAL" size="18"/>
          <Column id="RIBBON_MESSAGE" type="STRING" size="32767"/>
          <Column id="HS_MESSAGE" type="STRING" size="256"/>
          <Column id="CARD_MESSAGE" type="STRING" size="32767"/>
          <Column id="BRANCH_GROUP" type="STRING" size="10"/>
          <Column id="PO_STATUS" type="STRING" size="20"/>
          <Column id="INSRT_USER_ID" type="STRING" size="13"/>
          <Column id="INSRT_DT" type="DATETIME" size="23"/>
          <Column id="UPDT_USER_ID" type="STRING" size="13"/>
          <Column id="UPDT_DT" type="DATETIME" size="23"/>
          <Column id="CHK" type="STRING" size="255"/>
          <Column id="INV_QTY" type="STRING" size="256"/>
          <Column id="TS_BP_CD" type="STRING" size="256"/>
          <Column id="TS_BP_NM" type="STRING" size="256"/>
          <Column id="PRICE_SO2" type="STRING" size="256"/>
          <Column id="UPDT_DIV" type="STRING" size="256"/>
          <Column id="PO_DLVY_CD" type="STRING" size="256"/>
          <Column id="MOVE_YN" type="STRING" size="256"/>
          <Column id="SO_NO_ORI" type="STRING" size="256"/>
          <Column id="CFM_FLAG" type="STRING" size="256"/>
          <Column id="TOTAL_PRICE" type="STRING" size="256"/>
          <Column id="FAX_NO" type="STRING" size="256"/>
          <Column id="USAGE_FLAG" type="STRING" size="256"/>
          <Column id="CHG_REASON" type="STRING" size="256"/>
          <Column id="BASIC_UNIT" type="STRING" size="256"/>
          <Column id="SO_PRICE" type="BIGDECIMAL" size="256"/>
          <Column id="GOOD_QTY_INFO" type="STRING" size="256"/>
          <Column id="SAVE_YN" type="STRING" size="256"/>
          <Column id="FLA_ITEM_CD" type="STRING" size="256"/>
          <Column id="ADD_CD2" type="STRING" size="256"/>
          <Column id="ADD_CD3" type="STRING" size="256"/>
          <Column id="ADD_CD5" type="STRING" size="256"/>
          <Column id="ADD_CD6" type="STRING" size="256"/>
          <Column id="ITEM_NM_ENG" type="STRING" size="256"/>
          <Column id="ETC_REMARK" type="STRING" size="1000"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div2">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div3">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="SO_NO" type="STRING" size="18"/>
          <Column id="SO_TYPE" type="STRING" size="4"/>
          <Column id="SO_DT" type="STRING" size="23"/>
          <Column id="ORDER_DT" type="STRING" size="23"/>
          <Column id="RCPT_METH" type="STRING" size="20"/>
          <Column id="DEAL_TYPE" type="STRING" size="5"/>
          <Column id="CONT_NO" type="STRING" size="256"/>
          <Column id="SOLD_TO_PARTY" type="STRING" size="10"/>
          <Column id="BP_NM" type="STRING" size="256"/>
          <Column id="HS_CD" type="STRING" size="20"/>
          <Column id="DLVY_CD" type="STRING" size="20"/>
          <Column id="DLVY_TIME" type="STRING" size="256"/>
          <Column id="DLVY_MIN" type="STRING" size="256"/>
          <Column id="DLVY_CHANGE_DT" type="STRING" size="23"/>
          <Column id="M_ROOM_NO" type="STRING" size="20"/>
          <Column id="M_NAME" type="STRING" size="20"/>
          <Column id="DLVY_DT" type="STRING" size="8"/>
          <Column id="DLVY_DT_TYPE" type="STRING" size="1"/>
          <Column id="DEC_DT" type="STRING" size="8"/>
          <Column id="DEC_TIME" type="STRING" size="256"/>
          <Column id="DEC_MIN" type="STRING" size="256"/>
          <Column id="OWN_NM" type="STRING" size="20"/>
          <Column id="OWN_TEL_NO1" type="STRING" size="20"/>
          <Column id="OWN_TEL_NO2" type="STRING" size="20"/>
          <Column id="TITLE_NM" type="STRING" size="20"/>
          <Column id="REQ_NM" type="STRING" size="20"/>
          <Column id="REQ_TEL_NO1" type="STRING" size="20"/>
          <Column id="REQ_TEL_NO2" type="STRING" size="20"/>
          <Column id="CFM_FLAG" type="STRING" size="1"/>
          <Column id="CUR" type="STRING" size="3"/>
          <Column id="XCHG_RATE" type="BIGDECIMAL" size="17"/>
          <Column id="NET_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="NET_AMT_LOC" type="BIGDECIMAL" size="20"/>
          <Column id="F_MEMO" type="STRING" size="2000"/>
          <Column id="M_MEMO" type="STRING" size="1073741823"/>
          <Column id="C_MEMO" type="STRING" size="200"/>
          <Column id="DEL_REASON" type="STRING" size="256"/>
          <Column id="INSRT_USER_ID" type="STRING" size="13"/>
          <Column id="INSRT_DT" type="DATETIME" size="23"/>
          <Column id="UPDT_USER_ID" type="STRING" size="13"/>
          <Column id="UPDT_DT" type="DATETIME" size="23"/>
          <Column id="DLVY_NM" type="STRING" size="256"/>
          <Column id="DLVY_ADDR" type="STRING" size="256"/>
          <Column id="CONFIRM_DT" type="STRING" size="256"/>
          <Column id="SHIP_TO_PARTY" type="STRING" size="256"/>
          <Column id="BILL_TO_PARTY" type="STRING" size="256"/>
          <Column id="PAYER" type="STRING" size="256"/>
          <Column id="DLVY_NM_ERP" type="STRING" size="256"/>
          <Column id="DLVY_ADDR_ERP" type="STRING" size="256"/>
          <Column id="VAT_TYPE" type="STRING" size="256"/>
          <Column id="VAT_RATE" type="STRING" size="256"/>
          <Column id="SALES_GRP" type="STRING" size="256"/>
          <Column id="SALES_ORG" type="STRING" size="256"/>
          <Column id="SALES_COST_CENTER" type="STRING" size="256"/>
          <Column id="TO_BIZ_GRP" type="STRING" size="256"/>
          <Column id="TO_BIZ_ORG" type="STRING" size="256"/>
          <Column id="TO_BIZ_COST_CENTER" type="STRING" size="256"/>
          <Column id="USR_FLAG" type="STRING" size="256"/>
          <Column id="USR_FLAG2" type="STRING" size="256"/>
          <Column id="YES_ITEM" type="STRING" size="256"/>
          <Column id="M_BALIN_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sono"/>
      <Dataset id="ds_sosoc">
        <ColumnInfo>
          <Column id="SO_NO" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="SUB_CODE" type="STRING" size="256"/>
          <Column id="SUB_CODE_NM" type="STRING" size="256"/>
          <Column id="SUB_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_suju_div">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">DSOA</Col>
            <Col id="CODE_NAME">DSOA</Col>
          </Row>
          <Row>
            <Col id="CODE">DSOC</Col>
            <Col id="CODE_NAME">DSOC</Col>
          </Row>
          <Row>
            <Col id="CODE">STO</Col>
            <Col id="CODE_NAME">STO</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_memo">
        <ColumnInfo>
          <Column id="INSRT_DT" type="STRING" size="256"/>
          <Column id="MEMO_DIV" type="STRING" size="256"/>
          <Column id="MEMO" type="STRING" size="256"/>
          <Column id="INSRT_USER_ID" type="STRING" size="256"/>
          <Column id="H_TYPE" type="STRING" size="256"/>
          <Column id="M_TYPE" type="STRING" size="256"/>
          <Column id="L_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_user"/>
      <Dataset id="ds_tab_div4">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">F</Col>
            <Col id="CODE_NAME">F : 플라워</Col>
          </Row>
          <Row>
            <Col id="CODE">M</Col>
            <Col id="CODE_NAME">M : 의전</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_move_list"/>
      <Dataset id="ds_param">
        <ColumnInfo>
          <Column id="DATA_INDEX" type="INT" size="10"/>
          <Column id="SO_NO" type="STRING" size="1000"/>
          <Column id="DATA_TYPE" type="STRING" size="32767"/>
          <Column id="DATA1" type="STRING" size="32767"/>
          <Column id="DATA2" type="STRING" size="32767"/>
          <Column id="DATA3" type="STRING" size="32767"/>
          <Column id="DATA4" type="STRING" size="32767"/>
          <Column id="DATA5" type="STRING" size="32767"/>
          <Column id="INSRT_USER_ID" type="STRING" size="100"/>
          <Column id="INSRT_DT" type="DATETIME" size="23"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_confirm_out">
        <ColumnInfo>
          <Column id="MSG_CD" type="STRING" size="256"/>
          <Column id="MSG_TEXT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div5">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">결제 대기</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">결제 완료</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NAME">결제 취소</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tab_div6">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">미입금</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">입금완료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tab_div7">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">계산서 요청</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">계산서 완료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tab_div8">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">C1</Col>
            <Col id="CODE_NAME">카드결제</Col>
          </Row>
          <Row>
            <Col id="CODE">C2</Col>
            <Col id="CODE_NAME">통장입금</Col>
          </Row>
          <Row>
            <Col id="CODE">C3</Col>
            <Col id="CODE_NAME">계산서발행</Col>
          </Row>
          <Row>
            <Col id="CODE">F1</Col>
            <Col id="CODE_NAME">본사지원</Col>
          </Row>
          <Row>
            <Col id="CODE">F2</Col>
            <Col id="CODE_NAME">의전수금</Col>
          </Row>
          <Row>
            <Col id="CODE">Z2</Col>
            <Col id="CODE_NAME">조정결제</Col>
          </Row>
          <Row>
            <Col id="CODE">Z7</Col>
            <Col id="CODE_NAME">기타1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_3" oncolumnchanged="ds_list_3_oncolumnchanged">
        <ColumnInfo>
          <Column id="SO_NO" type="STRING" size="20"/>
          <Column id="SEQ" type="BIGDECIMAL" size="5"/>
          <Column id="PAY_TYPE" type="STRING" size="2"/>
          <Column id="BILL_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="COLL_AMT_CALL" type="BIGDECIMAL" size="20"/>
          <Column id="COLL_DT_CALL" type="DATETIME" size="23"/>
          <Column id="COLL_NM" type="STRING" size="20"/>
          <Column id="COLL_TEL_NO" type="STRING" size="20"/>
          <Column id="COLL_FAX_NO" type="STRING" size="20"/>
          <Column id="EMAIL_ID" type="STRING" size="40"/>
          <Column id="CARD_NO" type="STRING" size="20"/>
          <Column id="CARD_VALID_THRU" type="STRING" size="20"/>
          <Column id="CARD_APP_NO" type="STRING" size="20"/>
          <Column id="BANK_NM" type="STRING" size="20"/>
          <Column id="BANK_RCPT_NM" type="STRING" size="20"/>
          <Column id="REG_NO" type="STRING" size="20"/>
          <Column id="REG_EMP_NM" type="STRING" size="20"/>
          <Column id="INSRT_USER_ID" type="STRING" size="20"/>
          <Column id="INSRT_DT" type="DATETIME" size="23"/>
          <Column id="UPDT_USER_ID" type="STRING" size="20"/>
          <Column id="UPDT_DT" type="DATETIME" size="23"/>
          <Column id="COLL_REMARK" type="STRING" size="100"/>
          <Column id="COLL_DT_ACCT" type="DATETIME" size="23"/>
          <Column id="COLL_AMT_ACCT" type="BIGDECIMAL" size="20"/>
          <Column id="ACCT_YN" type="STRING" size="20"/>
          <Column id="RCPT_METH" type="STRING" size="1"/>
          <Column id="PAYMENT_WAIT" type="STRING" size="1"/>
          <Column id="TID" type="STRING" size="100"/>
          <Column id="PAYMENT_TYPE" type="STRING" size="1"/>
          <Column id="PAYAT_ORDER_NO" type="STRING" size="1073741823"/>
          <Column id="PAYAT_JSON_DATA" type="STRING" size="1073741823"/>
          <Column id="INSTALLMENT_MONTH" type="INT" size="11"/>
          <Column id="PAYAT_TEMP_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="PAYAT_TEMP_NON_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="PAYAT_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="PAYAT_VAT_AMT" type="BIGDECIMAL" size="20"/>
          <Column id="USER_INFO" type="STRING" size="1"/>
          <Column id="PAYMENT_WAIT_ID" type="STRING" size="100"/>
          <Column id="PAYMENT_ID" type="STRING" size="100"/>
          <Column id="PAYMENT_DT" type="DATETIME" size="23"/>
          <Column id="C1_TEXT1" type="STRING" size="1073741823"/>
          <Column id="C1_USR_TEXT1_CHANGE_ID" type="STRING" size="100"/>
          <Column id="C1_USR_TEXT1_CHANGE_DT" type="DATETIME" size="23"/>
          <Column id="C1_TEXT2" type="STRING" size="1073741823"/>
          <Column id="C1_TEXT3" type="STRING" size="1073741823"/>
          <Column id="C1_TEXT4" type="STRING" size="1073741823"/>
          <Column id="C1_TEXT5" type="STRING" size="1073741823"/>
          <Column id="C1_TEXT6" type="STRING" size="1073741823"/>
          <Column id="C1_TEXT7" type="STRING" size="256"/>
          <Column id="C1_NUM1" type="BIGDECIMAL" size="20"/>
          <Column id="C1_NUM2" type="BIGDECIMAL" size="20"/>
          <Column id="C1_NUM3" type="BIGDECIMAL" size="20"/>
          <Column id="C1_NUM4" type="BIGDECIMAL" size="20"/>
          <Column id="C2_TEXT1" type="STRING" size="1073741823"/>
          <Column id="C2_TEXT2" type="STRING" size="1073741823"/>
          <Column id="C2_TEXT3" type="STRING" size="1073741823"/>
          <Column id="C2_TEXT4" type="STRING" size="256"/>
          <Column id="C2_TEXT5" type="STRING" size="256"/>
          <Column id="C2_TEXT6" type="STRING" size="256"/>
          <Column id="C2_TEXT7" type="STRING" size="256"/>
          <Column id="C2_NUM1" type="STRING" size="256"/>
          <Column id="C2_NUM2" type="STRING" size="256"/>
          <Column id="C2_NUM3" type="STRING" size="256"/>
          <Column id="C2_NUM4" type="STRING" size="256"/>
          <Column id="C3_TEXT1" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT2" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT3" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT4" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT5" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT6" type="STRING" size="1073741823"/>
          <Column id="C3_TEXT7" type="STRING" size="256"/>
          <Column id="F1_TEXT1" type="STRING" size="1073741823"/>
          <Column id="F2_TEXT1" type="STRING" size="1073741823"/>
          <Column id="UUID" type="STRING" size="1073741823"/>
          <Column id="F2_TEXT2" type="STRING" size="1073741823"/>
          <Column id="ETC_REMARK" type="STRING" size="1073741823"/>
          <Column id="SAVE_CHK" type="STRING" size="256"/>
          <Column id="CANCEL_ORDER_NO" type="STRING" size="256"/>
          <Column id="C2_TEXT8" type="STRING" size="256"/>
          <Column id="C2_APP_NO" type="STRING" size="256"/>
          <Column id="C2_ORDER_NO" type="STRING" size="256"/>
          <Column id="C2_CANCEL_ORDER_NO" type="STRING" size="256"/>
          <Column id="C2_TEXT9" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div9">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">소득공제용</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">지출증빙용</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_out"/>
      <Dataset id="ds_return"/>
      <Dataset id="ds_item_tip">
        <ColumnInfo>
          <Column id="BP_CD" type="STRING" size="10"/>
          <Column id="TIP_GU" type="STRING" size="10"/>
          <Column id="SEQ_NO" type="INT" size="11"/>
          <Column id="TIP_DESC" type="STRING" size="400"/>
          <Column id="VALID_FR_DT" type="DATETIME" size="23"/>
          <Column id="VALID_TO_DT" type="DATETIME" size="23"/>
          <Column id="SORT_SEQ" type="INT" size="11"/>
          <Column id="IMPORTANT_FLAG" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div10"/>
      <Dataset id="ds_receiptPayReturn"/>
      <Dataset id="ds_receiptCancelReturn"/>
      <Dataset id="ds_tab_div11">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">발행 대기</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">발행 완료</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NAME">발행 취소</Col>
          </Row>
        </Rows>
      </Dataset>
      <FileDialog id="FileDialog00" onclose="FileDialog00_onclose"/>
      <FileUpTransfer id="FileUpTransfer00" onsuccess="FileUpTransfer00_onsuccess" onerror="FileUpTransfer00_onerror"/>
      <FileDownTransfer id="FileDownTransfer00" onsuccess="FileDownTransfer00_onsuccess" onerror="FileDownTransfer00_onerror"/>
      <Dataset id="ds_tab_div12">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_orderChk"/>
      <Dataset id="ds_faxChk">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="FAX_SO_NO" type="STRING" size="256"/>
          <Column id="PO_BP_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bpEtc"/>
      <Dataset id="ds_bpSearch"/>
      <Dataset id="ds_dlvySearch"/>
      <Dataset id="ds_dn"/>
      <Dataset id="ds_exception"/>
      <Dataset id="ds_confirmChk"/>
      <Dataset id="ds_status_chk"/>
      <Dataset id="ds_soAdd" oncolumnchanged="ds_soAdd_oncolumnchanged">
        <ColumnInfo>
          <Column id="SO_NO" type="STRING" size="18"/>
          <Column id="ADD_CD1" type="STRING" size="20"/>
          <Column id="ADD_CD2" type="STRING" size="20"/>
          <Column id="ADD_CD3" type="STRING" size="20"/>
          <Column id="ADD_CD4" type="STRING" size="20"/>
          <Column id="ADD_CD5" type="STRING" size="20"/>
          <Column id="ADD_CD6" type="STRING" size="20"/>
          <Column id="ADD_CD7" type="STRING" size="20"/>
          <Column id="ADD_CD8" type="STRING" size="20"/>
          <Column id="ADD_CD9" type="STRING" size="20"/>
          <Column id="ADD_CD10" type="STRING" size="20"/>
          <Column id="ADD_CD11" type="STRING" size="20"/>
          <Column id="ADD_CD12" type="STRING" size="20"/>
          <Column id="ADD_CD13" type="STRING" size="20"/>
          <Column id="ADD_CD14" type="STRING" size="20"/>
          <Column id="ADD_CD15" type="STRING" size="20"/>
          <Column id="ADD_CD16" type="STRING" size="20"/>
          <Column id="ADD_CD17" type="STRING" size="20"/>
          <Column id="ADD_CD18" type="STRING" size="20"/>
          <Column id="ADD_CD19" type="STRING" size="200"/>
          <Column id="ADD_CD20" type="STRING" size="2000"/>
          <Column id="ADD_QTY1" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_QTY2" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_QTY3" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_AMT1" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_AMT2" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_AMT3" type="BIGDECIMAL" size="15"/>
          <Column id="ADD_DT1" type="DATETIME" size="23"/>
          <Column id="ADD_DT2" type="DATETIME" size="23"/>
          <Column id="ADD_DT3" type="DATETIME" size="23"/>
          <Column id="INSRT_USER_ID" type="STRING" size="13"/>
          <Column id="INSRT_DT" type="DATETIME" size="23"/>
          <Column id="UPDT_USER_ID" type="STRING" size="13"/>
          <Column id="UPDT_DT" type="DATETIME" size="23"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fuDiv"/>
      <Dataset id="ds_item_tip2">
        <ColumnInfo>
          <Column id="BP_CD" type="STRING" size="10"/>
          <Column id="TIP_GU" type="STRING" size="10"/>
          <Column id="SEQ_NO" type="INT" size="11"/>
          <Column id="TIP_DESC" type="STRING" size="400"/>
          <Column id="VALID_FR_DT" type="DATETIME" size="23"/>
          <Column id="VALID_TO_DT" type="DATETIME" size="23"/>
          <Column id="SORT_SEQ" type="INT" size="11"/>
          <Column id="IMPORTANT_FLAG" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_qtyChk">
        <ColumnInfo>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="MOVE_YN" type="STRING" size="256"/>
          <Column id="ITEM_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bp_nm"/>
      <Dataset id="ds_mms">
        <ColumnInfo>
          <Column id="MMS_SN" type="STRING" size="256"/>
          <Column id="MMS_SEQ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_case"/>
      <Dataset id="ds_bp_mms"/>
      <Dataset id="ds_dnChk"/>
      <Dataset id="ds_userIn2"/>
      <Dataset id="ds_tSoNo">
        <ColumnInfo>
          <Column id="T_SO_NO" type="STRING" size="50"/>
          <Column id="ITEM_CD" type="STRING" size="50"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_contSearch">
        <ColumnInfo>
          <Column id="BP_CD" type="STRING" size="50"/>
          <Column id="CONT_NO" type="STRING" size="50"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tab_div10_1"/>
      <Dataset id="ds_tab_div10_2"/>
      <Dataset id="ds_tab_div10_3"/>
      <Dataset id="ds_bugochk">
        <ColumnInfo>
          <Column id="BUGO_CHK" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="BUGO_CHK">00</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">01</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">02</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">03</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">04</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">05</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">06</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">07</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">08</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">09</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">10</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">11</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">12</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">13</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">14</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">15</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">16</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">17</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">18</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">19</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">20</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">21</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">22</Col>
          </Row>
          <Row>
            <Col id="BUGO_CHK">23</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_bugoflag">
        <ColumnInfo>
          <Column id="BUGO_FLAG" type="STRING" size="256"/>
          <Column id="SO_NO" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="BUGO_FLAG">00</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">01</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">02</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">03</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">04</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">05</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">06</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">07</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">08</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">09</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">10</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">11</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">12</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">13</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">14</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">15</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">16</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">17</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">18</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">19</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">20</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">21</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">22</Col>
          </Row>
          <Row>
            <Col id="BUGO_FLAG">23</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_fla_status">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">DLSP</Col>
            <Col id="CODE_NAME">배송중</Col>
          </Row>
          <Row>
            <Col id="CODE">DLDN</Col>
            <Col id="CODE_NAME">배송완료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_fla_img"/>
    </Objects>
    <Bind>
      <BindItem id="item7" compid="Div06.form.cmb_AM_dept" propid="value" datasetid="ds_list_1" columnid="AM_DEPT"/>
      <BindItem id="item12" compid="Div06.form.edt_client_part_m" propid="value" datasetid="ds_list_1" columnid="MA_DEPT_NAME"/>
      <BindItem id="item13" compid="Div06.form.edt_client_gbn" propid="value" datasetid="ds_list_1" columnid="GBN_NAME"/>
      <BindItem id="item14" compid="Div06.form.edt_client_part" propid="value" datasetid="ds_list_1" columnid="DEPT_NAME"/>
      <BindItem id="item15" compid="Div06.form.edt_client_ma" propid="value" datasetid="ds_list_1" columnid="MA_CD_NAME"/>
      <BindItem id="item16" compid="Div06.form.edt_client_grade" propid="value" datasetid="ds_list_1" columnid="MA_GRADE_NAME"/>
      <BindItem id="item18" compid="Div06.form.edt_client_part" propid="tooltiptext" datasetid="ds_list_1" columnid="DEPT_NAME"/>
      <BindItem id="item26" compid="Div06.form.edt_upper_pjt_no01" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NAME"/>
      <BindItem id="item35" compid="Div06.form.edt_pjt_status00" propid="value" datasetid="ds_list_1" columnid="PROJECT_FINISH_DATE"/>
      <BindItem id="item1" compid="edt_upper_pjt_no00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item2" compid="edt_upper_pjt_no00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item3" compid="edt_upper_pjt_no00_00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item4" compid="edt_upper_pjt_no00_00_00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item5" compid="edt_upper_pjt_no00_00_00_00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item6" compid="edt_upper_pjt_no01" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item8" compid="edt_upper_pjt_no01_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item9" compid="edt_upper_pjt_no01_00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item10" compid="edt_upper_pjt_no01_00_00_00" propid="value" datasetid="ds_list_1" columnid="UPPER_PROJECT_NO"/>
      <BindItem id="item0" compid="Div00.form.cmb_rcptMeth" propid="value" datasetid="ds_list" columnid="RCPT_METH"/>
      <BindItem id="item11" compid="Div00.form.edt_soNo" propid="value" datasetid="ds_list" columnid="SO_NO"/>
      <BindItem id="item20" compid="Div00.form.cal_dlvyDt" propid="value" datasetid="ds_list" columnid="DLVY_DT"/>
      <BindItem id="item21" compid="Div00.form.cal_decDt" propid="value" datasetid="ds_list" columnid="DEC_DT"/>
      <BindItem id="item23" compid="Div00.form.edt_usr1" propid="value" datasetid="ds_list" columnid="OWN_NM"/>
      <BindItem id="item24" compid="Div00.form.edt_titleNm" propid="value" datasetid="ds_list" columnid="TITLE_NM"/>
      <BindItem id="item27" compid="Div00.form.edt_ownTel" propid="value" datasetid="ds_list" columnid="OWN_TEL_NO2"/>
      <BindItem id="item29" compid="Div00.form.edt_reqTel" propid="value" datasetid="ds_list" columnid="REQ_TEL_NO2"/>
      <BindItem id="item37" compid="Div00.form.cmb_time" propid="value" datasetid="ds_list" columnid="DLVY_TIME"/>
      <BindItem id="item38" compid="Div00.form.cmb_min" propid="value" datasetid="ds_list" columnid="DLVY_MIN"/>
      <BindItem id="item39" compid="Div00.form.cmb_AM00_01" propid="value" datasetid="ds_list" columnid="DEC_TIME"/>
      <BindItem id="item40" compid="Div00.form.cmb_AM00_00_00" propid="value" datasetid="ds_list" columnid="DEC_MIN"/>
      <BindItem id="item41" compid="Div00.form.Radio_dlvyDtType" propid="value" datasetid="ds_list" columnid="DLVY_DT_TYPE"/>
      <BindItem id="item51" compid="Div00.form.TA_addr" propid="value" datasetid="ds_list" columnid="DLVY_ADDR"/>
      <BindItem id="item30" compid="Div00.form.edt_client" propid="value" datasetid="ds_list" columnid="BP_NM"/>
      <BindItem id="item31" compid="Div00.form.edt_dlvyNm" propid="value" datasetid="ds_list" columnid="DLVY_NM"/>
      <BindItem id="item17" compid="Div00.form.cmb_regUser" propid="value" datasetid="ds_list" columnid="INSRT_USER_ID"/>
      <BindItem id="item22" compid="Div00.form.Radio_dealType" propid="value" datasetid="ds_list" columnid="DEAL_TYPE"/>
      <BindItem id="item32" compid="Div00.form.cmb_soType" propid="value" datasetid="ds_list" columnid="SO_TYPE"/>
      <BindItem id="item33" compid="Div00.form.cmb_hsCd" propid="value" datasetid="ds_list" columnid="HS_CD"/>
      <BindItem id="item34" compid="Div00.form.edt_mRoomNo" propid="value" datasetid="ds_list" columnid="M_ROOM_NO"/>
      <BindItem id="item36" compid="Div00.form.edt_mNm" propid="value" datasetid="ds_list" columnid="M_NAME"/>
      <BindItem id="item42" compid="Div00.form.edt_usr2" propid="value" datasetid="ds_list" columnid="REQ_NM"/>
      <BindItem id="item43" compid="Div00.form.edt_fMemo" propid="value" datasetid="ds_list" columnid="F_MEMO"/>
      <BindItem id="item44" compid="Div00.form.edt_mMemo" propid="value" datasetid="ds_list" columnid="M_MEMO"/>
      <BindItem id="item46" compid="Div00.form.edt_contNo" propid="value" datasetid="ds_list" columnid="CONT_NO"/>
      <BindItem id="item47" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.Radio_dealType" propid="value" datasetid="ds_list_3" columnid="C1_TEXT1"/>
      <BindItem id="item49" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.edt_mRoomNo" propid="value" datasetid="ds_list_3" columnid="C1_TEXT7"/>
      <BindItem id="item52" compid="Div00_00_00_00_00.form.Radio_dealType" propid="value" datasetid="ds_list" columnid="DEAL_TYPE"/>
      <BindItem id="item53" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.Radio_dealType" propid="value" datasetid="ds_list_3" columnid="C3_TEXT1"/>
      <BindItem id="item54" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.edt_mRoomNo" propid="value" datasetid="ds_list_3" columnid="C3_TEXT3"/>
      <BindItem id="item57" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType" propid="value" datasetid="ds_list_3" columnid="C2_TEXT1"/>
      <BindItem id="item58" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.edt_mRoomNo" propid="value" datasetid="ds_list_3" columnid="C2_TEXT2"/>
      <BindItem id="item59" compid="Div00_00_00.form.Radio_dealType" propid="value" datasetid="ds_list" columnid="DEAL_TYPE"/>
      <BindItem id="item60" compid="Div00_00_00.form.edt_mRoomNo" propid="value" datasetid="ds_list" columnid="M_ROOM_NO"/>
      <BindItem id="item61" compid="Div00_00_00.form.edt_mRoomNo00" propid="value" datasetid="ds_list" columnid="M_ROOM_NO"/>
      <BindItem id="item62" compid="Div00_00_00.form.edt_mRoomNo00_00" propid="value" datasetid="ds_list" columnid="M_ROOM_NO"/>
      <BindItem id="item48" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.edt_mRoomNo00" propid="value" datasetid="ds_list_3" columnid="C1_TEXT5"/>
      <BindItem id="item64" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType00" propid="value" datasetid="ds_list_3" columnid="C2_TEXT6"/>
      <BindItem id="item65" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.edt_mRoomNo01" propid="value" datasetid="ds_list_3" columnid="C3_TEXT4"/>
      <BindItem id="item68" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.edt_mRoomNo01_00" propid="value" datasetid="ds_list_3" columnid="C3_TEXT5"/>
      <BindItem id="item71" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.edt_mRoomNo01_00_00" propid="value" datasetid="ds_list_3" columnid="C3_TEXT7"/>
      <BindItem id="item50" compid="Div02.form.Tab00.Tabpage5.form.Div04.form.Radio_dealType" propid="value" datasetid="ds_list_3" columnid="F2_TEXT2"/>
      <BindItem id="item55" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.txt_Month" propid="value" datasetid="ds_list_3" columnid="C1_TEXT3"/>
      <BindItem id="item56" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item66" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00" propid="value" datasetid="ds_list_3" columnid="C1_TEXT2"/>
      <BindItem id="item67" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.Edit00_00_00" propid="value" datasetid="ds_list_3" columnid="C1_TEXT4"/>
      <BindItem id="item70" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_01" propid="value" datasetid="ds_list_3" columnid="C1_NUM1"/>
      <BindItem id="item72" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_01_00" propid="value" datasetid="ds_list_3" columnid="C1_NUM2"/>
      <BindItem id="item73" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_01_01" propid="value" datasetid="ds_list_3" columnid="C1_NUM3"/>
      <BindItem id="item74" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_01_00_00" propid="value" datasetid="ds_list_3" columnid="C1_NUM4"/>
      <BindItem id="item75" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00" propid="value" datasetid="ds_list_3" columnid="CARD_APP_NO"/>
      <BindItem id="item76" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="PAYAT_ORDER_NO"/>
      <BindItem id="item77" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item81" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="C2_TEXT8"/>
      <BindItem id="item82" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01" propid="value" datasetid="ds_list_3" columnid="C2_NUM1"/>
      <BindItem id="item83" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_00" propid="value" datasetid="ds_list_3" columnid="C2_NUM2"/>
      <BindItem id="item84" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_01" propid="value" datasetid="ds_list_3" columnid="C2_NUM3"/>
      <BindItem id="item85" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_01_00_00" propid="value" datasetid="ds_list_3" columnid="C2_NUM4"/>
      <BindItem id="item88" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item89" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.MaskEdit00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="C3_TEXT2"/>
      <BindItem id="item90" compid="Div02.form.Tab00.Tabpage5.form.Div02.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="C3_TEXT6"/>
      <BindItem id="item91" compid="Div02.form.Tab00.Tabpage5.form.Div03.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item92" compid="Div02.form.Tab00.Tabpage5.form.Div03.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="F1_TEXT1"/>
      <BindItem id="item93" compid="Div02.form.Tab00.Tabpage5.form.Div04.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item94" compid="Div02.form.Tab00.Tabpage5.form.Div04.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="F2_TEXT1"/>
      <BindItem id="item95" compid="Div02.form.Tab00.Tabpage5.form.Div05.form.MaskEdit00_00_00" propid="value" datasetid="ds_list_3" columnid="BILL_AMT"/>
      <BindItem id="item96" compid="Div02.form.Tab00.Tabpage5.form.Div05.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="ETC_REMARK"/>
      <BindItem id="item69" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.TextArea00" propid="value" datasetid="ds_list_3" columnid="C1_TEXT6"/>
      <BindItem id="item97" compid="Div02.form.Tab00.Tabpage5.form.Div00.form.MaskEdit00_00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="CANCEL_ORDER_NO"/>
      <BindItem id="item99" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.edt_mRoomNo01" propid="value" datasetid="ds_list_3" columnid="C2_TEXT5"/>
      <BindItem id="item28" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.TextArea00_00" propid="value" datasetid="ds_list_3" columnid="C2_TEXT3"/>
      <BindItem id="item63" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.edt_mRoomNo00_00" propid="value" datasetid="ds_list_3" columnid="C2_TEXT4"/>
      <BindItem id="item78" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="C2_APP_NO"/>
      <BindItem id="item86" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="C2_ORDER_NO"/>
      <BindItem id="item87" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.MaskEdit00_00_00_00_00_00_00" propid="value" datasetid="ds_list_3" columnid="C2_CANCEL_ORDER_NO"/>
      <BindItem id="item102" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.Radio_dealType01" propid="value" datasetid="ds_list_3" columnid="C2_TEXT9"/>
      <BindItem id="item103" compid="Div00.form.MaskEdit01" propid="value" datasetid="ds_list" columnid="ORDER_DT"/>
      <BindItem id="item19" compid="Div00.form.MaskEdit01_00" propid="value" datasetid="ds_list" columnid="CONFIRM_DT"/>
      <BindItem id="item100" compid="Div02.form.Tab00.Tabpage7.form.Div00.form.cmb_PM00" propid="value" datasetid="ds_list" columnid="DEL_REASON"/>
      <BindItem id="item104" compid="Div02.form.Tab00.Tabpage7.form.Div00_00.form.cmb_PM00" propid="value" datasetid="ds_list" columnid="DEL_REASON"/>
      <BindItem id="item45" compid="Div01.form.TextArea00" propid="value" datasetid="ds_list" columnid="C_MEMO"/>
      <BindItem id="item105" compid="Div00.form.edt_ownTel00" propid="value" datasetid="ds_list" columnid="OWN_TEL_NO1"/>
      <BindItem id="item25" compid="Div00.form.edt_ownTel00_00" propid="value" datasetid="ds_list" columnid="REQ_TEL_NO1"/>
      <BindItem id="item98" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.ME_hp" propid="value" datasetid="ds_list_3" columnid="C2_TEXT7"/>
      <BindItem id="item79" compid="Div02.form.Tab00.Tabpage5.form.Div01.form.ME_card" propid="value" datasetid="ds_list_3" columnid="C2_TEXT7"/>
      <BindItem id="item80" compid="Div00.form.edt_soNo00" propid="value" datasetid="ds_soAdd" columnid="ADD_CD1"/>
      <BindItem id="item106" compid="Div02.form.Tab00.Tabpage1.form.edt_cMemo00" propid="value" datasetid="ds_item_tip2" columnid="TIP_DESC"/>
      <BindItem id="item101" compid="edt_cMemo" propid="value" datasetid="ds_item_tip" columnid="TIP_DESC"/>
      <BindItem id="item107" compid="Div00.form.edt_cMemo00" propid="value" datasetid="ds_item_tip2" columnid="TIP_DESC"/>
      <BindItem id="item108" compid="edt_cMemo00" propid="value" datasetid="ds_item_tip2" columnid="TIP_DESC"/>
      <BindItem id="item109" compid="Div02.form.Tab00.Tabpage1.form.cmb_case" propid="value" datasetid="ds_soAdd" columnid="ADD_CD4"/>
      <BindItem id="item110" compid="Div00.form.edt_mNm00" propid="value" datasetid="ds_list" columnid="YES_ITEM"/>
      <BindItem id="item111" compid="Div01.form.TextArea00_00" propid="value" datasetid="ds_soAdd" columnid="ADD_CD11"/>
      <BindItem id="item112" compid="Div00.form.cal_balinDt" propid="value" datasetid="ds_list" columnid="M_BALIN_DT"/>
    </Bind>
  </Form>
</FDL>
